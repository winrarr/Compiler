5:1:LET
5:5:VAR
5:9:ID dummy_input
5:21:ASSIGN
5:24:STRING "(letrec ((collatz (lambda (v) (progn (print v) (ifb (= v 1) (progn (newline) 1) (progn (print \" -> \") (ifb (= v (* (/ v 2) 2)) (collatz (/ v 2)) (collatz (+ (* v 3) 1))))))))) (collatz 117))\n (progn (print \"bye bye\") (newline))\n (progn (print \"exiting...\") (newline) (exit))"
8:5:VAR
8:9:ID dummy_input_idx
8:25:ASSIGN
8:28:INT 0
9:5:VAR
9:9:ID dummy_input_size
9:26:ASSIGN
9:29:ID size
9:33:LPAREN
9:34:ID dummy_input
9:45:RPAREN
13:5:VAR
13:9:ID use_dummy
13:19:ASSIGN
13:22:INT 0
16:5:VAR
16:9:ID lib_input
16:19:ASSIGN
16:22:STRING "(progn "
17:5:VAR
17:9:ID lib_input
17:19:ASSIGN
17:22:ID concat
17:28:LPAREN
17:29:ID lib_input
17:38:COMMA
18:29:STRING "(define cadr (lambda (v) (car (cdr v))))"
18:71:RPAREN
19:5:VAR
19:9:ID lib_input
19:19:ASSIGN
19:22:ID concat
19:28:LPAREN
19:29:ID lib_input
19:38:COMMA
20:29:STRING "(define append (lambda (a b)                 (letrec ((aux (lambda (firsts)                                 (ifb (nil? firsts)                                      b                                      (cons (car firsts) (aux (cdr firsts)))))))                   (ifb (andb (list? a) (list? b))                        (aux a)                        (progn (print \"Invalid argument to append '\" a \"' and '\" b \"'\n\")                               nil)))))"
28:42:RPAREN
29:5:VAR
29:9:ID lib_input
29:19:ASSIGN
29:22:ID concat
29:28:LPAREN
29:29:ID lib_input
29:38:COMMA
30:29:STRING "(define nth (letrec ((nth (lambda (n ls) (ifb (= n 0) (car ls) (nth (- n 1) (cdr ls)))))) nth))"
30:126:RPAREN
31:5:VAR
31:9:ID lib_input
31:19:ASSIGN
31:22:ID concat
31:28:LPAREN
31:29:ID lib_input
31:38:COMMA
31:40:STRING "(print \"Standard library loaded\n\"))\n"
31:86:RPAREN
32:5:VAR
32:9:ID lib_input_idx
32:23:ASSIGN
32:26:INT 0
33:5:VAR
33:9:ID lib_input_size
33:24:ASSIGN
33:27:ID size
33:31:LPAREN
33:32:ID lib_input
33:41:RPAREN
34:5:VAR
34:9:ID is_reading_lib
34:24:ASSIGN
34:27:INT 1
36:5:FUNCTION
36:14:ID read_char
36:23:LPAREN
36:24:RPAREN
36:25:COLON
36:27:ID string
36:34:EQ
37:7:IF
37:10:ID is_reading_lib
38:7:THEN
38:12:IF
38:15:ID lib_input_idx
38:29:EQ
38:31:ID lib_input_size
39:12:THEN
39:17:LPAREN
39:18:ID is_reading_lib
39:33:ASSIGN
39:36:INT 0
39:37:SEMICOLON
41:18:ID read_char
41:27:LPAREN
41:28:RPAREN
41:29:RPAREN
42:12:ELSE
42:17:LET
42:21:VAR
42:25:ID res
42:29:ASSIGN
42:32:ID substring
42:41:LPAREN
42:42:ID lib_input
42:51:COMMA
42:53:ID lib_input_idx
42:66:COMMA
42:68:INT 1
42:69:RPAREN
43:17:IN
43:20:ID lib_input_idx
43:34:ASSIGN
43:37:ID lib_input_idx
43:51:PLUS
43:53:INT 1
43:54:SEMICOLON
44:20:ID res
45:17:END
46:7:ELSE
46:12:IF
46:15:ID use_dummy
47:7:THEN
47:12:IF
47:15:ID dummy_input_idx
47:31:EQ
47:33:ID dummy_input_size
48:12:THEN
48:17:STRING ""
49:12:ELSE
49:17:LET
49:21:VAR
49:25:ID res
49:29:ASSIGN
49:32:ID substring
49:41:LPAREN
49:42:ID dummy_input
49:53:COMMA
49:55:ID dummy_input_idx
49:70:COMMA
49:72:INT 1
49:73:RPAREN
50:17:IN
50:20:ID dummy_input_idx
50:36:ASSIGN
50:39:ID dummy_input_idx
50:55:PLUS
50:57:INT 1
50:58:SEMICOLON
51:20:ID res
52:17:END
53:7:ELSE
53:12:ID getchar
53:19:LPAREN
53:20:RPAREN
57:5:FUNCTION
57:14:ID i2s
57:17:LPAREN
57:18:ID i
57:19:COLON
57:21:ID int
57:24:RPAREN
57:25:COLON
57:27:ID string
57:34:EQ
58:7:IF
58:10:ID i
58:12:EQ
58:14:INT 0
59:7:THEN
59:12:STRING "0"
60:7:ELSE
60:12:IF
60:15:ID i
60:17:LT
60:19:INT 0
61:7:THEN
61:12:ID concat
61:18:LPAREN
61:19:STRING "-"
61:22:COMMA
61:24:ID i2s
61:27:LPAREN
61:28:MINUS
61:29:ID i
61:30:RPAREN
61:31:RPAREN
62:7:ELSE
62:12:IF
62:15:ID i
62:17:LT
62:19:INT 10
63:7:THEN
63:12:ID chr
63:15:LPAREN
63:16:ID ord
63:19:LPAREN
63:20:STRING "0"
63:23:RPAREN
63:25:PLUS
63:27:ID i
63:28:RPAREN
64:7:ELSE
64:12:ID concat
64:18:LPAREN
64:19:ID i2s
64:22:LPAREN
64:23:ID i
64:25:DIVIDE
64:27:INT 10
64:29:RPAREN
64:30:COMMA
65:19:ID chr
65:22:LPAREN
65:23:ID ord
65:26:LPAREN
65:27:STRING "0"
65:30:RPAREN
65:32:PLUS
65:34:ID i
65:36:MINUS
65:38:LPAREN
65:39:ID i
65:41:DIVIDE
65:43:INT 10
65:45:RPAREN
65:47:TIMES
65:49:INT 10
65:51:RPAREN
65:52:RPAREN
67:5:FUNCTION
67:14:ID c2i
67:17:LPAREN
67:18:ID char
67:22:COLON
67:24:ID string
67:30:RPAREN
67:31:COLON
67:33:ID int
67:37:EQ
68:7:ID ord
68:10:LPAREN
68:11:ID char
68:15:RPAREN
68:17:MINUS
68:19:ID ord
68:22:LPAREN
68:23:STRING "0"
68:26:RPAREN
70:5:FUNCTION
70:14:ID s2i
70:17:LPAREN
70:18:ID s
70:19:COLON
70:21:ID string
70:27:RPAREN
70:28:COLON
70:30:ID int
70:34:EQ
71:7:IF
71:10:ID s
71:12:EQ
71:14:STRING ""
72:7:THEN
72:12:LPAREN
72:13:ID print
72:18:LPAREN
72:19:STRING "Error in s2i. Cannot extract int from '"
72:60:RPAREN
72:61:SEMICOLON
73:13:ID print
73:18:LPAREN
73:19:ID s
73:20:RPAREN
73:21:SEMICOLON
74:13:ID print
74:18:LPAREN
74:19:STRING "'\n"
74:24:RPAREN
74:25:SEMICOLON
75:13:INT 0
75:14:RPAREN
76:7:ELSE
76:12:LET
76:16:VAR
76:20:ID len
76:24:ASSIGN
76:27:ID size
76:31:LPAREN
76:32:ID s
76:33:RPAREN
77:16:VAR
77:20:ID s_proper
77:29:ASSIGN
77:32:ID s
78:16:VAR
78:20:ID sign
78:25:ASSIGN
78:28:IF
78:31:ID substring
78:40:LPAREN
78:41:ID s
78:42:COMMA
78:44:INT 0
78:45:COMMA
78:47:INT 1
78:48:RPAREN
78:50:EQ
78:52:STRING "-"
79:28:THEN
79:33:LPAREN
79:34:ID s_proper
79:43:ASSIGN
79:46:ID substring
79:55:LPAREN
79:56:ID s
79:57:COMMA
79:59:INT 1
79:60:COMMA
79:62:ID len
79:66:MINUS
79:68:INT 1
79:69:RPAREN
79:70:SEMICOLON
80:34:MINUS
80:35:INT 1
80:36:RPAREN
81:28:ELSE
81:33:IF
81:36:ID substring
81:45:LPAREN
81:46:ID s
81:47:COMMA
81:49:INT 0
81:50:COMMA
81:52:INT 1
81:53:RPAREN
81:55:EQ
81:57:STRING "+"
82:28:THEN
82:33:LPAREN
82:34:ID s_proper
82:43:ASSIGN
82:46:ID substring
82:55:LPAREN
82:56:ID s
82:57:COMMA
82:59:INT 1
82:60:COMMA
82:62:ID len
82:66:MINUS
82:68:INT 1
82:69:RPAREN
82:70:SEMICOLON
83:34:INT 1
83:35:RPAREN
84:28:ELSE
84:33:INT 1
85:16:VAR
85:20:ID len_proper
85:31:ASSIGN
85:34:ID size
85:38:LPAREN
85:39:ID s_proper
85:47:RPAREN
86:16:VAR
86:20:ID res
86:24:ASSIGN
86:27:INT 0
87:12:IN
87:15:FOR
87:19:ID idx
87:23:ASSIGN
87:26:INT 0
87:28:TO
87:31:ID len_proper
87:42:MINUS
87:44:INT 1
88:15:DO
88:18:LET
88:22:VAR
88:26:ID curr_digit
88:37:ASSIGN
88:40:ID c2i
88:43:LPAREN
88:44:ID substring
88:53:LPAREN
88:54:ID s_proper
88:62:COMMA
88:64:ID idx
88:67:COMMA
88:69:INT 1
88:70:RPAREN
88:71:RPAREN
89:18:IN
89:21:IF
89:24:INT 0
89:26:LE
89:29:ID curr_digit
89:40:AND
89:42:ID curr_digit
89:53:LE
89:56:INT 9
90:21:THEN
90:26:ID res
90:30:ASSIGN
90:33:INT 10
90:36:TIMES
90:38:ID res
90:42:PLUS
90:44:ID curr_digit
91:21:ELSE
91:26:LPAREN
91:27:ID print
91:32:LPAREN
91:33:STRING "Error in s2i. Illegal character in string: '"
91:79:RPAREN
91:80:SEMICOLON
92:27:ID print
92:32:LPAREN
92:33:ID s
92:34:RPAREN
92:35:SEMICOLON
93:27:ID print
93:32:LPAREN
93:33:STRING "'\n"
93:38:RPAREN
93:39:RPAREN
94:18:END
94:21:SEMICOLON
95:15:ID res
96:12:END
98:5:FUNCTION
98:14:ID wrap_string
98:25:LPAREN
98:26:ID s
98:27:COLON
98:29:ID string
98:35:RPAREN
98:36:COLON
98:38:ID string
98:45:EQ
99:7:ID concat
99:13:LPAREN
99:14:STRING "\""
99:20:COMMA
99:22:ID concat
99:28:LPAREN
99:29:ID s
99:30:COMMA
99:32:STRING "\""
99:38:RPAREN
99:39:RPAREN
101:5:FUNCTION
101:14:ID bool2s
101:20:LPAREN
101:21:ID b
101:22:COLON
101:24:ID int
101:27:RPAREN
101:28:COLON
101:30:ID string
101:37:EQ
102:7:IF
102:10:ID b
103:7:THEN
103:12:STRING "#t"
104:7:ELSE
104:12:STRING "#f"
106:5:TYPE
106:10:ID token
106:16:EQ
106:18:LBRACE
106:19:ID i
106:20:COLON
106:22:ID int
106:25:COMMA
106:27:ID s
106:28:COLON
106:30:ID string
106:36:COMMA
106:38:ID typ
106:41:COLON
106:43:ID string
106:49:RBRACE
108:5:FUNCTION
108:14:ID mk_int_token
108:26:LPAREN
108:27:ID v
108:28:COLON
108:30:ID int
108:33:RPAREN
108:34:COLON
108:36:ID token
108:42:EQ
109:7:ID token
109:13:LBRACE
109:14:ID i
109:16:EQ
109:18:ID v
109:19:COMMA
109:21:ID s
109:23:EQ
109:25:STRING ""
109:27:COMMA
109:29:ID typ
109:33:EQ
109:35:STRING "int"
109:40:RBRACE
111:5:FUNCTION
111:14:ID mk_id_token
111:25:LPAREN
111:26:ID id
111:28:COLON
111:30:ID string
111:36:RPAREN
111:37:COLON
111:39:ID token
111:45:EQ
112:7:ID token
112:13:LBRACE
112:14:ID i
112:16:EQ
112:18:INT 0
112:19:COMMA
112:21:ID s
112:23:EQ
112:25:ID id
112:27:COMMA
112:29:ID typ
112:33:EQ
112:35:STRING "id"
112:39:RBRACE
114:5:FUNCTION
114:14:ID mk_str_token
114:26:LPAREN
114:27:ID str
114:30:COLON
114:32:ID string
114:38:RPAREN
114:39:COLON
114:41:ID token
114:47:EQ
115:7:ID token
115:13:LBRACE
115:14:ID i
115:16:EQ
115:18:INT 0
115:19:COMMA
115:21:ID s
115:23:EQ
115:25:ID str
115:28:COMMA
115:30:ID typ
115:34:EQ
115:36:STRING "str"
115:41:RBRACE
117:5:FUNCTION
117:14:ID mk_bool_token
117:27:LPAREN
117:28:ID b
117:29:COLON
117:31:ID int
117:34:RPAREN
117:35:COLON
117:37:ID token
117:43:EQ
118:7:ID token
118:13:LBRACE
118:14:ID i
118:16:EQ
118:18:ID b
118:19:COMMA
118:21:ID s
118:23:EQ
118:25:STRING ""
118:27:COMMA
118:29:ID typ
118:33:EQ
118:35:STRING "bool"
118:41:RBRACE
120:5:FUNCTION
120:14:ID int_token_p
120:25:LPAREN
120:26:ID t
120:27:COLON
120:29:ID token
120:34:RPAREN
120:35:COLON
120:37:ID int
120:41:EQ
121:7:ID t
121:8:DOT
121:9:ID typ
121:13:EQ
121:15:STRING "int"
123:5:FUNCTION
123:14:ID str_token_p
123:25:LPAREN
123:26:ID t
123:27:COLON
123:29:ID token
123:34:RPAREN
123:35:COLON
123:37:ID int
123:41:EQ
124:7:ID t
124:8:DOT
124:9:ID typ
124:13:EQ
124:15:STRING "str"
126:5:FUNCTION
126:14:ID id_token_p
126:24:LPAREN
126:25:ID t
126:26:COLON
126:28:ID token
126:33:RPAREN
126:34:COLON
126:36:ID int
126:40:EQ
127:7:ID t
127:8:DOT
127:9:ID typ
127:13:EQ
127:15:STRING "id"
129:5:FUNCTION
129:14:ID bool_token_p
129:26:LPAREN
129:27:ID t
129:28:COLON
129:30:ID token
129:35:RPAREN
129:36:COLON
129:38:ID int
129:42:EQ
130:7:ID t
130:8:DOT
130:9:ID typ
130:13:EQ
130:15:STRING "bool"
132:5:FUNCTION
132:14:ID get_int_token
132:27:LPAREN
132:28:ID t
132:29:COLON
132:31:ID token
132:36:RPAREN
132:37:COLON
132:39:ID int
132:43:EQ
133:7:ID t
133:8:DOT
133:9:ID i
135:5:FUNCTION
135:14:ID get_id_token
135:26:LPAREN
135:27:ID t
135:28:COLON
135:30:ID token
135:35:RPAREN
135:36:COLON
135:38:ID string
135:45:EQ
136:7:ID t
136:8:DOT
136:9:ID s
138:5:FUNCTION
138:14:ID get_str_token
138:27:LPAREN
138:28:ID t
138:29:COLON
138:31:ID token
138:36:RPAREN
138:37:COLON
138:39:ID string
138:46:EQ
139:7:ID t
139:8:DOT
139:9:ID s
141:5:FUNCTION
141:14:ID get_bool_token
141:28:LPAREN
141:29:ID t
141:30:COLON
141:32:ID token
141:37:RPAREN
141:38:COLON
141:40:ID int
141:44:EQ
142:7:ID t
142:8:DOT
142:9:ID i
146:5:VAR
146:9:ID LPAREN
146:16:ASSIGN
146:19:ID token
146:25:LBRACE
146:26:ID i
146:28:EQ
146:30:INT 0
146:31:COMMA
146:33:ID s
146:35:EQ
146:37:STRING ""
146:39:COMMA
146:41:ID typ
146:45:EQ
146:47:STRING "syntax"
146:55:RBRACE
147:5:VAR
147:9:ID RPAREN
147:16:ASSIGN
147:19:ID token
147:25:LBRACE
147:26:ID i
147:28:EQ
147:30:INT 0
147:31:COMMA
147:33:ID s
147:35:EQ
147:37:STRING ""
147:39:COMMA
147:41:ID typ
147:45:EQ
147:47:STRING "syntax"
147:55:RBRACE
151:5:FUNCTION
151:14:ID token2s
151:21:LPAREN
151:22:ID t
151:23:COLON
151:25:ID token
151:30:RPAREN
151:31:COLON
151:33:ID string
151:40:EQ
152:7:IF
152:10:ID t
152:12:EQ
152:14:ID LPAREN
153:7:THEN
153:12:STRING "("
154:7:ELSE
154:12:IF
154:15:ID t
154:17:EQ
154:19:ID RPAREN
155:7:THEN
155:12:STRING ")"
156:7:ELSE
156:12:IF
156:15:ID int_token_p
156:26:LPAREN
156:27:ID t
156:28:RPAREN
157:7:THEN
157:12:ID i2s
157:15:LPAREN
157:16:ID get_int_token
157:29:LPAREN
157:30:ID t
157:31:RPAREN
157:32:RPAREN
158:7:ELSE
158:12:IF
158:15:ID id_token_p
158:25:LPAREN
158:26:ID t
158:27:RPAREN
159:7:THEN
159:12:ID get_id_token
159:24:LPAREN
159:25:ID t
159:26:RPAREN
160:7:ELSE
160:12:IF
160:15:ID str_token_p
160:26:LPAREN
160:27:ID t
160:28:RPAREN
161:7:THEN
161:12:ID wrap_string
161:23:LPAREN
161:24:ID get_str_token
161:37:LPAREN
161:38:ID t
161:39:RPAREN
161:40:RPAREN
162:7:ELSE
162:12:IF
162:15:ID bool_token_p
162:27:LPAREN
162:28:ID t
162:29:RPAREN
163:7:THEN
163:12:ID bool2s
163:18:LPAREN
163:19:ID get_bool_token
163:33:LPAREN
163:34:ID t
163:35:RPAREN
163:36:RPAREN
164:7:ELSE
164:12:LPAREN
164:13:ID print
164:18:LPAREN
164:19:STRING "Unknown token in token2s. It has type '"
164:60:RPAREN
164:61:SEMICOLON
165:13:ID print
165:18:LPAREN
165:19:ID t
165:20:DOT
165:21:ID typ
165:24:RPAREN
165:25:SEMICOLON
166:13:ID print
166:18:LPAREN
166:19:STRING "'.\n"
166:25:RPAREN
166:26:SEMICOLON
167:13:STRING ""
167:15:RPAREN
171:5:TYPE
171:10:ID Int
171:14:EQ
171:16:LBRACE
171:17:ID v
171:18:COLON
171:20:ID int
171:23:RBRACE
172:5:TYPE
172:10:ID String
172:17:EQ
172:19:LBRACE
172:20:ID v
172:21:COLON
172:23:ID string
172:29:RBRACE
177:5:VAR
177:9:ID whitespace
177:20:ASSIGN
177:23:STRING " \n\t"
178:5:VAR
178:9:ID digit
178:15:ASSIGN
178:18:STRING "0123456789"
179:5:VAR
179:9:ID syntax_char
179:21:ASSIGN
179:24:STRING "()"
180:5:VAR
180:9:ID uminus_char
180:21:ASSIGN
180:24:STRING "-"
181:5:VAR
181:9:ID string_indicator
181:26:ASSIGN
181:29:STRING "\""
182:5:VAR
182:9:ID string_escape_indicator
182:33:ASSIGN
182:36:STRING "\\"
183:5:VAR
183:9:ID bool_indicator
183:24:ASSIGN
183:27:STRING "#"
184:5:VAR
184:9:ID bool_char
184:19:ASSIGN
184:22:STRING "tf"
185:5:VAR
185:9:ID id_char
185:17:ASSIGN
185:20:ID concat
185:26:LPAREN
185:27:ID digit
185:32:COMMA
186:27:STRING "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+-*/^_=<>%$@&|~!?"
187:46:RPAREN
189:5:FUNCTION
189:14:ID contains
189:23:LPAREN
189:24:ID char_class
189:34:COLON
189:36:ID string
189:42:COMMA
189:44:ID char
189:48:COLON
189:50:ID string
189:56:RPAREN
189:57:COLON
189:59:ID int
189:63:EQ
190:7:LET
190:11:VAR
190:15:ID res
190:19:ASSIGN
190:22:INT 0
191:7:IN
191:10:FOR
191:14:ID idx
191:18:ASSIGN
191:21:INT 0
191:23:TO
191:26:ID size
191:30:LPAREN
191:31:ID char_class
191:41:RPAREN
191:43:MINUS
191:45:INT 1
192:10:DO
192:13:IF
192:16:ID char
192:21:EQ
192:23:ID substring
192:32:LPAREN
192:33:ID char_class
192:43:COMMA
192:45:ID idx
192:48:COMMA
192:50:INT 1
192:51:RPAREN
193:13:THEN
193:18:LPAREN
193:19:ID res
193:23:ASSIGN
193:26:INT 1
193:27:SEMICOLON
193:29:BREAK
193:34:RPAREN
193:35:SEMICOLON
194:10:ID res
195:7:END
197:5:VAR
197:9:ID prev_char_
197:20:ASSIGN
197:23:STRING ""
198:5:VAR
198:9:ID curr_char_
198:20:ASSIGN
198:23:STRING ""
199:5:VAR
199:9:ID next_char_
199:20:ASSIGN
199:23:STRING ""
201:5:FUNCTION
201:14:ID prev_char
201:24:LPAREN
201:25:RPAREN
201:26:COLON
201:28:ID string
201:35:EQ
202:7:ID prev_char_
204:5:FUNCTION
204:14:ID curr_char
204:24:LPAREN
204:25:RPAREN
204:26:COLON
204:28:ID string
204:35:EQ
205:7:ID curr_char_
207:5:FUNCTION
207:14:ID next_char
207:24:LPAREN
207:25:RPAREN
207:26:COLON
207:28:ID string
207:35:EQ
208:7:IF
208:10:ID next_char_
208:21:NEQ
208:24:STRING ""
209:7:THEN
209:12:ID next_char_
210:7:ELSE
210:12:IF
210:15:ID curr_char_
210:26:EQ
210:28:STRING ""
211:7:THEN
212:9:STRING ""
213:7:ELSE
213:12:LPAREN
213:13:ID next_char_
213:24:ASSIGN
213:27:ID read_char
213:36:LPAREN
213:37:RPAREN
213:38:SEMICOLON
213:40:ID next_char_
213:50:RPAREN
215:5:FUNCTION
215:14:ID advance_reader
215:29:LPAREN
215:30:RPAREN
215:32:EQ
216:7:LPAREN
216:8:ID prev_char_
216:19:ASSIGN
216:22:ID curr_char_
216:32:SEMICOLON
217:8:IF
217:11:ID next_char_
217:22:NEQ
217:25:STRING ""
218:8:THEN
218:13:ID curr_char_
218:24:ASSIGN
218:27:ID next_char_
219:8:ELSE
219:13:ID curr_char_
219:24:ASSIGN
219:27:ID read_char
219:36:LPAREN
219:37:RPAREN
219:38:SEMICOLON
220:8:ID next_char_
220:19:ASSIGN
220:22:STRING ""
220:24:RPAREN
222:5:FUNCTION
222:14:ID init_repl
222:23:LPAREN
222:24:RPAREN
222:26:EQ
223:7:ID advance_reader
223:22:LPAREN
223:23:RPAREN
226:5:FUNCTION
226:14:ID looking_at
226:24:LPAREN
226:25:ID char_class
226:35:COLON
226:37:ID string
226:43:RPAREN
226:44:COLON
226:46:ID int
226:50:EQ
227:7:ID contains
227:15:LPAREN
227:16:ID char_class
227:26:COMMA
227:28:ID curr_char
227:37:LPAREN
227:38:RPAREN
227:39:RPAREN
229:5:FUNCTION
229:14:ID looking_at_char_followed_by
229:41:LPAREN
229:42:ID char
229:46:COLON
229:48:ID string
229:54:COMMA
229:56:ID char_class
229:66:COLON
229:68:ID string
229:74:RPAREN
229:75:COLON
229:77:ID int
229:81:EQ
230:7:ID curr_char
230:16:LPAREN
230:17:RPAREN
230:19:EQ
230:21:ID char
230:26:AND
230:28:ID contains
230:36:LPAREN
230:37:ID char_class
230:47:COMMA
230:49:ID next_char
230:58:LPAREN
230:59:RPAREN
230:60:RPAREN
232:5:FUNCTION
232:14:ID eof_p
232:20:LPAREN
232:21:RPAREN
232:22:COLON
232:24:ID int
232:28:EQ
233:7:ID curr_char
233:16:LPAREN
233:17:RPAREN
233:19:EQ
233:21:STRING ""
233:24:AND
233:26:ID next_char
233:35:LPAREN
233:36:RPAREN
233:38:EQ
233:40:STRING ""
235:5:FUNCTION
235:14:ID parse_int_token
235:29:LPAREN
235:30:ID sign
235:34:COLON
235:36:ID int
235:39:RPAREN
235:40:COLON
235:42:ID token
235:48:EQ
236:7:LET
236:11:VAR
236:15:ID res
236:19:ASSIGN
236:22:INT 0
237:7:IN
237:10:WHILE
237:16:ID looking_at
237:26:LPAREN
237:27:ID digit
237:32:RPAREN
238:10:DO
238:13:LPAREN
238:14:ID res
238:18:ASSIGN
238:21:INT 10
238:24:TIMES
238:26:ID res
238:30:PLUS
238:32:ID c2i
238:35:LPAREN
238:36:ID curr_char
238:45:LPAREN
238:46:RPAREN
238:47:RPAREN
238:48:SEMICOLON
239:14:ID advance_reader
239:29:LPAREN
239:30:RPAREN
239:31:RPAREN
239:32:SEMICOLON
240:10:ID mk_int_token
240:22:LPAREN
240:23:ID sign
240:28:TIMES
240:30:ID res
240:33:RPAREN
241:7:END
243:5:FUNCTION
243:14:ID parse_syntax_token
243:33:LPAREN
243:34:RPAREN
243:35:COLON
243:37:ID token
243:43:EQ
244:7:LPAREN
244:8:ID advance_reader
244:23:LPAREN
244:24:RPAREN
244:25:SEMICOLON
245:8:IF
245:11:ID prev_char
245:20:LPAREN
245:21:RPAREN
245:23:EQ
245:25:STRING "("
246:8:THEN
246:13:ID LPAREN
247:8:ELSE
247:13:IF
247:16:ID prev_char
247:25:LPAREN
247:26:RPAREN
247:28:EQ
247:30:STRING ")"
248:8:THEN
248:13:ID RPAREN
249:8:ELSE
249:13:LPAREN
249:14:ID print
249:19:LPAREN
249:20:STRING "Unknown syntax token: '"
249:45:RPAREN
249:46:SEMICOLON
250:14:ID print
250:19:LPAREN
250:20:ID prev_char
250:29:LPAREN
250:30:RPAREN
250:31:RPAREN
250:32:SEMICOLON
251:14:ID print
251:19:LPAREN
251:20:STRING "'\n"
251:25:RPAREN
251:26:SEMICOLON
252:14:NIL
252:17:RPAREN
252:18:RPAREN
254:5:FUNCTION
254:14:ID parse_id_token
254:29:LPAREN
254:30:RPAREN
254:31:COLON
254:33:ID token
254:39:EQ
255:7:LET
255:11:VAR
255:15:ID id
255:18:ASSIGN
255:21:STRING ""
256:7:IN
256:10:WHILE
256:16:ID looking_at
256:26:LPAREN
256:27:ID id_char
256:34:RPAREN
257:10:DO
257:13:LPAREN
257:14:ID id
257:17:ASSIGN
257:20:ID concat
257:26:LPAREN
257:27:ID id
257:29:COMMA
257:31:ID curr_char
257:40:LPAREN
257:41:RPAREN
257:42:RPAREN
257:43:SEMICOLON
258:14:ID advance_reader
258:29:LPAREN
258:30:RPAREN
258:31:RPAREN
258:32:SEMICOLON
259:10:ID mk_id_token
259:21:LPAREN
259:22:ID id
259:24:RPAREN
260:7:END
262:5:FUNCTION
262:14:ID parse_bool_token
262:31:LPAREN
262:32:RPAREN
262:33:COLON
262:35:ID token
262:41:EQ
263:7:LET
263:11:VAR
263:15:ID bool_char
263:25:ASSIGN
263:28:ID curr_char
263:37:LPAREN
263:38:RPAREN
264:7:IN
264:10:ID advance_reader
264:25:LPAREN
264:26:RPAREN
264:27:SEMICOLON
265:10:IF
265:13:ID bool_char
265:23:EQ
265:25:STRING "t"
266:10:THEN
266:15:ID mk_bool_token
266:28:LPAREN
266:29:INT 1
266:30:RPAREN
267:10:ELSE
267:15:IF
267:18:ID bool_char
267:28:EQ
267:30:STRING "f"
268:10:THEN
268:15:ID mk_bool_token
268:28:LPAREN
268:29:INT 0
268:30:RPAREN
269:10:ELSE
269:15:LPAREN
269:16:ID print
269:21:LPAREN
269:22:STRING "Unknown char used for bool literal: '"
269:61:RPAREN
269:62:SEMICOLON
270:16:ID print
270:21:LPAREN
270:22:ID curr_char
270:31:LPAREN
270:32:RPAREN
270:33:RPAREN
270:34:SEMICOLON
271:16:ID print
271:21:LPAREN
271:22:STRING "'\n"
271:27:RPAREN
271:28:SEMICOLON
272:16:NIL
272:19:RPAREN
273:7:END
276:5:FUNCTION
276:14:ID parse_string_escape
276:34:LPAREN
276:35:RPAREN
276:36:COLON
276:38:ID string
276:45:EQ
277:7:IF
277:10:ID curr_char
277:19:LPAREN
277:20:RPAREN
277:22:EQ
277:24:STRING "n"
278:7:THEN
278:12:LPAREN
278:13:ID advance_reader
278:28:LPAREN
278:29:RPAREN
278:30:SEMICOLON
278:32:STRING "\n"
278:36:RPAREN
279:7:ELSE
279:12:IF
279:15:ID curr_char
279:24:LPAREN
279:25:RPAREN
279:27:EQ
279:29:STRING "t"
280:7:THEN
280:12:LPAREN
280:13:ID advance_reader
280:28:LPAREN
280:29:RPAREN
280:30:SEMICOLON
280:32:STRING "\t"
280:36:RPAREN
281:7:ELSE
281:12:IF
281:15:ID curr_char
281:24:LPAREN
281:25:RPAREN
281:27:EQ
281:29:STRING "\""
282:7:THEN
282:12:LPAREN
282:13:ID advance_reader
282:28:LPAREN
282:29:RPAREN
282:30:SEMICOLON
282:32:STRING "\""
282:38:RPAREN
283:7:ELSE
283:12:IF
283:15:ID curr_char
283:24:LPAREN
283:25:RPAREN
283:27:EQ
283:29:STRING "\\"
284:7:THEN
284:12:LPAREN
284:13:ID advance_reader
284:28:LPAREN
284:29:RPAREN
284:30:SEMICOLON
284:32:STRING "\\"
284:36:RPAREN
285:7:ELSE
285:12:IF
285:15:ID looking_at
285:25:LPAREN
285:26:ID digit
285:31:RPAREN
286:7:THEN
286:12:LET
286:16:VAR
286:20:ID d0
286:23:ASSIGN
286:26:ID c2i
286:29:LPAREN
286:30:ID curr_char
286:39:LPAREN
286:40:RPAREN
286:41:RPAREN
287:12:IN
287:15:ID advance_reader
287:30:LPAREN
287:31:RPAREN
287:32:SEMICOLON
288:15:IF
288:18:ID looking_at
288:28:LPAREN
288:29:ID digit
288:34:RPAREN
289:15:THEN
289:20:LET
289:24:VAR
289:28:ID d1
289:31:ASSIGN
289:34:ID c2i
289:37:LPAREN
289:38:ID curr_char
289:47:LPAREN
289:48:RPAREN
289:49:RPAREN
290:20:IN
290:23:ID advance_reader
290:38:LPAREN
290:39:RPAREN
290:40:SEMICOLON
291:23:IF
291:26:ID looking_at
291:36:LPAREN
291:37:ID digit
291:42:RPAREN
292:23:THEN
292:28:LET
292:32:VAR
292:36:ID d2
292:39:ASSIGN
292:42:ID c2i
292:45:LPAREN
292:46:ID curr_char
292:55:LPAREN
292:56:RPAREN
292:57:RPAREN
293:32:VAR
293:36:ID ascii_code
293:47:ASSIGN
293:50:INT 100
293:54:TIMES
293:56:ID d0
293:59:PLUS
293:61:INT 10
293:64:TIMES
293:66:ID d1
293:69:PLUS
293:71:ID d2
294:28:IN
294:31:ID advance_reader
294:46:LPAREN
294:47:RPAREN
294:48:SEMICOLON
295:31:IF
295:34:INT 0
295:36:LE
295:39:ID ascii_code
295:50:AND
295:52:ID ascii_code
295:63:LE
295:66:INT 255
296:31:THEN
296:36:ID chr
296:39:LPAREN
296:40:ID ascii_code
296:50:RPAREN
297:31:ELSE
297:36:LPAREN
297:37:ID print
297:42:LPAREN
297:43:STRING "Escaped ASCII code was out of range [0; 255]: "
297:91:RPAREN
297:92:SEMICOLON
298:37:ID print
298:42:LPAREN
298:43:ID i2s
298:46:LPAREN
298:47:ID ascii_code
298:57:RPAREN
298:58:RPAREN
298:59:SEMICOLON
299:37:ID print
299:42:LPAREN
299:43:STRING "\n"
299:47:RPAREN
299:48:SEMICOLON
300:37:STRING ""
300:39:RPAREN
301:28:END
302:23:ELSE
302:28:LPAREN
302:29:ID print
302:34:LPAREN
302:35:STRING "Illegal string ASCII escape sequence at third digit: '"
302:91:RPAREN
302:92:SEMICOLON
303:29:ID print
303:34:LPAREN
303:35:ID curr_char
303:44:LPAREN
303:45:RPAREN
303:46:RPAREN
303:47:SEMICOLON
304:29:ID print
304:34:LPAREN
304:35:STRING "'\n"
304:40:RPAREN
304:41:SEMICOLON
305:29:STRING ""
305:31:RPAREN
306:20:END
307:15:ELSE
307:20:LPAREN
307:21:ID print
307:26:LPAREN
307:27:STRING "Illegal string ASCII escape sequence at second digit: '"
307:84:RPAREN
307:85:SEMICOLON
308:21:ID print
308:26:LPAREN
308:27:ID curr_char
308:36:LPAREN
308:37:RPAREN
308:38:RPAREN
308:39:SEMICOLON
309:21:ID print
309:26:LPAREN
309:27:STRING "'\n"
309:32:RPAREN
309:33:SEMICOLON
310:21:STRING ""
310:23:RPAREN
311:12:END
312:7:ELSE
312:12:LPAREN
312:13:ID print
312:18:LPAREN
312:19:STRING "Illegal string escape sequence, starting at '"
312:66:RPAREN
312:67:SEMICOLON
313:13:ID print
313:18:LPAREN
313:19:ID prev_char
313:28:LPAREN
313:29:RPAREN
313:30:RPAREN
313:31:SEMICOLON
314:13:ID print
314:18:LPAREN
314:19:ID curr_char
314:28:LPAREN
314:29:RPAREN
314:30:RPAREN
314:31:SEMICOLON
315:13:ID print
315:18:LPAREN
315:19:ID next_char
315:28:LPAREN
315:29:RPAREN
315:30:RPAREN
315:31:SEMICOLON
316:13:ID print
316:18:LPAREN
316:19:STRING "'\n"
316:24:RPAREN
316:25:SEMICOLON
317:13:STRING ""
317:15:RPAREN
320:5:FUNCTION
320:14:ID parse_string_token
320:33:LPAREN
320:34:RPAREN
320:35:COLON
320:37:ID token
320:43:EQ
321:7:LET
321:11:VAR
321:15:ID str
321:19:ASSIGN
321:22:STRING ""
322:7:IN
322:10:WHILE
322:16:ID not
322:19:LPAREN
322:20:ID looking_at
322:30:LPAREN
322:31:ID string_indicator
322:47:RPAREN
322:48:RPAREN
323:10:DO
323:13:LPAREN
323:14:IF
323:17:ID eof_p
323:23:LPAREN
323:24:RPAREN
324:14:THEN
324:19:LPAREN
324:20:ID print
324:25:LPAREN
324:26:STRING "Unfinished string: "
324:47:RPAREN
324:48:SEMICOLON
325:20:ID print
325:25:LPAREN
325:26:ID wrap_string
325:37:LPAREN
325:38:ID str
325:41:RPAREN
325:42:RPAREN
325:43:SEMICOLON
326:20:ID print
326:25:LPAREN
326:26:STRING "\n"
326:30:RPAREN
326:31:SEMICOLON
327:20:BREAK
327:25:RPAREN
327:26:SEMICOLON
328:14:IF
328:17:ID looking_at
328:27:LPAREN
328:28:ID string_escape_indicator
328:51:RPAREN
329:14:THEN
329:19:LPAREN
329:20:ID advance_reader
329:35:LPAREN
329:36:RPAREN
329:37:SEMICOLON
330:20:ID str
330:24:ASSIGN
330:27:ID concat
330:33:LPAREN
330:34:ID str
330:37:COMMA
330:39:ID parse_string_escape
330:58:LPAREN
330:59:RPAREN
330:60:RPAREN
330:61:RPAREN
331:14:ELSE
331:19:LPAREN
331:20:ID str
331:24:ASSIGN
331:27:ID concat
331:33:LPAREN
331:34:ID str
331:37:COMMA
331:39:ID curr_char
331:48:LPAREN
331:49:RPAREN
331:50:RPAREN
331:51:SEMICOLON
332:20:ID advance_reader
332:35:LPAREN
332:36:RPAREN
332:37:RPAREN
332:38:RPAREN
332:39:SEMICOLON
333:10:ID advance_reader
333:25:LPAREN
333:26:RPAREN
333:27:SEMICOLON
334:10:ID mk_str_token
334:22:LPAREN
334:23:ID str
334:26:RPAREN
335:7:END
338:5:FUNCTION
338:14:ID read_token
338:24:LPAREN
338:25:RPAREN
338:26:COLON
338:28:ID token
338:34:EQ
339:7:IF
339:10:ID eof_p
339:16:LPAREN
339:17:RPAREN
340:7:THEN
340:12:NIL
341:7:ELSE
341:12:LPAREN
341:13:LPAREN
341:14:RPAREN
341:15:SEMICOLON
346:13:WHILE
346:19:ID looking_at
346:29:LPAREN
346:30:ID whitespace
346:40:RPAREN
347:13:DO
347:16:ID advance_reader
347:31:LPAREN
347:32:RPAREN
347:33:SEMICOLON
348:13:IF
348:16:ID looking_at
348:26:LPAREN
348:27:ID digit
348:32:RPAREN
349:13:THEN
349:18:ID parse_int_token
349:34:LPAREN
349:35:INT 1
349:36:RPAREN
350:13:ELSE
350:18:IF
350:21:ID looking_at_char_followed_by
350:48:LPAREN
350:49:ID uminus_char
350:60:COMMA
350:62:ID digit
350:67:RPAREN
351:13:THEN
351:18:LPAREN
351:19:ID advance_reader
351:34:LPAREN
351:35:RPAREN
351:36:SEMICOLON
351:38:ID parse_int_token
351:54:LPAREN
351:55:MINUS
351:56:INT 1
351:57:RPAREN
351:58:RPAREN
352:13:ELSE
352:18:IF
352:21:ID looking_at_char_followed_by
352:48:LPAREN
352:49:ID bool_indicator
352:63:COMMA
352:65:ID bool_char
352:74:RPAREN
353:13:THEN
353:18:LPAREN
353:19:ID advance_reader
353:34:LPAREN
353:35:RPAREN
353:36:SEMICOLON
353:38:ID parse_bool_token
353:55:LPAREN
353:56:RPAREN
353:57:RPAREN
354:13:ELSE
354:18:IF
354:21:ID looking_at
354:31:LPAREN
354:32:ID syntax_char
354:43:RPAREN
355:13:THEN
355:18:ID parse_syntax_token
355:37:LPAREN
355:38:RPAREN
356:13:ELSE
356:18:IF
356:21:ID looking_at
356:31:LPAREN
356:32:ID id_char
356:39:RPAREN
357:13:THEN
357:18:ID parse_id_token
357:33:LPAREN
357:34:RPAREN
358:13:ELSE
358:18:IF
358:21:ID looking_at
358:31:LPAREN
358:32:ID string_indicator
358:48:RPAREN
359:13:THEN
359:18:LPAREN
359:19:ID advance_reader
359:34:LPAREN
359:35:RPAREN
359:36:SEMICOLON
359:38:ID parse_string_token
359:57:LPAREN
359:58:RPAREN
359:59:RPAREN
360:13:ELSE
360:18:LPAREN
360:19:ID print
360:24:LPAREN
360:25:STRING "Unknown character: '"
360:47:RPAREN
360:48:SEMICOLON
361:19:ID print
361:24:LPAREN
361:25:ID curr_char
361:34:LPAREN
361:35:RPAREN
361:36:RPAREN
361:37:SEMICOLON
362:19:ID print
362:24:LPAREN
362:25:STRING "'. Cannot lex further.\n"
362:51:RPAREN
362:52:SEMICOLON
363:19:NIL
363:22:RPAREN
363:23:RPAREN
367:5:TYPE
367:10:ID deque_content_type
367:29:EQ
367:31:ID token
368:5:TYPE
368:10:ID deque_elem
368:21:EQ
368:23:LBRACE
368:24:ID val
368:27:COLON
368:29:ID deque_content_type
368:47:COMMA
368:49:ID left
368:53:COLON
368:55:ID deque_elem
368:65:COMMA
368:67:ID right
368:72:COLON
368:74:ID deque_elem
368:84:RBRACE
369:5:TYPE
369:10:ID deque
369:16:EQ
369:18:LBRACE
369:19:ID leftmost
369:27:COLON
369:29:ID deque_elem
369:39:COMMA
369:41:ID rightmost
369:50:COLON
369:52:ID deque_elem
369:62:RBRACE
371:5:FUNCTION
371:14:ID push_left
371:23:LPAREN
371:24:ID a
371:25:COLON
371:27:ID deque_content_type
371:45:COMMA
371:47:ID Q
371:48:COLON
371:50:ID deque
371:55:RPAREN
371:57:EQ
372:7:LET
372:11:VAR
372:15:ID old_left
372:24:ASSIGN
372:27:ID Q
372:28:DOT
372:29:ID leftmost
373:11:VAR
373:15:ID new_left
373:24:ASSIGN
373:27:ID deque_elem
373:38:LBRACE
373:39:ID val
373:43:EQ
373:45:ID a
373:46:COMMA
374:39:ID left
374:44:EQ
374:46:NIL
374:49:COMMA
375:39:ID right
375:45:EQ
375:47:ID old_left
375:55:RBRACE
376:7:IN
376:10:ID Q
376:11:DOT
376:12:ID leftmost
376:21:ASSIGN
376:24:ID new_left
376:32:SEMICOLON
377:10:IF
377:13:ID old_left
377:22:NEQ
377:25:NIL
378:10:THEN
378:15:ID old_left
378:23:DOT
378:24:ID left
378:29:ASSIGN
378:32:ID new_left
379:10:ELSE
379:15:ID Q
379:16:DOT
379:17:ID rightmost
379:27:ASSIGN
379:30:ID new_left
380:7:END
382:5:FUNCTION
382:14:ID push_right
382:24:LPAREN
382:25:ID a
382:26:COLON
382:28:ID deque_content_type
382:46:COMMA
382:48:ID Q
382:49:COLON
382:51:ID deque
382:56:RPAREN
382:58:EQ
383:7:LET
383:11:VAR
383:15:ID old_right
383:25:ASSIGN
383:28:ID Q
383:29:DOT
383:30:ID rightmost
384:11:VAR
384:15:ID new_right
384:25:ASSIGN
384:28:ID deque_elem
384:39:LBRACE
384:40:ID val
384:44:EQ
384:46:ID a
384:47:COMMA
385:40:ID left
385:45:EQ
385:47:ID old_right
385:56:COMMA
386:40:ID right
386:46:EQ
386:48:NIL
386:51:RBRACE
387:7:IN
387:10:ID Q
387:11:DOT
387:12:ID rightmost
387:22:ASSIGN
387:25:ID new_right
387:34:SEMICOLON
388:10:IF
388:13:ID old_right
388:23:NEQ
388:26:NIL
389:10:THEN
389:15:ID old_right
389:24:DOT
389:25:ID right
389:31:ASSIGN
389:34:ID new_right
390:10:ELSE
390:15:ID Q
390:16:DOT
390:17:ID leftmost
390:26:ASSIGN
390:29:ID new_right
391:7:END
393:5:FUNCTION
393:14:ID pop_right
393:23:LPAREN
393:24:ID Q
393:25:COLON
393:27:ID deque
393:32:RPAREN
393:33:COLON
393:35:ID deque_content_type
393:54:EQ
394:7:IF
394:10:ID Q
394:11:DOT
394:12:ID leftmost
394:21:EQ
394:23:NIL
394:27:OR
394:29:ID Q
394:30:DOT
394:31:ID rightmost
394:41:EQ
394:43:NIL
395:7:THEN
395:12:LPAREN
395:13:ID print
395:18:LPAREN
395:19:STRING "Deque error: tried to pop from empty or bad deque\n"
395:72:RPAREN
395:73:SEMICOLON
396:13:NIL
396:16:RPAREN
397:7:ELSE
397:12:LET
397:16:VAR
397:20:ID res
397:24:ASSIGN
397:27:ID Q
397:28:DOT
397:29:ID rightmost
398:16:VAR
398:20:ID new_right
398:30:ASSIGN
398:33:ID res
398:36:DOT
398:37:ID left
399:12:IN
399:15:ID Q
399:16:DOT
399:17:ID rightmost
399:27:ASSIGN
399:30:ID new_right
399:39:SEMICOLON
400:15:IF
400:18:ID new_right
400:28:EQ
400:30:NIL
401:15:THEN
401:20:ID Q
401:21:DOT
401:22:ID leftmost
401:31:ASSIGN
401:34:NIL
402:15:ELSE
402:20:LPAREN
402:21:ID new_right
402:30:DOT
402:31:ID right
402:37:ASSIGN
402:40:NIL
402:43:RPAREN
402:44:SEMICOLON
403:15:ID res
403:18:DOT
403:19:ID val
404:12:END
406:5:FUNCTION
406:14:ID empty
406:19:LPAREN
406:20:ID Q
406:21:COLON
406:23:ID deque
406:28:RPAREN
406:29:COLON
406:31:ID int
406:35:EQ
407:7:ID Q
407:8:DOT
407:9:ID leftmost
407:18:EQ
407:20:NIL
407:24:OR
407:26:ID Q
407:27:DOT
407:28:ID rightmost
407:38:EQ
407:40:NIL
410:4:TYPE
410:9:ID tokens
410:16:EQ
410:18:ID deque
412:4:FUNCTION
412:13:ID read_sexp_to_tokens
412:32:LPAREN
412:33:RPAREN
412:34:COLON
412:36:ID tokens
412:43:EQ
413:6:LET
413:10:VAR
413:14:ID level
413:20:ASSIGN
413:23:INT 1
414:10:VAR
414:14:ID first_token
414:26:ASSIGN
414:29:ID read_token
414:40:LPAREN
414:41:RPAREN
415:10:VAR
415:14:ID tokens
415:21:ASSIGN
415:24:ID tokens
415:31:LBRACE
415:32:ID leftmost
415:41:EQ
415:43:NIL
415:46:COMMA
415:48:ID rightmost
415:58:EQ
415:60:NIL
415:63:RBRACE
416:6:IN
416:9:ID push_right
416:19:LPAREN
416:20:ID first_token
416:31:COMMA
416:33:ID tokens
416:39:RPAREN
416:40:SEMICOLON
417:9:IF
417:12:ID int_token_p
417:23:LPAREN
417:24:ID first_token
417:35:RPAREN
417:37:OR
417:39:ID str_token_p
417:50:LPAREN
417:51:ID first_token
417:62:RPAREN
418:12:OR
418:14:ID id_token_p
418:24:LPAREN
418:25:ID first_token
418:36:RPAREN
418:38:OR
418:40:ID bool_token_p
418:52:LPAREN
418:53:ID first_token
418:64:RPAREN
419:9:THEN
419:14:ID tokens
420:9:ELSE
420:14:IF
420:17:ID first_token
420:29:NEQ
420:32:ID LPAREN
421:14:THEN
421:19:LPAREN
421:20:ID print
421:25:LPAREN
421:26:STRING "Illegal first token for top level expression: '"
421:75:RPAREN
421:76:SEMICOLON
422:20:ID print
422:25:LPAREN
422:26:ID token2s
422:33:LPAREN
422:34:ID first_token
422:45:RPAREN
422:46:RPAREN
422:47:SEMICOLON
423:20:ID print
423:25:LPAREN
423:26:STRING "'.\n"
423:32:RPAREN
423:33:SEMICOLON
424:20:NIL
424:23:RPAREN
425:14:ELSE
425:19:LPAREN
426:20:WHILE
426:26:ID level
426:32:GT
426:34:INT 0
427:20:DO
427:23:LET
427:27:VAR
427:31:ID curr_token
427:42:ASSIGN
427:45:ID read_token
427:56:LPAREN
427:57:RPAREN
428:23:IN
428:26:LPAREN
428:27:IF
428:30:ID curr_token
428:41:EQ
428:43:NIL
429:27:THEN
429:32:LPAREN
429:33:ID print
429:38:LPAREN
429:39:STRING "Expression was not complete before input ended: "
429:89:RPAREN
429:90:SEMICOLON
430:33:ID print
430:38:LPAREN
430:39:STRING "Missing "
430:49:RPAREN
430:50:SEMICOLON
431:33:ID print
431:38:LPAREN
431:39:ID i2s
431:42:LPAREN
431:43:ID level
431:48:RPAREN
431:49:RPAREN
431:50:SEMICOLON
432:33:ID print
432:38:LPAREN
432:39:STRING " right parentheses\n"
432:61:RPAREN
432:62:SEMICOLON
433:33:BREAK
433:38:RPAREN
433:39:SEMICOLON
434:27:ID push_right
434:37:LPAREN
434:38:ID curr_token
434:48:COMMA
434:50:ID tokens
434:56:RPAREN
434:57:SEMICOLON
435:27:IF
435:30:ID curr_token
435:41:EQ
435:43:ID LPAREN
436:27:THEN
436:32:ID level
436:38:ASSIGN
436:41:ID level
436:47:PLUS
436:49:INT 1
437:27:ELSE
437:32:IF
437:35:ID curr_token
437:46:EQ
437:48:ID RPAREN
438:32:THEN
438:37:ID level
438:43:ASSIGN
438:46:ID level
438:52:MINUS
438:54:INT 1
438:55:RPAREN
439:23:END
439:26:SEMICOLON
440:20:ID tokens
440:26:RPAREN
441:6:END
444:5:TYPE
444:10:ID sexp
444:15:EQ
444:17:LBRACE
444:18:ID int
444:21:COLON
444:23:ID Int
444:26:COMMA
444:28:ID bool
444:32:COLON
444:34:ID Int
444:37:COMMA
444:39:ID str
444:42:COLON
444:44:ID String
444:50:COMMA
444:52:ID sym
444:55:COLON
444:57:ID String
444:63:COMMA
444:65:ID fun
444:68:COLON
444:70:ID Function
444:78:COMMA
445:18:ID sexps
445:23:COLON
445:25:ID List
445:29:RBRACE
446:5:TYPE
446:10:ID sexps
446:16:EQ
446:18:LBRACE
446:19:ID car
446:22:COLON
446:24:ID sexp
446:28:COMMA
446:30:ID cdr
446:33:COLON
446:35:ID sexps
446:40:RBRACE
448:5:TYPE
448:10:ID List
448:15:EQ
448:17:LBRACE
448:18:ID v
448:19:COLON
448:21:ID sexps
448:26:RBRACE
449:5:TYPE
449:10:ID Function
449:19:EQ
449:21:LBRACE
449:22:ID typ
449:25:COLON
449:27:ID string
449:33:COMMA
449:35:ID name
449:39:COLON
449:41:ID string
449:47:COMMA
449:49:ID pars
449:53:COLON
449:55:ID parameters
449:65:COMMA
450:22:ID body
450:26:COLON
450:28:ID sexp
450:32:COMMA
450:34:ID env
450:37:COLON
450:39:ID env
450:42:RBRACE
451:5:TYPE
451:10:ID parameters
451:21:EQ
451:23:LBRACE
451:24:ID car
451:27:COLON
451:29:ID string
451:35:COMMA
451:37:ID cdr
451:40:COLON
451:42:ID parameters
451:52:RBRACE
453:5:TYPE
453:10:ID env
453:14:EQ
453:16:LBRACE
453:17:ID car
453:20:COLON
453:22:ID env_entry
453:31:COMMA
453:33:ID cdr
453:36:COLON
453:38:ID env
453:41:RBRACE
454:5:TYPE
454:10:ID env_entry
454:20:EQ
454:22:LBRACE
454:23:ID key
454:26:COLON
454:28:ID string
454:34:COMMA
454:36:ID value
454:41:COLON
454:43:ID sexp
454:47:RBRACE
456:5:FUNCTION
456:14:ID mk_int
456:20:LPAREN
456:21:ID v
456:22:COLON
456:24:ID int
456:27:RPAREN
456:28:COLON
456:30:ID sexp
456:35:EQ
457:7:ID sexp
457:12:LBRACE
457:13:ID int
457:17:EQ
457:19:ID Int
457:23:LBRACE
457:24:ID v
457:26:EQ
457:28:ID v
457:29:RBRACE
457:30:COMMA
457:32:ID bool
457:37:EQ
457:39:NIL
457:42:COMMA
457:44:ID str
457:48:EQ
457:50:NIL
457:53:COMMA
457:55:ID sym
457:59:EQ
457:61:NIL
457:64:COMMA
457:66:ID fun
457:70:EQ
457:72:NIL
457:75:COMMA
457:77:ID sexps
457:83:EQ
457:85:NIL
457:88:RBRACE
459:5:FUNCTION
459:14:ID mk_bool
459:21:LPAREN
459:22:ID v
459:23:COLON
459:25:ID int
459:28:RPAREN
459:29:COLON
459:31:ID sexp
459:36:EQ
460:7:ID sexp
460:12:LBRACE
460:13:ID int
460:17:EQ
460:19:NIL
460:22:COMMA
460:24:ID bool
460:29:EQ
460:31:ID Int
460:35:LBRACE
460:36:ID v
460:38:EQ
460:40:ID v
460:41:RBRACE
460:42:COMMA
460:44:ID str
460:48:EQ
460:50:NIL
460:53:COMMA
460:55:ID sym
460:59:EQ
460:61:NIL
460:64:COMMA
460:66:ID fun
460:70:EQ
460:72:NIL
460:75:COMMA
460:77:ID sexps
460:83:EQ
460:85:NIL
460:88:RBRACE
462:5:FUNCTION
462:14:ID mk_str
462:20:LPAREN
462:21:ID v
462:22:COLON
462:24:ID string
462:30:RPAREN
462:31:COLON
462:33:ID sexp
462:38:EQ
463:7:ID sexp
463:12:LBRACE
463:13:ID int
463:17:EQ
463:19:NIL
463:22:COMMA
463:24:ID bool
463:29:EQ
463:31:NIL
463:34:COMMA
463:36:ID str
463:40:EQ
463:42:ID String
463:49:LBRACE
463:50:ID v
463:52:EQ
463:54:ID v
463:55:RBRACE
463:56:COMMA
463:58:ID sym
463:62:EQ
463:64:NIL
463:67:COMMA
463:69:ID fun
463:73:EQ
463:75:NIL
463:78:COMMA
463:80:ID sexps
463:86:EQ
463:88:NIL
463:91:RBRACE
465:5:FUNCTION
465:14:ID mk_sym
465:20:LPAREN
465:21:ID v
465:22:COLON
465:24:ID string
465:30:RPAREN
465:31:COLON
465:33:ID sexp
465:38:EQ
466:7:ID sexp
466:12:LBRACE
466:13:ID int
466:17:EQ
466:19:NIL
466:22:COMMA
466:24:ID bool
466:29:EQ
466:31:NIL
466:34:COMMA
466:36:ID str
466:40:EQ
466:42:NIL
466:45:COMMA
466:47:ID sym
466:51:EQ
466:53:ID String
466:60:LBRACE
466:61:ID v
466:63:EQ
466:65:ID v
466:66:RBRACE
466:67:COMMA
466:69:ID fun
466:73:EQ
466:75:NIL
466:78:COMMA
466:80:ID sexps
466:86:EQ
466:88:NIL
466:91:RBRACE
468:5:FUNCTION
468:14:ID mk_sexps
468:22:LPAREN
468:23:ID v
468:24:COLON
468:26:ID sexps
468:31:RPAREN
468:32:COLON
468:34:ID sexp
468:39:EQ
469:7:ID sexp
469:12:LBRACE
469:13:ID int
469:17:EQ
469:19:NIL
469:22:COMMA
469:24:ID bool
469:29:EQ
469:31:NIL
469:34:COMMA
469:36:ID str
469:40:EQ
469:42:NIL
469:45:COMMA
469:47:ID sym
469:51:EQ
469:53:NIL
469:56:COMMA
469:58:ID fun
469:62:EQ
469:64:NIL
469:67:COMMA
469:69:ID sexps
469:75:EQ
469:77:ID List
469:82:LBRACE
469:83:ID v
469:85:EQ
469:87:ID v
469:88:RBRACE
469:89:RBRACE
471:5:FUNCTION
471:14:ID mk_fun_from_fun
471:29:LPAREN
471:30:ID f
471:31:COLON
471:33:ID Function
471:41:RPAREN
471:42:COLON
471:44:ID sexp
471:49:EQ
472:7:ID sexp
472:12:LBRACE
472:13:ID int
472:17:EQ
472:19:NIL
472:22:COMMA
472:24:ID bool
472:29:EQ
472:31:NIL
472:34:COMMA
472:36:ID str
472:40:EQ
472:42:NIL
472:45:COMMA
472:47:ID sym
472:51:EQ
472:53:NIL
472:56:COMMA
472:58:ID fun
472:62:EQ
472:64:ID f
472:65:COMMA
472:67:ID sexps
472:73:EQ
472:75:NIL
472:78:RBRACE
474:5:FUNCTION
474:14:ID mk_fun
474:20:LPAREN
474:21:ID pars
474:25:COLON
474:27:ID parameters
474:37:COMMA
474:39:ID body
474:43:COLON
474:45:ID sexp
474:49:COMMA
474:51:ID env
474:54:COLON
474:56:ID env
474:59:RPAREN
474:60:COLON
474:62:ID sexp
474:67:EQ
475:7:LET
475:11:VAR
475:15:ID fun
475:19:ASSIGN
475:22:ID Function
475:31:LBRACE
475:32:ID typ
475:36:EQ
475:38:STRING "user"
475:44:COMMA
475:46:ID name
475:51:EQ
475:53:STRING ""
475:55:COMMA
475:57:ID pars
475:62:EQ
475:64:ID pars
475:68:COMMA
475:70:ID body
475:75:EQ
475:77:ID body
475:81:COMMA
476:32:ID env
476:36:EQ
476:38:ID env
476:41:RBRACE
477:7:IN
477:10:ID mk_fun_from_fun
477:25:LPAREN
477:26:ID fun
477:29:RPAREN
478:7:END
480:5:FUNCTION
480:14:ID mk_mt_sexp
480:24:LPAREN
480:25:RPAREN
480:26:COLON
480:28:ID sexp
480:33:EQ
481:7:ID sexp
481:12:LBRACE
481:13:ID int
481:17:EQ
481:19:NIL
481:22:COMMA
481:24:ID bool
481:29:EQ
481:31:NIL
481:34:COMMA
481:36:ID str
481:40:EQ
481:42:NIL
481:45:COMMA
481:47:ID sym
481:51:EQ
481:53:NIL
481:56:COMMA
481:58:ID fun
481:62:EQ
481:64:NIL
481:67:COMMA
481:69:ID sexps
481:75:EQ
481:77:NIL
481:80:RBRACE
483:5:FUNCTION
483:14:ID int_p
483:19:LPAREN
483:20:ID s
483:21:COLON
483:23:ID sexp
483:27:RPAREN
483:28:COLON
483:30:ID int
483:34:EQ
484:7:ID s
484:8:DOT
484:9:ID int
484:13:NEQ
484:16:NIL
486:5:FUNCTION
486:14:ID bool_p
486:20:LPAREN
486:21:ID s
486:22:COLON
486:24:ID sexp
486:28:RPAREN
486:29:COLON
486:31:ID int
486:35:EQ
487:7:ID s
487:8:DOT
487:9:ID bool
487:14:NEQ
487:17:NIL
489:5:FUNCTION
489:14:ID str_p
489:19:LPAREN
489:20:ID s
489:21:COLON
489:23:ID sexp
489:27:RPAREN
489:28:COLON
489:30:ID int
489:34:EQ
490:7:ID s
490:8:DOT
490:9:ID str
490:13:NEQ
490:16:NIL
492:5:FUNCTION
492:14:ID sym_p
492:19:LPAREN
492:20:ID s
492:21:COLON
492:23:ID sexp
492:27:RPAREN
492:28:COLON
492:30:ID int
492:34:EQ
493:7:ID s
493:8:DOT
493:9:ID sym
493:13:NEQ
493:16:NIL
495:5:FUNCTION
495:14:ID fun_p
495:19:LPAREN
495:20:ID s
495:21:COLON
495:23:ID sexp
495:27:RPAREN
495:28:COLON
495:30:ID int
495:34:EQ
496:7:ID s
496:8:DOT
496:9:ID fun
496:13:NEQ
496:16:NIL
498:5:FUNCTION
498:14:ID sexps_p
498:21:LPAREN
498:22:ID s
498:23:COLON
498:25:ID sexp
498:29:RPAREN
498:30:COLON
498:32:ID int
498:36:EQ
499:7:ID s
499:8:DOT
499:9:ID sexps
499:15:NEQ
499:18:NIL
501:5:FUNCTION
501:14:ID get_int
501:21:LPAREN
501:22:ID s
501:23:COLON
501:25:ID sexp
501:29:RPAREN
501:30:COLON
501:32:ID int
501:36:EQ
502:7:ID s
502:8:DOT
502:9:ID int
502:12:DOT
502:13:ID v
504:5:FUNCTION
504:14:ID get_bool
504:22:LPAREN
504:23:ID s
504:24:COLON
504:26:ID sexp
504:30:RPAREN
504:31:COLON
504:33:ID int
504:37:EQ
505:7:ID s
505:8:DOT
505:9:ID bool
505:13:DOT
505:14:ID v
507:5:FUNCTION
507:14:ID get_str
507:21:LPAREN
507:22:ID s
507:23:COLON
507:25:ID sexp
507:29:RPAREN
507:30:COLON
507:32:ID string
507:39:EQ
508:7:ID s
508:8:DOT
508:9:ID str
508:12:DOT
508:13:ID v
510:5:FUNCTION
510:14:ID get_sym
510:21:LPAREN
510:22:ID s
510:23:COLON
510:25:ID sexp
510:29:RPAREN
510:30:COLON
510:32:ID string
510:39:EQ
511:7:ID s
511:8:DOT
511:9:ID sym
511:12:DOT
511:13:ID v
513:5:FUNCTION
513:14:ID get_fun
513:21:LPAREN
513:22:ID s
513:23:COLON
513:25:ID sexp
513:29:RPAREN
513:30:COLON
513:32:ID Function
513:41:EQ
514:7:ID s
514:8:DOT
514:9:ID fun
516:5:FUNCTION
516:14:ID get_sexps
516:23:LPAREN
516:24:ID s
516:25:COLON
516:27:ID sexp
516:31:RPAREN
516:32:COLON
516:34:ID sexps
516:40:EQ
517:7:ID s
517:8:DOT
517:9:ID sexps
517:14:DOT
517:15:ID v
520:5:FUNCTION
520:14:ID Function2s
520:24:LPAREN
520:25:ID f
520:26:COLON
520:28:ID Function
520:36:RPAREN
520:37:COLON
520:39:ID string
520:46:EQ
521:7:IF
521:10:ID f
521:11:DOT
521:12:ID name
521:17:EQ
521:19:STRING ""
522:7:THEN
522:12:STRING "<function>"
523:7:ELSE
523:12:ID concat
523:18:LPAREN
523:19:STRING "<function "
523:31:COMMA
524:12:ID concat
524:18:LPAREN
524:19:ID f
524:20:DOT
524:21:ID name
524:25:COMMA
525:19:STRING ">"
525:22:RPAREN
525:23:RPAREN
527:5:FUNCTION
527:14:ID sexps2s
527:21:LPAREN
527:22:ID v
527:23:COLON
527:25:ID sexps
527:30:RPAREN
527:31:COLON
527:33:ID string
527:40:EQ
528:7:LET
528:11:FUNCTION
528:20:ID aux
528:24:LPAREN
528:25:ID vs
528:27:COLON
528:29:ID sexps
528:34:RPAREN
528:35:COLON
528:37:ID string
528:44:EQ
529:11:IF
529:14:ID vs
529:17:EQ
529:19:NIL
530:11:THEN
530:16:STRING ""
531:11:ELSE
531:16:ID concat
531:22:LPAREN
531:23:STRING " "
531:26:COMMA
532:16:ID concat
532:22:LPAREN
532:23:ID sexp2s
532:29:LPAREN
532:30:ID vs
532:32:DOT
532:33:ID car
532:36:RPAREN
532:37:COMMA
533:23:ID aux
533:26:LPAREN
533:27:ID vs
533:29:DOT
533:30:ID cdr
533:33:RPAREN
533:34:RPAREN
533:35:RPAREN
534:7:IN
534:10:IF
534:13:ID v
534:15:EQ
534:17:NIL
535:10:THEN
535:15:STRING "()"
536:10:ELSE
536:15:ID concat
536:21:LPAREN
536:22:STRING "("
536:25:COMMA
537:15:ID concat
537:21:LPAREN
537:22:ID sexp2s
537:28:LPAREN
537:29:ID v
537:30:DOT
537:31:ID car
537:34:RPAREN
537:35:COMMA
538:15:ID concat
538:21:LPAREN
538:22:ID aux
538:25:LPAREN
538:26:ID v
538:27:DOT
538:28:ID cdr
538:31:RPAREN
538:32:COMMA
539:22:STRING ")"
539:25:RPAREN
539:26:RPAREN
539:27:RPAREN
540:7:END
542:5:FUNCTION
542:14:ID sexp2s
542:20:LPAREN
542:21:ID s
542:22:COLON
542:24:ID sexp
542:28:RPAREN
542:29:COLON
542:31:ID string
542:38:EQ
543:7:IF
543:10:ID int_p
543:15:LPAREN
543:16:ID s
543:17:RPAREN
544:7:THEN
544:12:ID i2s
544:15:LPAREN
544:16:ID get_int
544:23:LPAREN
544:24:ID s
544:25:RPAREN
544:26:RPAREN
545:7:ELSE
545:12:IF
545:15:ID bool_p
545:21:LPAREN
545:22:ID s
545:23:RPAREN
546:7:THEN
546:12:ID bool2s
546:18:LPAREN
546:19:ID get_bool
546:27:LPAREN
546:28:ID s
546:29:RPAREN
546:30:RPAREN
547:7:ELSE
547:12:IF
547:15:ID str_p
547:20:LPAREN
547:21:ID s
547:22:RPAREN
548:7:THEN
548:12:ID wrap_string
548:23:LPAREN
548:24:ID get_str
548:31:LPAREN
548:32:ID s
548:33:RPAREN
548:34:RPAREN
549:7:ELSE
549:12:IF
549:15:ID sym_p
549:20:LPAREN
549:21:ID s
549:22:RPAREN
550:7:THEN
550:12:ID get_sym
550:19:LPAREN
550:20:ID s
550:21:RPAREN
551:7:ELSE
551:12:IF
551:15:ID fun_p
551:20:LPAREN
551:21:ID s
551:22:RPAREN
552:7:THEN
552:12:ID Function2s
552:22:LPAREN
552:23:ID get_fun
552:30:LPAREN
552:31:ID s
552:32:RPAREN
552:33:RPAREN
553:7:ELSE
553:12:IF
553:15:ID sexps_p
553:22:LPAREN
553:23:ID s
553:24:RPAREN
554:7:THEN
554:12:ID sexps2s
554:19:LPAREN
554:20:ID get_sexps
554:29:LPAREN
554:30:ID s
554:31:RPAREN
554:32:RPAREN
555:7:ELSE
555:12:LPAREN
555:13:ID print
555:18:LPAREN
555:19:STRING "Unknown sexp in sexp2s.\n"
555:46:RPAREN
555:47:SEMICOLON
556:13:STRING ""
556:15:RPAREN
558:5:FUNCTION
558:14:ID parse_tokens
558:26:LPAREN
558:27:ID left_elem
558:36:COLON
558:38:ID deque_elem
558:48:COMMA
558:50:ID right_elem
558:60:COLON
558:62:ID deque_elem
558:72:RPAREN
558:73:COLON
558:75:ID sexp
558:80:EQ
559:7:LET
559:11:VAR
559:15:ID left_token
559:26:ASSIGN
559:29:ID left_elem
559:38:DOT
559:39:ID val
560:11:VAR
560:15:ID right_token
560:27:ASSIGN
560:30:ID right_elem
560:40:DOT
560:41:ID val
568:7:IN
568:10:IF
568:13:ID left_elem
568:23:EQ
568:25:ID right_elem
569:10:THEN
569:15:IF
569:18:ID int_token_p
569:29:LPAREN
569:30:ID left_token
569:40:RPAREN
570:15:THEN
570:20:ID mk_int
570:26:LPAREN
570:27:ID get_int_token
570:40:LPAREN
570:41:ID left_token
570:51:RPAREN
570:52:RPAREN
571:15:ELSE
571:20:IF
571:23:ID bool_token_p
571:35:LPAREN
571:36:ID left_token
571:46:RPAREN
572:15:THEN
572:20:ID mk_bool
572:27:LPAREN
572:28:ID get_bool_token
572:42:LPAREN
572:43:ID left_token
572:53:RPAREN
572:54:RPAREN
573:15:ELSE
573:20:IF
573:23:ID str_token_p
573:34:LPAREN
573:35:ID left_token
573:45:RPAREN
574:15:THEN
574:20:ID mk_str
574:26:LPAREN
574:27:ID get_str_token
574:40:LPAREN
574:41:ID left_token
574:51:RPAREN
574:52:RPAREN
575:15:ELSE
575:20:IF
575:23:ID id_token_p
575:33:LPAREN
575:34:ID left_token
575:44:RPAREN
576:15:THEN
576:20:ID mk_sym
576:26:LPAREN
576:27:ID get_id_token
576:39:LPAREN
576:40:ID left_token
576:50:RPAREN
576:51:RPAREN
577:15:ELSE
577:20:LPAREN
577:21:ID print
577:26:LPAREN
577:27:STRING "Syntax error: Could not parse sexp from single token: '"
577:84:RPAREN
577:85:SEMICOLON
578:21:ID print
578:26:LPAREN
578:27:ID token2s
578:34:LPAREN
578:35:ID left_token
578:45:RPAREN
578:46:RPAREN
578:47:SEMICOLON
579:21:ID print
579:26:LPAREN
579:27:STRING "'\n"
579:32:RPAREN
579:33:SEMICOLON
580:21:NIL
580:24:RPAREN
581:10:ELSE
581:15:IF
581:18:ID left_token
581:29:EQ
581:31:ID LPAREN
581:38:AND
581:40:ID right_token
581:52:EQ
581:54:ID RPAREN
582:10:THEN
582:15:LET
582:19:VAR
582:23:ID first_elem_inside
582:41:ASSIGN
582:44:ID left_elem
582:53:DOT
582:54:ID right
583:19:VAR
583:23:ID last_elem_inside
583:40:ASSIGN
583:43:ID right_elem
583:53:DOT
583:54:ID left
584:19:VAR
584:23:ID sexps
584:28:COLON
584:30:ID sexps
584:36:ASSIGN
584:39:NIL
585:19:VAR
585:23:ID end_of_next_sexp
585:40:ASSIGN
585:43:ID last_elem_inside
587:15:IN
587:18:WHILE
587:24:ID end_of_next_sexp
587:41:NEQ
587:44:ID left_elem
588:18:DO
588:21:LET
588:25:VAR
588:29:ID beginning_of_next_sexp
588:52:ASSIGN
588:55:ID find_sexp_beginning
588:74:LPAREN
588:75:ID first_elem_inside
588:92:COMMA
589:75:ID end_of_next_sexp
589:91:RPAREN
590:25:VAR
590:29:ID nexp_sexp
590:39:ASSIGN
590:42:ID parse_tokens
590:54:LPAREN
590:55:ID beginning_of_next_sexp
590:77:COMMA
591:55:ID end_of_next_sexp
591:71:RPAREN
592:21:IN
592:24:LPAREN
592:25:ID sexps
592:31:ASSIGN
592:34:ID sexps
592:40:LBRACE
592:41:ID car
592:45:EQ
592:47:ID nexp_sexp
592:56:COMMA
592:58:ID cdr
592:62:EQ
592:64:ID sexps
592:69:RBRACE
592:70:SEMICOLON
593:25:ID end_of_next_sexp
593:42:ASSIGN
593:45:ID beginning_of_next_sexp
593:67:DOT
593:68:ID left
593:72:RPAREN
594:21:END
594:24:SEMICOLON
595:18:ID mk_sexps
595:26:LPAREN
595:27:ID sexps
595:32:RPAREN
596:15:END
597:10:ELSE
597:15:LPAREN
597:16:ID print
597:21:LPAREN
597:22:STRING "Syntax error: Long sexp was not parameterised properly\n"
597:80:RPAREN
597:81:SEMICOLON
598:16:NIL
598:19:RPAREN
600:7:END
601:5:FUNCTION
601:14:ID find_sexp_beginning
601:33:LPAREN
601:34:ID leftmost_elem
601:47:COLON
601:49:ID deque_elem
601:59:COMMA
602:34:ID end_elem
602:42:COLON
602:44:ID deque_elem
602:54:RPAREN
602:55:COLON
602:57:ID deque_elem
602:68:EQ
603:7:LET
603:11:VAR
603:15:ID end_token
603:25:ASSIGN
603:28:ID end_elem
603:36:DOT
603:37:ID val
604:7:IN
604:10:IF
604:13:ID int_token_p
604:24:LPAREN
604:25:ID end_token
604:34:RPAREN
604:36:OR
604:38:ID str_token_p
604:49:LPAREN
604:50:ID end_token
604:59:RPAREN
604:61:OR
604:63:ID id_token_p
604:73:LPAREN
604:74:ID end_token
604:83:RPAREN
605:13:OR
605:15:ID bool_token_p
605:27:LPAREN
605:28:ID end_token
605:37:RPAREN
606:10:THEN
606:15:ID end_elem
607:10:ELSE
607:15:IF
607:18:ID end_token
607:28:EQ
607:30:ID RPAREN
608:10:THEN
608:15:LET
608:19:VAR
608:23:ID level
608:29:ASSIGN
608:32:INT 1
609:19:VAR
609:23:ID curr_elem
609:33:ASSIGN
609:36:ID end_elem
609:44:DOT
609:45:ID left
610:15:IN
610:18:WHILE
610:24:ID level
610:30:GT
610:32:INT 0
611:18:DO
611:21:LPAREN
611:22:IF
611:25:ID curr_elem
611:35:EQ
611:37:NIL
611:41:OR
611:43:ID leftmost_elem
611:56:DOT
611:57:ID left
611:62:EQ
611:64:ID curr_elem
612:22:THEN
612:27:LPAREN
612:28:ID print
612:33:LPAREN
612:34:STRING "Syntax error: Could not find beginning of long sexp\n"
612:89:RPAREN
612:90:SEMICOLON
613:28:BREAK
613:33:RPAREN
613:34:SEMICOLON
614:22:IF
614:25:ID curr_elem
614:34:DOT
614:35:ID val
614:39:EQ
614:41:ID LPAREN
615:22:THEN
615:27:ID level
615:33:ASSIGN
615:36:ID level
615:42:MINUS
615:44:INT 1
616:22:ELSE
616:27:IF
616:30:ID curr_elem
616:39:DOT
616:40:ID val
616:44:EQ
616:46:ID RPAREN
617:22:THEN
617:27:ID level
617:33:ASSIGN
617:36:ID level
617:42:PLUS
617:44:INT 1
617:45:SEMICOLON
618:22:ID curr_elem
618:32:ASSIGN
618:35:ID curr_elem
618:44:DOT
618:45:ID left
618:49:RPAREN
618:50:SEMICOLON
619:18:ID curr_elem
619:27:DOT
619:28:ID right
620:15:END
621:10:ELSE
621:15:LPAREN
621:16:ID print
621:21:LPAREN
621:22:STRING "Syntax error: Cannot find beginning of sexp ending in '"
621:79:RPAREN
621:80:SEMICOLON
622:16:ID print
622:21:LPAREN
622:22:ID token2s
622:29:LPAREN
622:30:ID end_token
622:39:RPAREN
622:40:RPAREN
622:41:SEMICOLON
623:16:ID print
623:21:LPAREN
623:22:STRING "'\n"
623:27:RPAREN
623:28:SEMICOLON
624:16:NIL
624:19:RPAREN
625:7:END
628:5:FUNCTION
628:14:ID env2s_short
628:25:LPAREN
628:26:ID env
628:29:COLON
628:31:ID env
628:34:RPAREN
628:35:COLON
628:37:ID string
628:44:EQ
629:7:IF
629:10:ID env
629:14:EQ
629:16:NIL
630:7:THEN
630:12:STRING ""
631:7:ELSE
631:12:IF
631:15:ID env
631:18:DOT
631:19:ID cdr
631:23:EQ
631:25:NIL
632:7:THEN
632:12:ID env
632:15:DOT
632:16:ID car
632:19:DOT
632:20:ID key
633:7:ELSE
633:12:ID concat
633:18:LPAREN
633:19:ID env
633:22:DOT
633:23:ID car
633:26:DOT
633:27:ID key
633:30:COMMA
634:12:ID concat
634:18:LPAREN
634:19:STRING "  "
634:23:COMMA
635:19:ID env2s_short
635:30:LPAREN
635:31:ID env
635:34:DOT
635:35:ID cdr
635:38:RPAREN
635:39:RPAREN
635:40:RPAREN
637:5:FUNCTION
637:14:ID copy_value
637:24:LPAREN
637:25:ID src
637:28:COLON
637:30:ID sexp
637:34:COMMA
637:36:ID dst
637:39:COLON
637:41:ID sexp
637:45:RPAREN
637:47:EQ
638:7:IF
638:10:ID int_p
638:15:LPAREN
638:16:ID dst
638:19:RPAREN
638:21:OR
638:23:ID bool_p
638:29:LPAREN
638:30:ID dst
638:33:RPAREN
638:35:OR
638:37:ID str_p
638:42:LPAREN
638:43:ID dst
638:46:RPAREN
638:48:OR
638:50:ID sym_p
638:55:LPAREN
638:56:ID dst
638:59:RPAREN
638:61:OR
638:63:ID fun_p
638:68:LPAREN
638:69:ID dst
638:72:RPAREN
638:74:OR
638:76:ID sexps_p
638:83:LPAREN
638:84:ID dst
638:87:RPAREN
639:7:THEN
639:12:LPAREN
639:13:ID print
639:18:LPAREN
639:19:STRING "Cannot copy value into dst, as dst is not an empty value. Src: '"
639:85:RPAREN
639:86:SEMICOLON
640:13:ID print
640:18:LPAREN
640:19:ID sexp2s
640:25:LPAREN
640:26:ID src
640:29:RPAREN
640:30:RPAREN
640:31:SEMICOLON
641:13:ID print
641:18:LPAREN
641:19:STRING "', dst: '"
641:30:RPAREN
641:31:SEMICOLON
642:13:ID print
642:18:LPAREN
642:19:ID sexp2s
642:25:LPAREN
642:26:ID dst
642:29:RPAREN
642:30:RPAREN
642:31:SEMICOLON
643:13:ID print
643:18:LPAREN
643:19:STRING "'\n"
643:24:RPAREN
643:25:RPAREN
644:7:ELSE
644:12:IF
644:15:ID int_p
644:20:LPAREN
644:21:ID src
644:24:RPAREN
645:7:THEN
645:12:ID dst
645:15:DOT
645:16:ID int
645:20:ASSIGN
645:23:ID src
645:26:DOT
645:27:ID int
646:7:ELSE
646:12:IF
646:15:ID bool_p
646:21:LPAREN
646:22:ID src
646:25:RPAREN
647:7:THEN
647:12:ID dst
647:15:DOT
647:16:ID bool
647:21:ASSIGN
647:24:ID src
647:27:DOT
647:28:ID bool
648:7:ELSE
648:12:IF
648:15:ID str_p
648:20:LPAREN
648:21:ID src
648:24:RPAREN
649:7:THEN
649:12:ID dst
649:15:DOT
649:16:ID str
649:20:ASSIGN
649:23:ID src
649:26:DOT
649:27:ID str
650:7:ELSE
650:12:IF
650:15:ID fun_p
650:20:LPAREN
650:21:ID src
650:24:RPAREN
651:7:THEN
651:12:ID dst
651:15:DOT
651:16:ID fun
651:20:ASSIGN
651:23:ID src
651:26:DOT
651:27:ID fun
652:7:ELSE
652:12:IF
652:15:ID sym_p
652:20:LPAREN
652:21:ID src
652:24:RPAREN
653:7:THEN
653:12:ID dst
653:15:DOT
653:16:ID sym
653:20:ASSIGN
653:23:ID src
653:26:DOT
653:27:ID sym
654:7:ELSE
654:12:IF
654:15:ID sexps_p
654:22:LPAREN
654:23:ID src
654:26:RPAREN
655:7:THEN
655:12:ID dst
655:15:DOT
655:16:ID sexps
655:22:ASSIGN
655:25:ID src
655:28:DOT
655:29:ID sexps
656:7:ELSE
656:12:LPAREN
656:13:ID print
656:18:LPAREN
656:19:STRING "Unknown src for copy_value: '"
656:50:RPAREN
656:51:SEMICOLON
657:13:ID print
657:18:LPAREN
657:19:ID sexp2s
657:25:LPAREN
657:26:ID src
657:29:RPAREN
657:30:RPAREN
657:31:SEMICOLON
658:13:ID print
658:18:LPAREN
658:19:STRING "'\n"
658:24:RPAREN
658:25:RPAREN
661:5:FUNCTION
661:14:ID mk_internal_fun
661:29:LPAREN
661:30:ID name
661:34:COLON
661:36:ID string
661:42:RPAREN
661:43:COLON
661:45:ID env_entry
661:55:EQ
662:7:ID env_entry
662:17:LBRACE
662:18:ID key
662:22:EQ
662:24:ID name
662:28:COMMA
663:18:ID value
663:24:EQ
663:26:ID mk_fun_from_fun
663:41:LPAREN
663:42:ID Function
663:51:LBRACE
663:52:ID typ
663:56:EQ
663:58:STRING "internal"
663:68:COMMA
664:52:ID name
664:57:EQ
664:59:ID name
664:63:COMMA
665:52:ID pars
665:57:EQ
665:59:NIL
665:62:COMMA
666:52:ID body
666:57:EQ
666:59:NIL
666:62:COMMA
667:52:ID env
667:56:EQ
667:58:NIL
667:61:RBRACE
667:62:RPAREN
667:63:RBRACE
671:5:VAR
671:9:ID initial_env
671:21:ASSIGN
671:24:ID env
671:28:LBRACE
671:29:ID car
671:33:EQ
671:35:ID mk_internal_fun
671:50:LPAREN
671:51:STRING "+"
671:54:RPAREN
671:55:COMMA
672:29:ID cdr
672:33:EQ
672:35:ID env
672:39:LBRACE
672:40:ID car
672:44:EQ
672:46:ID mk_internal_fun
672:61:LPAREN
672:62:STRING "-"
672:65:RPAREN
672:66:COMMA
673:29:ID cdr
673:33:EQ
673:35:ID env
673:39:LBRACE
673:40:ID car
673:44:EQ
673:46:ID mk_internal_fun
673:61:LPAREN
673:62:STRING "*"
673:65:RPAREN
673:66:COMMA
674:29:ID cdr
674:33:EQ
674:35:ID env
674:39:LBRACE
674:40:ID car
674:44:EQ
674:46:ID mk_internal_fun
674:61:LPAREN
674:62:STRING "/"
674:65:RPAREN
674:66:COMMA
675:29:ID cdr
675:33:EQ
675:35:ID env
675:39:LBRACE
675:40:ID car
675:44:EQ
675:46:ID mk_internal_fun
675:61:LPAREN
675:62:STRING "^"
675:65:RPAREN
675:66:COMMA
676:29:ID cdr
676:33:EQ
676:35:ID env
676:39:LBRACE
676:40:ID car
676:44:EQ
676:46:ID mk_internal_fun
676:61:LPAREN
676:62:STRING "<"
676:65:RPAREN
676:66:COMMA
677:29:ID cdr
677:33:EQ
677:35:ID env
677:39:LBRACE
677:40:ID car
677:44:EQ
677:46:ID mk_internal_fun
677:61:LPAREN
677:62:STRING "<="
677:66:RPAREN
677:67:COMMA
678:29:ID cdr
678:33:EQ
678:35:ID env
678:39:LBRACE
678:40:ID car
678:44:EQ
678:46:ID mk_internal_fun
678:61:LPAREN
678:62:STRING "="
678:65:RPAREN
678:66:COMMA
679:29:ID cdr
679:33:EQ
679:35:ID env
679:39:LBRACE
679:40:ID car
679:44:EQ
679:46:ID mk_internal_fun
679:61:LPAREN
679:62:STRING "!="
679:66:RPAREN
679:67:COMMA
680:29:ID cdr
680:33:EQ
680:35:ID env
680:39:LBRACE
680:40:ID car
680:44:EQ
680:46:ID mk_internal_fun
680:61:LPAREN
680:62:STRING ">="
680:66:RPAREN
680:67:COMMA
681:29:ID cdr
681:33:EQ
681:35:ID env
681:39:LBRACE
681:40:ID car
681:44:EQ
681:46:ID mk_internal_fun
681:61:LPAREN
681:62:STRING ">"
681:65:RPAREN
681:66:COMMA
682:29:ID cdr
682:33:EQ
682:35:ID env
682:39:LBRACE
682:40:ID car
682:44:EQ
682:46:ID mk_internal_fun
682:61:LPAREN
682:62:STRING "or"
682:66:RPAREN
682:67:COMMA
683:29:ID cdr
683:33:EQ
683:35:ID env
683:39:LBRACE
683:40:ID car
683:44:EQ
683:46:ID mk_internal_fun
683:61:LPAREN
683:62:STRING "and"
683:67:RPAREN
683:68:COMMA
684:29:ID cdr
684:33:EQ
684:35:ID env
684:39:LBRACE
684:40:ID car
684:44:EQ
684:46:ID mk_internal_fun
684:61:LPAREN
684:62:STRING "notb"
684:68:RPAREN
684:69:COMMA
685:29:ID cdr
685:33:EQ
685:35:ID env
685:39:LBRACE
685:40:ID car
685:44:EQ
685:46:ID mk_internal_fun
685:61:LPAREN
685:62:STRING "orb"
685:67:RPAREN
685:68:COMMA
686:29:ID cdr
686:33:EQ
686:35:ID env
686:39:LBRACE
686:40:ID car
686:44:EQ
686:46:ID mk_internal_fun
686:61:LPAREN
686:62:STRING "andb"
686:68:RPAREN
686:69:COMMA
687:29:ID cdr
687:33:EQ
687:35:ID env
687:39:LBRACE
687:40:ID car
687:44:EQ
687:46:ID mk_internal_fun
687:61:LPAREN
687:62:STRING "ifb"
687:67:RPAREN
687:68:COMMA
688:29:ID cdr
688:33:EQ
688:35:ID env
688:39:LBRACE
688:40:ID car
688:44:EQ
688:46:ID mk_internal_fun
688:61:LPAREN
688:62:STRING "min"
688:67:RPAREN
688:68:COMMA
689:29:ID cdr
689:33:EQ
689:35:ID env
689:39:LBRACE
689:40:ID car
689:44:EQ
689:46:ID mk_internal_fun
689:61:LPAREN
689:62:STRING "max"
689:67:RPAREN
689:68:COMMA
690:29:ID cdr
690:33:EQ
690:35:ID env
690:39:LBRACE
690:40:ID car
690:44:EQ
690:46:ID mk_internal_fun
690:61:LPAREN
690:62:STRING "list"
690:68:RPAREN
690:69:COMMA
691:29:ID cdr
691:33:EQ
691:35:ID env
691:39:LBRACE
691:40:ID car
691:44:EQ
691:46:ID mk_internal_fun
691:61:LPAREN
691:62:STRING "cons"
691:68:RPAREN
691:69:COMMA
692:29:ID cdr
692:33:EQ
692:35:ID env
692:39:LBRACE
692:40:ID car
692:44:EQ
692:46:ID mk_internal_fun
692:61:LPAREN
692:62:STRING "car"
692:67:RPAREN
692:68:COMMA
693:29:ID cdr
693:33:EQ
693:35:ID env
693:39:LBRACE
693:40:ID car
693:44:EQ
693:46:ID mk_internal_fun
693:61:LPAREN
693:62:STRING "cdr"
693:67:RPAREN
693:68:COMMA
694:29:ID cdr
694:33:EQ
694:35:ID env
694:39:LBRACE
694:40:ID car
694:44:EQ
694:46:ID mk_internal_fun
694:61:LPAREN
694:62:STRING "progn"
694:69:RPAREN
694:70:COMMA
695:29:ID cdr
695:33:EQ
695:35:ID env
695:39:LBRACE
695:40:ID car
695:44:EQ
695:46:ID mk_internal_fun
695:61:LPAREN
695:62:STRING "map"
695:67:RPAREN
695:68:COMMA
696:29:ID cdr
696:33:EQ
696:35:ID env
696:39:LBRACE
696:40:ID car
696:44:EQ
696:46:ID mk_internal_fun
696:61:LPAREN
696:62:STRING "foldl"
696:69:RPAREN
696:70:COMMA
697:29:ID cdr
697:33:EQ
697:35:ID env
697:39:LBRACE
697:40:ID car
697:44:EQ
697:46:ID mk_internal_fun
697:61:LPAREN
697:62:STRING "foldr"
697:69:RPAREN
697:70:COMMA
698:29:ID cdr
698:33:EQ
698:35:ID env
698:39:LBRACE
698:40:ID car
698:44:EQ
698:46:ID mk_internal_fun
698:61:LPAREN
698:62:STRING "print"
698:69:RPAREN
698:70:COMMA
699:29:ID cdr
699:33:EQ
699:35:ID env
699:39:LBRACE
699:40:ID car
699:44:EQ
699:46:ID mk_internal_fun
699:61:LPAREN
699:62:STRING "read-char"
699:73:RPAREN
699:74:COMMA
700:29:ID cdr
700:33:EQ
700:35:ID env
700:39:LBRACE
700:40:ID car
700:44:EQ
700:46:ID mk_internal_fun
700:61:LPAREN
700:62:STRING "read-line"
700:73:RPAREN
700:74:COMMA
701:29:ID cdr
701:33:EQ
701:35:ID env
701:39:LBRACE
701:40:ID car
701:44:EQ
701:46:ID mk_internal_fun
701:61:LPAREN
701:62:STRING "newline"
701:71:RPAREN
701:72:COMMA
702:29:ID cdr
702:33:EQ
702:35:ID env
702:39:LBRACE
702:40:ID car
702:44:EQ
702:46:ID mk_internal_fun
702:61:LPAREN
702:62:STRING "<s"
702:66:RPAREN
702:67:COMMA
703:29:ID cdr
703:33:EQ
703:35:ID env
703:39:LBRACE
703:40:ID car
703:44:EQ
703:46:ID mk_internal_fun
703:61:LPAREN
703:62:STRING "<=s"
703:67:RPAREN
703:68:COMMA
704:29:ID cdr
704:33:EQ
704:35:ID env
704:39:LBRACE
704:40:ID car
704:44:EQ
704:46:ID mk_internal_fun
704:61:LPAREN
704:62:STRING "=s"
704:66:RPAREN
704:67:COMMA
705:29:ID cdr
705:33:EQ
705:35:ID env
705:39:LBRACE
705:40:ID car
705:44:EQ
705:46:ID mk_internal_fun
705:61:LPAREN
705:62:STRING "!=s"
705:67:RPAREN
705:68:COMMA
706:29:ID cdr
706:33:EQ
706:35:ID env
706:39:LBRACE
706:40:ID car
706:44:EQ
706:46:ID mk_internal_fun
706:61:LPAREN
706:62:STRING ">=s"
706:67:RPAREN
706:68:COMMA
707:29:ID cdr
707:33:EQ
707:35:ID env
707:39:LBRACE
707:40:ID car
707:44:EQ
707:46:ID mk_internal_fun
707:61:LPAREN
707:62:STRING ">s"
707:66:RPAREN
707:67:COMMA
708:29:ID cdr
708:33:EQ
708:35:ID env
708:39:LBRACE
708:40:ID car
708:44:EQ
708:46:ID mk_internal_fun
708:61:LPAREN
708:62:STRING "+s"
708:66:RPAREN
708:67:COMMA
709:29:ID cdr
709:33:EQ
709:35:ID env
709:39:LBRACE
709:40:ID car
709:44:EQ
709:46:ID mk_internal_fun
709:61:LPAREN
709:62:STRING "ord"
709:67:RPAREN
709:68:COMMA
710:29:ID cdr
710:33:EQ
710:35:ID env
710:39:LBRACE
710:40:ID car
710:44:EQ
710:46:ID mk_internal_fun
710:61:LPAREN
710:62:STRING "chr"
710:67:RPAREN
710:68:COMMA
711:29:ID cdr
711:33:EQ
711:35:ID env
711:39:LBRACE
711:40:ID car
711:44:EQ
711:46:ID mk_internal_fun
711:61:LPAREN
711:62:STRING "s->i"
711:68:RPAREN
711:69:COMMA
712:29:ID cdr
712:33:EQ
712:35:ID env
712:39:LBRACE
712:40:ID car
712:44:EQ
712:46:ID mk_internal_fun
712:61:LPAREN
712:62:STRING "i->s"
712:68:RPAREN
712:69:COMMA
713:29:ID cdr
713:33:EQ
713:35:ID env
713:39:LBRACE
713:40:ID car
713:44:EQ
713:46:ID mk_internal_fun
713:61:LPAREN
713:62:STRING "substring"
713:73:RPAREN
713:74:COMMA
714:29:ID cdr
714:33:EQ
714:35:ID env
714:39:LBRACE
714:40:ID car
714:44:EQ
714:46:ID mk_internal_fun
714:61:LPAREN
714:62:STRING "int?"
714:68:RPAREN
714:69:COMMA
715:29:ID cdr
715:33:EQ
715:35:ID env
715:39:LBRACE
715:40:ID car
715:44:EQ
715:46:ID mk_internal_fun
715:61:LPAREN
715:62:STRING "string?"
715:71:RPAREN
715:72:COMMA
716:29:ID cdr
716:33:EQ
716:35:ID env
716:39:LBRACE
716:40:ID car
716:44:EQ
716:46:ID mk_internal_fun
716:61:LPAREN
716:62:STRING "list?"
716:69:RPAREN
716:70:COMMA
717:29:ID cdr
717:33:EQ
717:35:ID env
717:39:LBRACE
717:40:ID car
717:44:EQ
717:46:ID mk_internal_fun
717:61:LPAREN
717:62:STRING "nil?"
717:68:RPAREN
717:69:COMMA
718:29:ID cdr
718:33:EQ
718:35:ID env
718:39:LBRACE
718:40:ID car
718:44:EQ
718:46:ID mk_internal_fun
718:61:LPAREN
718:62:STRING "fun?"
718:68:RPAREN
718:69:COMMA
719:29:ID cdr
719:33:EQ
719:35:ID env
719:39:LBRACE
719:40:ID car
719:44:EQ
719:46:ID mk_internal_fun
719:61:LPAREN
719:62:STRING "lambda"
719:70:RPAREN
719:71:COMMA
720:29:ID cdr
720:33:EQ
720:35:ID env
720:39:LBRACE
720:40:ID car
720:44:EQ
720:46:ID mk_internal_fun
720:61:LPAREN
720:62:STRING "let"
720:67:RPAREN
720:68:COMMA
721:29:ID cdr
721:33:EQ
721:35:ID env
721:39:LBRACE
721:40:ID car
721:44:EQ
721:46:ID mk_internal_fun
721:61:LPAREN
721:62:STRING "let*"
721:68:RPAREN
721:69:COMMA
722:29:ID cdr
722:33:EQ
722:35:ID env
722:39:LBRACE
722:40:ID car
722:44:EQ
722:46:ID mk_internal_fun
722:61:LPAREN
722:62:STRING "letrec"
722:70:RPAREN
722:71:COMMA
723:29:ID cdr
723:33:EQ
723:35:ID env
723:39:LBRACE
723:40:ID car
723:44:EQ
723:46:ID mk_internal_fun
723:61:LPAREN
723:62:STRING "define"
723:70:RPAREN
723:71:COMMA
724:29:ID cdr
724:33:EQ
724:35:ID env
724:39:LBRACE
724:40:ID car
724:44:EQ
724:46:ID mk_internal_fun
724:61:LPAREN
724:62:STRING "quote"
724:69:RPAREN
724:70:COMMA
725:29:ID cdr
725:33:EQ
725:35:ID env
725:39:LBRACE
725:40:ID car
725:44:EQ
725:46:ID mk_internal_fun
725:61:LPAREN
725:62:STRING "quasiquote"
725:74:RPAREN
725:75:COMMA
726:29:ID cdr
726:33:EQ
726:35:ID env
726:39:LBRACE
726:40:ID car
726:44:EQ
726:46:ID mk_internal_fun
726:61:LPAREN
726:62:STRING "unquote"
726:71:RPAREN
726:72:COMMA
727:29:ID cdr
727:33:EQ
727:35:ID env
727:39:LBRACE
727:40:ID car
727:44:EQ
727:46:ID mk_internal_fun
727:61:LPAREN
727:62:STRING "exit"
727:68:RPAREN
727:69:COMMA
728:29:ID cdr
728:33:EQ
728:35:ID env
728:39:LBRACE
728:40:ID car
728:44:EQ
728:46:ID mk_internal_fun
728:61:LPAREN
728:62:STRING "help"
728:68:RPAREN
728:69:COMMA
729:40:ID cdr
729:44:EQ
729:46:NIL
729:49:RBRACE
729:50:RBRACE
729:51:RBRACE
729:52:RBRACE
729:53:RBRACE
729:54:RBRACE
729:55:RBRACE
729:56:RBRACE
729:57:RBRACE
729:58:RBRACE
729:59:RBRACE
729:60:RBRACE
729:61:RBRACE
729:62:RBRACE
729:63:RBRACE
729:64:RBRACE
729:65:RBRACE
729:66:RBRACE
729:67:RBRACE
729:68:RBRACE
729:69:RBRACE
729:70:RBRACE
729:71:RBRACE
729:72:RBRACE
729:73:RBRACE
729:74:RBRACE
729:75:RBRACE
729:76:RBRACE
729:77:RBRACE
729:78:RBRACE
729:79:RBRACE
729:80:RBRACE
729:81:RBRACE
729:82:RBRACE
729:83:RBRACE
729:84:RBRACE
729:85:RBRACE
729:86:RBRACE
729:87:RBRACE
729:88:RBRACE
729:89:RBRACE
729:90:RBRACE
729:91:RBRACE
729:92:RBRACE
729:93:RBRACE
729:94:RBRACE
729:95:RBRACE
729:96:RBRACE
729:97:RBRACE
729:98:RBRACE
729:99:RBRACE
729:100:RBRACE
729:101:RBRACE
729:102:RBRACE
729:103:RBRACE
729:104:RBRACE
729:105:RBRACE
729:106:RBRACE
731:5:FUNCTION
731:14:ID lookup
731:20:LPAREN
731:21:ID id
731:23:COLON
731:25:ID string
731:31:COMMA
731:33:ID env
731:36:COLON
731:38:ID env
731:41:RPAREN
731:42:COLON
731:44:ID sexp
731:49:EQ
732:7:IF
732:10:ID env
732:14:EQ
732:16:NIL
733:7:THEN
733:12:LPAREN
733:13:ID print
733:18:LPAREN
733:19:STRING "Error: Could not find '"
733:44:RPAREN
733:45:SEMICOLON
734:13:ID print
734:18:LPAREN
734:19:ID id
734:21:RPAREN
734:22:SEMICOLON
735:13:ID print
735:18:LPAREN
735:19:STRING "' in environment.\n"
735:40:RPAREN
735:41:SEMICOLON
736:13:NIL
736:16:RPAREN
737:7:ELSE
737:12:LET
737:16:VAR
737:20:ID curr_entry
737:31:ASSIGN
737:34:ID env
737:37:DOT
737:38:ID car
738:12:IN
738:15:IF
738:18:ID curr_entry
738:28:DOT
738:29:ID key
738:33:EQ
738:35:ID id
739:15:THEN
739:20:ID curr_entry
739:30:DOT
739:31:ID value
740:15:ELSE
740:20:ID lookup
740:26:LPAREN
740:27:ID id
740:29:COMMA
740:31:ID env
740:34:DOT
740:35:ID cdr
740:38:RPAREN
741:12:END
743:5:FUNCTION
743:14:ID eval
743:18:LPAREN
743:19:ID sexp
743:23:COLON
743:25:ID sexp
743:29:COMMA
743:31:ID env
743:34:COLON
743:36:ID env
743:39:RPAREN
743:40:COLON
743:42:ID sexp
743:47:EQ
744:7:IF
744:10:ID int_p
744:15:LPAREN
744:16:ID sexp
744:20:RPAREN
745:7:THEN
745:12:ID sexp
746:7:ELSE
746:12:IF
746:15:ID str_p
746:20:LPAREN
746:21:ID sexp
746:25:RPAREN
747:7:THEN
747:12:ID sexp
748:7:ELSE
748:12:IF
748:15:ID bool_p
748:21:LPAREN
748:22:ID sexp
748:26:RPAREN
749:7:THEN
749:12:ID sexp
750:7:ELSE
750:12:IF
750:15:ID sym_p
750:20:LPAREN
750:21:ID sexp
750:25:RPAREN
751:7:THEN
751:12:ID lookup
751:18:LPAREN
751:19:ID get_sym
751:26:LPAREN
751:27:ID sexp
751:31:RPAREN
751:32:COMMA
751:34:ID env
751:37:RPAREN
752:7:ELSE
752:12:IF
752:15:ID sexps_p
752:22:LPAREN
752:23:ID sexp
752:27:RPAREN
753:7:THEN
753:12:LET
753:16:VAR
753:20:ID sexps
753:26:ASSIGN
753:29:ID get_sexps
753:38:LPAREN
753:39:ID sexp
753:43:RPAREN
754:12:IN
754:15:IF
754:18:ID sexps
754:24:EQ
754:26:NIL
755:15:THEN
755:20:ID mk_sexps
755:28:LPAREN
755:29:NIL
755:32:RPAREN
756:15:ELSE
756:20:LET
756:24:VAR
756:28:ID head_sexp
756:38:ASSIGN
756:41:ID sexps
756:46:DOT
756:47:ID car
757:24:VAR
757:28:ID head
757:33:ASSIGN
757:36:ID eval
757:40:LPAREN
757:41:ID head_sexp
757:50:COMMA
757:52:ID env
757:55:RPAREN
758:20:IN
758:23:IF
758:26:ID fun_p
758:31:LPAREN
758:32:ID head
758:36:RPAREN
759:23:THEN
759:28:LET
759:32:VAR
759:36:ID fun
759:40:ASSIGN
759:43:ID get_fun
759:50:LPAREN
759:51:ID head
759:55:RPAREN
760:28:IN
760:31:ID apply_fun
760:40:LPAREN
760:41:ID fun
760:44:COMMA
760:46:ID sexps
760:51:DOT
760:52:ID cdr
760:55:COMMA
760:57:ID env
760:60:RPAREN
761:28:END
762:23:ELSE
762:28:LPAREN
762:29:ID print
762:34:LPAREN
762:35:STRING "Tried to apply non-function: '"
762:67:RPAREN
762:68:SEMICOLON
763:29:ID print
763:34:LPAREN
763:35:ID sexp2s
763:41:LPAREN
763:42:ID head
763:46:RPAREN
763:47:RPAREN
763:48:SEMICOLON
764:29:ID print
764:34:LPAREN
764:35:STRING "'\n"
764:40:RPAREN
764:41:SEMICOLON
765:29:NIL
765:32:RPAREN
766:20:END
767:12:END
768:7:ELSE
768:12:LPAREN
768:13:ID print
768:18:LPAREN
768:19:STRING "Eval error: Unknown sexp: '"
768:48:RPAREN
768:49:SEMICOLON
769:13:ID print
769:18:LPAREN
769:19:ID sexp2s
769:25:LPAREN
769:26:ID sexp
769:30:RPAREN
769:31:RPAREN
769:32:SEMICOLON
770:13:ID print
770:18:LPAREN
770:19:STRING "'\n"
770:24:RPAREN
770:25:SEMICOLON
771:13:NIL
771:16:RPAREN
772:5:FUNCTION
772:14:ID eval_sexps
772:24:LPAREN
772:25:ID sexps
772:30:COLON
772:32:ID sexps
772:37:COMMA
772:39:ID env
772:42:COLON
772:44:ID env
772:47:RPAREN
772:48:COLON
772:50:ID sexps
772:56:EQ
773:7:IF
773:10:ID sexps
773:16:EQ
773:18:NIL
774:7:THEN
774:12:NIL
775:7:ELSE
775:12:ID sexps
775:18:LBRACE
775:19:ID car
775:23:EQ
775:25:ID eval
775:29:LPAREN
775:30:ID sexps
775:35:DOT
775:36:ID car
775:39:COMMA
775:41:ID env
775:44:RPAREN
775:45:COMMA
775:47:ID cdr
775:51:EQ
775:53:ID eval_sexps
775:63:LPAREN
775:64:ID sexps
775:69:DOT
775:70:ID cdr
775:73:COMMA
775:75:ID env
775:78:RPAREN
775:79:RBRACE
777:5:FUNCTION
777:14:ID apply_fun
777:23:LPAREN
777:24:ID fun
777:27:COLON
777:29:ID Function
777:37:COMMA
777:39:ID args
777:43:COLON
777:45:ID sexps
777:50:COMMA
777:52:ID env
777:55:COLON
777:57:ID env
777:60:RPAREN
777:61:COLON
777:63:ID sexp
777:68:EQ
778:7:IF
778:10:ID lazy_fun_p
778:20:LPAREN
778:21:ID fun
778:24:RPAREN
779:7:THEN
779:12:ID apply_internal_lazy
779:31:LPAREN
779:32:ID fun
779:35:DOT
779:36:ID name
779:40:COMMA
779:42:ID args
779:46:COMMA
779:48:ID env
779:51:RPAREN
780:7:ELSE
780:12:ID apply_fun_cbv
780:25:LPAREN
780:26:ID fun
780:29:COMMA
780:31:ID eval_sexps
780:41:LPAREN
780:42:ID args
780:46:COMMA
780:48:ID env
780:51:RPAREN
780:52:COMMA
780:54:ID env
780:57:RPAREN
782:5:FUNCTION
782:14:ID apply_fun_cbv
782:27:LPAREN
782:28:ID fun
782:31:COLON
782:33:ID Function
782:41:COMMA
782:43:ID args
782:47:COLON
782:49:ID sexps
782:54:COMMA
782:56:ID env
782:59:COLON
782:61:ID env
782:64:RPAREN
782:65:COLON
782:67:ID sexp
782:72:EQ
783:7:IF
783:10:ID fun
783:13:DOT
783:14:ID typ
783:18:EQ
783:20:STRING "internal"
784:7:THEN
784:12:ID apply_internal_cbv
784:30:LPAREN
784:31:ID fun
784:34:DOT
784:35:ID name
784:39:COMMA
784:41:ID args
784:45:COMMA
784:47:ID env
784:50:RPAREN
785:7:ELSE
785:12:ID apply_user_cbv
785:26:LPAREN
785:27:ID fun
785:30:COMMA
785:32:ID args
785:36:RPAREN
788:5:FUNCTION
788:14:ID apply_user_cbv
788:28:LPAREN
788:29:ID fun
788:32:COLON
788:34:ID Function
788:42:COMMA
788:44:ID args
788:48:COLON
788:50:ID sexps
788:55:RPAREN
788:56:COLON
788:58:ID sexp
788:63:EQ
789:7:LET
789:11:VAR
789:15:ID env
789:19:ASSIGN
789:22:ID fun
789:25:DOT
789:26:ID env
790:11:FUNCTION
790:20:ID fill_env
790:28:LPAREN
790:29:ID parameters
790:39:COLON
790:41:ID parameters
790:51:COMMA
790:53:ID args
790:57:COLON
790:59:ID sexps
790:64:RPAREN
790:66:EQ
791:13:IF
791:16:ID parameters
791:27:NEQ
791:30:NIL
791:34:AND
791:36:ID args
791:41:NEQ
791:44:NIL
792:13:THEN
792:18:LPAREN
792:19:ID env
792:23:ASSIGN
792:26:ID env
792:30:LBRACE
792:31:ID car
792:35:EQ
792:37:ID env_entry
792:47:LBRACE
792:48:ID key
792:52:EQ
792:54:ID parameters
792:64:DOT
792:65:ID car
792:68:COMMA
793:48:ID value
793:54:EQ
793:56:ID args
793:60:DOT
793:61:ID car
793:64:RBRACE
793:65:COMMA
794:31:ID cdr
794:35:EQ
794:37:ID env
794:40:RBRACE
794:41:SEMICOLON
795:19:ID fill_env
795:27:LPAREN
795:28:ID parameters
795:38:DOT
795:39:ID cdr
795:42:COMMA
795:44:ID args
795:48:DOT
795:49:ID cdr
795:52:RPAREN
795:53:RPAREN
796:13:ELSE
796:18:IF
796:21:ID parameters
796:32:EQ
796:34:NIL
796:38:AND
796:40:ID args
796:45:NEQ
796:48:NIL
797:13:THEN
797:18:LPAREN
797:19:ID print
797:24:LPAREN
797:25:STRING "Too many arguments for function "
797:59:RPAREN
797:60:SEMICOLON
798:19:ID print
798:24:LPAREN
798:25:ID Function2s
798:35:LPAREN
798:36:ID fun
798:39:RPAREN
798:40:RPAREN
798:41:SEMICOLON
799:19:ID print
799:24:LPAREN
799:25:STRING ". Next remaining arg: '"
799:50:RPAREN
799:51:SEMICOLON
800:19:ID print
800:24:LPAREN
800:25:ID sexp2s
800:31:LPAREN
800:32:ID args
800:36:DOT
800:37:ID car
800:40:RPAREN
800:41:RPAREN
800:42:SEMICOLON
801:19:ID print
801:24:LPAREN
801:25:STRING "'\n"
801:30:RPAREN
801:31:RPAREN
802:13:ELSE
802:18:IF
802:21:ID parameters
802:32:NEQ
802:35:NIL
802:39:AND
802:41:ID args
802:46:EQ
802:48:NIL
803:13:THEN
803:18:LPAREN
803:19:ID print
803:24:LPAREN
803:25:STRING "Too few arguments for function "
803:58:RPAREN
803:59:SEMICOLON
804:19:ID print
804:24:LPAREN
804:25:ID Function2s
804:35:LPAREN
804:36:ID fun
804:39:RPAREN
804:40:RPAREN
804:41:SEMICOLON
805:19:ID print
805:24:LPAREN
805:25:STRING ". Next remaining parameter: '"
805:56:RPAREN
805:57:SEMICOLON
806:19:ID print
806:24:LPAREN
806:25:ID parameters
806:35:DOT
806:36:ID car
806:39:RPAREN
806:40:SEMICOLON
807:19:ID print
807:24:LPAREN
807:25:STRING "'\n"
807:30:RPAREN
807:31:RPAREN
808:13:ELSE
808:18:LPAREN
808:19:RPAREN
809:7:IN
809:10:ID fill_env
809:18:LPAREN
809:19:ID fun
809:22:DOT
809:23:ID pars
809:27:COMMA
809:29:ID args
809:33:RPAREN
809:34:SEMICOLON
810:10:ID eval
810:14:LPAREN
810:15:ID fun
810:18:DOT
810:19:ID body
810:23:COMMA
810:25:ID env
810:28:RPAREN
811:7:END
814:5:FUNCTION
814:14:ID lazy_fun_p
814:24:LPAREN
814:25:ID fun
814:28:COLON
814:30:ID Function
814:38:RPAREN
814:39:COLON
814:41:ID int
814:45:EQ
815:7:LET
815:11:VAR
815:15:ID fun_name
815:24:ASSIGN
815:27:ID fun
815:30:DOT
815:31:ID name
816:11:VAR
816:15:ID fun_typ
816:23:ASSIGN
816:26:ID fun
816:29:DOT
816:30:ID typ
817:7:IN
817:10:ID fun_typ
817:18:EQ
817:20:STRING "internal"
818:10:AND
818:12:LPAREN
818:13:ID fun_name
818:22:EQ
818:24:STRING "and"
818:30:OR
818:32:ID fun_name
818:41:EQ
818:43:STRING "or"
818:48:OR
818:50:ID fun_name
818:59:EQ
818:61:STRING "ifb"
818:67:OR
818:69:ID fun_name
818:78:EQ
818:80:STRING "lambda"
819:13:OR
819:15:ID fun_name
819:24:EQ
819:26:STRING "define"
820:13:OR
820:15:ID fun_name
820:24:EQ
820:26:STRING "let"
820:32:OR
820:34:ID fun_name
820:43:EQ
820:45:STRING "let*"
820:52:OR
820:54:ID fun_name
820:63:EQ
820:65:STRING "letrec"
821:13:OR
821:15:ID fun_name
821:24:EQ
821:26:STRING "quote"
821:34:OR
821:36:ID fun_name
821:45:EQ
821:47:STRING "quasiquote"
821:60:OR
821:62:ID fun_name
821:71:EQ
821:73:STRING "unquote"
821:82:RPAREN
822:7:END
824:5:FUNCTION
824:14:ID apply_internal_lazy
824:33:LPAREN
824:34:ID fun_name
824:42:COLON
824:44:ID string
824:50:COMMA
824:52:ID args
824:56:COLON
824:58:ID sexps
824:63:COMMA
824:65:ID env
824:68:COLON
824:70:ID env
824:73:RPAREN
824:74:COLON
824:76:ID sexp
824:81:EQ
827:7:LET
827:11:FUNCTION
827:20:ID or
827:22:LPAREN
827:23:ID args
827:27:COLON
827:29:ID sexps
827:34:RPAREN
827:35:COLON
827:37:ID sexp
827:42:EQ
828:13:IF
828:16:ID args
828:21:EQ
828:23:NIL
829:13:THEN
829:18:ID mk_bool
829:25:LPAREN
829:26:INT 0
829:27:RPAREN
830:13:ELSE
830:18:LET
830:22:VAR
830:26:ID curr_arg
830:35:ASSIGN
830:38:ID eval
830:42:LPAREN
830:43:ID args
830:47:DOT
830:48:ID car
830:51:COMMA
830:53:ID env
830:56:RPAREN
831:18:IN
831:21:IF
831:24:ID bool_p
831:30:LPAREN
831:31:ID curr_arg
831:39:RPAREN
831:41:AND
831:43:ID get_bool
831:51:LPAREN
831:52:ID curr_arg
831:60:RPAREN
831:62:EQ
831:64:INT 0
832:21:THEN
832:26:ID or
832:28:LPAREN
832:29:ID args
832:33:DOT
832:34:ID cdr
832:37:RPAREN
833:21:ELSE
833:26:ID curr_arg
834:18:END
835:11:FUNCTION
835:20:ID and
835:23:LPAREN
835:24:ID args
835:28:COLON
835:30:ID sexps
835:35:RPAREN
835:36:COLON
835:38:ID sexp
835:43:EQ
836:13:IF
836:16:ID args
836:21:EQ
836:23:NIL
837:13:THEN
837:18:ID mk_bool
837:25:LPAREN
837:26:INT 1
837:27:RPAREN
838:13:ELSE
838:18:LET
838:22:VAR
838:26:ID curr_arg
838:35:ASSIGN
838:38:ID eval
838:42:LPAREN
838:43:ID args
838:47:DOT
838:48:ID car
838:51:COMMA
838:53:ID env
838:56:RPAREN
839:18:IN
839:21:IF
839:24:ID bool_p
839:30:LPAREN
839:31:ID curr_arg
839:39:RPAREN
839:41:AND
839:43:ID get_bool
839:51:LPAREN
839:52:ID curr_arg
839:60:RPAREN
839:62:EQ
839:64:INT 0
840:21:THEN
840:26:ID mk_bool
840:33:LPAREN
840:34:INT 0
840:35:RPAREN
841:21:ELSE
841:26:IF
841:29:ID args
841:33:DOT
841:34:ID cdr
841:38:EQ
841:40:NIL
842:21:THEN
842:26:ID curr_arg
843:21:ELSE
843:26:ID and
843:29:LPAREN
843:30:ID args
843:34:DOT
843:35:ID cdr
843:38:RPAREN
844:18:END
845:11:FUNCTION
845:20:ID ifb
845:23:LPAREN
845:24:ID args
845:28:COLON
845:30:ID sexps
845:35:RPAREN
845:36:COLON
845:38:ID sexp
845:43:EQ
846:13:IF
846:16:ID args
846:21:EQ
846:23:NIL
846:27:OR
846:29:ID args
846:33:DOT
846:34:ID cdr
846:38:EQ
846:40:NIL
846:44:OR
846:46:ID args
846:50:DOT
846:51:ID cdr
846:54:DOT
846:55:ID cdr
846:59:EQ
846:61:NIL
847:16:OR
847:18:LPAREN
847:19:ID args
847:23:DOT
847:24:ID cdr
847:27:DOT
847:28:ID cdr
847:32:NEQ
847:35:NIL
847:39:AND
847:41:ID args
847:45:DOT
847:46:ID cdr
847:49:DOT
847:50:ID cdr
847:53:DOT
847:54:ID cdr
847:58:NEQ
847:61:NIL
847:64:RPAREN
848:13:THEN
848:18:LPAREN
848:19:ID print
848:24:LPAREN
848:25:STRING "ifb needs exactly 3 arguments.\n"
848:59:RPAREN
848:60:SEMICOLON
849:19:NIL
849:22:RPAREN
850:13:ELSE
850:18:LET
850:22:VAR
850:26:ID cond_arg
850:35:ASSIGN
850:38:ID eval
850:42:LPAREN
850:43:ID args
850:47:DOT
850:48:ID car
850:51:COMMA
850:53:ID env
850:56:RPAREN
851:22:VAR
851:26:ID then_sexp
851:36:ASSIGN
851:39:ID args
851:43:DOT
851:44:ID cdr
851:47:DOT
851:48:ID car
852:22:VAR
852:26:ID else_sexp
852:36:ASSIGN
852:39:ID args
852:43:DOT
852:44:ID cdr
852:47:DOT
852:48:ID cdr
852:51:DOT
852:52:ID car
853:18:IN
853:21:IF
853:24:ID bool_p
853:30:LPAREN
853:31:ID cond_arg
853:39:RPAREN
854:21:THEN
854:26:IF
854:29:ID get_bool
854:37:LPAREN
854:38:ID cond_arg
854:46:RPAREN
855:26:THEN
855:31:ID eval
855:35:LPAREN
855:36:ID then_sexp
855:45:COMMA
855:47:ID env
855:50:RPAREN
856:26:ELSE
856:31:ID eval
856:35:LPAREN
856:36:ID else_sexp
856:45:COMMA
856:47:ID env
856:50:RPAREN
857:21:ELSE
857:26:LPAREN
857:27:ID print
857:32:LPAREN
857:33:STRING "Illegal argument as condition in ifb, sexp: '"
857:80:RPAREN
857:81:SEMICOLON
858:27:ID print
858:32:LPAREN
858:33:ID sexp2s
858:39:LPAREN
858:40:ID cond_arg
858:48:RPAREN
858:49:RPAREN
858:50:SEMICOLON
859:27:ID print
859:32:LPAREN
859:33:STRING "'\n"
859:38:RPAREN
859:39:SEMICOLON
860:27:NIL
860:30:RPAREN
861:18:END
862:11:FUNCTION
862:20:ID lambda
862:26:LPAREN
862:27:ID args
862:31:COLON
862:33:ID sexps
862:38:RPAREN
862:39:COLON
862:41:ID sexp
862:46:EQ
863:13:IF
863:16:ID args
863:21:EQ
863:23:NIL
863:27:OR
863:29:ID args
863:33:DOT
863:34:ID cdr
863:38:EQ
863:40:NIL
864:16:OR
864:18:LPAREN
864:19:ID args
864:23:DOT
864:24:ID cdr
864:28:NEQ
864:31:NIL
864:35:AND
864:37:ID args
864:41:DOT
864:42:ID cdr
864:45:DOT
864:46:ID cdr
864:50:NEQ
864:53:NIL
864:56:RPAREN
865:13:THEN
865:18:LPAREN
865:19:ID print
865:24:LPAREN
865:25:STRING "lambda needs exactly 2 arguments.\n"
865:62:RPAREN
865:63:SEMICOLON
866:19:NIL
866:22:RPAREN
867:13:ELSE
867:18:LET
867:22:VAR
867:26:ID parameters_sexp
867:42:ASSIGN
867:45:ID args
867:49:DOT
867:50:ID car
868:22:VAR
868:26:ID body_sexp
868:36:ASSIGN
868:39:ID args
868:43:DOT
868:44:ID cdr
868:47:DOT
868:48:ID car
869:18:IN
869:21:IF
869:24:ID sexps_p
869:31:LPAREN
869:32:ID parameters_sexp
869:47:RPAREN
870:21:THEN
870:26:LET
870:30:VAR
870:34:ID parameters
870:44:COLON
870:46:ID parameters
870:57:ASSIGN
870:60:NIL
871:30:FUNCTION
871:39:ID fill_parameters
871:54:LPAREN
871:55:ID sexps
871:60:COLON
871:62:ID sexps
871:67:RPAREN
871:69:EQ
872:32:IF
872:35:ID sexps
872:41:NEQ
872:44:NIL
873:32:THEN
873:37:LPAREN
873:38:ID fill_parameters
873:53:LPAREN
873:54:ID sexps
873:59:DOT
873:60:ID cdr
873:63:RPAREN
873:64:SEMICOLON
874:38:IF
874:41:ID sym_p
874:46:LPAREN
874:47:ID sexps
874:52:DOT
874:53:ID car
874:56:RPAREN
875:38:THEN
875:43:ID parameters
875:54:ASSIGN
875:57:ID parameters
875:68:LBRACE
875:69:ID car
875:73:EQ
875:75:ID get_sym
875:82:LPAREN
875:83:ID sexps
875:88:DOT
875:89:ID car
875:92:RPAREN
875:93:COMMA
876:69:ID cdr
876:73:EQ
876:75:ID parameters
876:85:RBRACE
877:38:ELSE
877:43:LPAREN
877:44:ID print
877:49:LPAREN
877:50:STRING "Illegal parameter in lambda expression: '"
877:93:RPAREN
877:94:SEMICOLON
878:44:ID print
878:49:LPAREN
878:50:ID sexp2s
878:56:LPAREN
878:57:ID sexps
878:62:DOT
878:63:ID car
878:66:RPAREN
878:67:RPAREN
878:68:SEMICOLON
879:44:ID print
879:49:LPAREN
879:50:STRING "'\n"
879:55:RPAREN
879:56:RPAREN
879:57:RPAREN
880:26:IN
880:29:ID fill_parameters
880:44:LPAREN
880:45:ID get_sexps
880:54:LPAREN
880:55:ID parameters_sexp
880:70:RPAREN
880:71:RPAREN
880:72:SEMICOLON
881:29:ID mk_fun
881:35:LPAREN
881:36:ID parameters
881:46:COMMA
881:48:ID body_sexp
881:57:COMMA
881:59:ID env
881:62:RPAREN
882:26:END
883:21:ELSE
883:26:LPAREN
883:27:ID print
883:32:LPAREN
883:33:STRING "Parameter list in lambda expression has to be a list: '"
883:90:RPAREN
883:91:SEMICOLON
884:27:ID print
884:32:LPAREN
884:33:ID sexp2s
884:39:LPAREN
884:40:ID parameters_sexp
884:55:RPAREN
884:56:RPAREN
884:57:SEMICOLON
885:27:ID print
885:32:LPAREN
885:33:STRING "'\n"
885:38:RPAREN
885:39:SEMICOLON
886:27:NIL
886:30:RPAREN
887:18:END
888:11:FUNCTION
888:20:ID let_
888:24:LPAREN
888:25:ID args
888:29:COLON
888:31:ID sexps
888:36:RPAREN
888:37:COLON
888:39:ID sexp
888:44:EQ
889:13:IF
889:16:ID args
889:21:EQ
889:23:NIL
889:27:OR
889:29:ID args
889:33:DOT
889:34:ID cdr
889:38:EQ
889:40:NIL
890:16:OR
890:18:LPAREN
890:19:ID args
890:23:DOT
890:24:ID cdr
890:28:NEQ
890:31:NIL
890:35:AND
890:37:ID args
890:41:DOT
890:42:ID cdr
890:45:DOT
890:46:ID cdr
890:50:NEQ
890:53:NIL
890:56:RPAREN
891:13:THEN
891:18:LPAREN
891:19:ID print
891:24:LPAREN
891:25:STRING "let needs exactly 2 arguments.\n"
891:59:RPAREN
891:60:SEMICOLON
892:19:NIL
892:22:RPAREN
893:13:ELSE
893:18:LET
893:22:VAR
893:26:ID bindings_sexp
893:40:ASSIGN
893:43:ID args
893:47:DOT
893:48:ID car
894:22:VAR
894:26:ID body_sexp
894:36:ASSIGN
894:39:ID args
894:43:DOT
894:44:ID cdr
894:47:DOT
894:48:ID car
895:22:VAR
895:26:ID body_env
895:35:ASSIGN
895:38:ID env
896:22:FUNCTION
896:31:ID fill_env
896:39:LPAREN
896:40:ID bindings
896:48:COLON
896:50:ID sexps
896:55:RPAREN
896:57:EQ
897:24:IF
897:27:ID bindings
897:36:NEQ
897:39:NIL
898:24:THEN
898:29:LET
898:33:VAR
898:37:ID curr_binding_sexp
898:55:ASSIGN
898:58:ID bindings
898:66:DOT
898:67:ID car
899:29:IN
899:32:IF
899:35:ID sexps_p
899:42:LPAREN
899:43:ID curr_binding_sexp
899:60:RPAREN
900:32:THEN
900:37:LET
900:41:VAR
900:45:ID curr_binding
900:58:ASSIGN
900:61:ID get_sexps
900:70:LPAREN
900:71:ID curr_binding_sexp
900:88:RPAREN
901:37:IN
901:40:IF
901:43:ID curr_binding
901:56:EQ
901:58:NIL
901:62:OR
901:64:ID curr_binding
901:76:DOT
901:77:ID cdr
901:81:EQ
901:83:NIL
902:43:OR
902:45:LPAREN
902:46:ID curr_binding
902:58:DOT
902:59:ID cdr
902:63:NEQ
902:66:NIL
902:70:AND
902:72:ID curr_binding
902:84:DOT
902:85:ID cdr
902:89:NEQ
902:92:NIL
902:95:RPAREN
903:40:THEN
903:45:LET
903:49:VAR
903:53:ID name
903:58:ASSIGN
903:61:ID curr_binding
903:73:DOT
903:74:ID car
904:49:VAR
904:53:ID value_sexp
904:64:ASSIGN
904:67:ID curr_binding
904:79:DOT
904:80:ID cdr
904:83:DOT
904:84:ID car
905:45:IN
905:48:IF
905:51:ID sym_p
905:56:LPAREN
905:57:ID name
905:61:RPAREN
906:48:THEN
906:53:LPAREN
906:54:ID body_env
906:63:ASSIGN
906:66:ID env
906:70:LBRACE
906:71:ID car
906:75:EQ
906:77:ID env_entry
906:87:LBRACE
906:88:ID key
906:92:EQ
906:94:ID get_sym
906:101:LPAREN
906:102:ID name
906:106:RPAREN
906:107:COMMA
907:88:ID value
907:94:EQ
907:96:ID eval
907:100:LPAREN
907:101:ID value_sexp
907:111:COMMA
907:113:ID env
907:116:RPAREN
907:117:RBRACE
907:118:COMMA
908:71:ID cdr
908:75:EQ
908:77:ID body_env
908:85:RBRACE
908:86:SEMICOLON
909:54:ID fill_env
909:62:LPAREN
909:63:ID bindings
909:71:DOT
909:72:ID cdr
909:75:RPAREN
909:76:RPAREN
910:48:ELSE
910:53:LPAREN
910:54:ID print
910:59:LPAREN
910:60:STRING "Name in binding in let has to be a symbol: '"
910:106:RPAREN
910:107:SEMICOLON
911:54:ID print
911:59:LPAREN
911:60:ID sexp2s
911:66:LPAREN
911:67:ID name
911:71:RPAREN
911:72:RPAREN
911:73:SEMICOLON
912:54:ID print
912:59:LPAREN
912:60:STRING "'\n"
912:65:RPAREN
912:66:RPAREN
913:45:END
914:40:ELSE
914:45:LPAREN
914:46:ID print
914:51:LPAREN
914:52:STRING "Binding in let binding have to be of length 2: '"
914:102:RPAREN
914:103:SEMICOLON
915:46:ID print
915:51:LPAREN
915:52:ID sexp2s
915:58:LPAREN
915:59:ID curr_binding_sexp
915:76:RPAREN
915:77:RPAREN
915:78:SEMICOLON
916:46:ID print
916:51:LPAREN
916:52:STRING "'\n"
916:57:RPAREN
916:58:RPAREN
917:37:END
918:32:ELSE
918:37:LPAREN
918:38:ID print
918:43:LPAREN
918:44:STRING "Illegal binding in let bindings: '"
918:80:RPAREN
918:81:SEMICOLON
919:38:ID print
919:43:LPAREN
919:44:ID sexp2s
919:50:LPAREN
919:51:ID curr_binding_sexp
919:68:RPAREN
919:69:RPAREN
919:70:SEMICOLON
920:38:ID print
920:43:LPAREN
920:44:STRING "'\n"
920:49:RPAREN
920:50:RPAREN
921:29:END
922:18:IN
922:21:IF
922:24:ID sexps_p
922:31:LPAREN
922:32:ID bindings_sexp
922:45:RPAREN
923:21:THEN
923:26:LPAREN
923:27:ID fill_env
923:35:LPAREN
923:36:ID get_sexps
923:45:LPAREN
923:46:ID bindings_sexp
923:59:RPAREN
923:60:RPAREN
923:61:SEMICOLON
924:27:ID eval
924:31:LPAREN
924:32:ID body_sexp
924:41:COMMA
924:43:ID body_env
924:51:RPAREN
924:52:RPAREN
925:21:ELSE
925:26:LPAREN
925:27:ID print
925:32:LPAREN
925:33:STRING "Bindings list in let expression has to be a list: '"
925:86:RPAREN
925:87:SEMICOLON
926:27:ID print
926:32:LPAREN
926:33:ID sexp2s
926:39:LPAREN
926:40:ID bindings_sexp
926:53:RPAREN
926:54:RPAREN
926:55:SEMICOLON
927:27:ID print
927:32:LPAREN
927:33:STRING "'\n"
927:38:RPAREN
927:39:SEMICOLON
928:27:NIL
928:30:RPAREN
929:18:END
930:11:FUNCTION
930:20:ID letstar
930:27:LPAREN
930:28:ID args
930:32:COLON
930:34:ID sexps
930:39:RPAREN
930:40:COLON
930:42:ID sexp
930:47:EQ
931:13:IF
931:16:ID args
931:21:EQ
931:23:NIL
931:27:OR
931:29:ID args
931:33:DOT
931:34:ID cdr
931:38:EQ
931:40:NIL
932:16:OR
932:18:LPAREN
932:19:ID args
932:23:DOT
932:24:ID cdr
932:28:NEQ
932:31:NIL
932:35:AND
932:37:ID args
932:41:DOT
932:42:ID cdr
932:45:DOT
932:46:ID cdr
932:50:NEQ
932:53:NIL
932:56:RPAREN
933:13:THEN
933:18:LPAREN
933:19:ID print
933:24:LPAREN
933:25:STRING "let* needs exactly 2 arguments.\n"
933:60:RPAREN
933:61:SEMICOLON
934:19:NIL
934:22:RPAREN
935:13:ELSE
935:18:LET
935:22:VAR
935:26:ID bindings_sexp
935:40:ASSIGN
935:43:ID args
935:47:DOT
935:48:ID car
936:22:VAR
936:26:ID body_sexp
936:36:ASSIGN
936:39:ID args
936:43:DOT
936:44:ID cdr
936:47:DOT
936:48:ID car
937:22:VAR
937:26:ID body_env
937:35:ASSIGN
937:38:ID env
938:22:FUNCTION
938:31:ID fill_env
938:39:LPAREN
938:40:ID bindings
938:48:COLON
938:50:ID sexps
938:55:RPAREN
938:57:EQ
939:24:IF
939:27:ID bindings
939:36:NEQ
939:39:NIL
940:24:THEN
940:29:LET
940:33:VAR
940:37:ID curr_binding_sexp
940:55:ASSIGN
940:58:ID bindings
940:66:DOT
940:67:ID car
941:29:IN
941:32:IF
941:35:ID sexps_p
941:42:LPAREN
941:43:ID curr_binding_sexp
941:60:RPAREN
942:32:THEN
942:37:LET
942:41:VAR
942:45:ID curr_binding
942:58:ASSIGN
942:61:ID get_sexps
942:70:LPAREN
942:71:ID curr_binding_sexp
942:88:RPAREN
943:37:IN
943:40:IF
943:43:ID curr_binding
943:56:EQ
943:58:NIL
943:62:OR
943:64:ID curr_binding
943:76:DOT
943:77:ID cdr
943:81:EQ
943:83:NIL
944:43:OR
944:45:LPAREN
944:46:ID curr_binding
944:58:DOT
944:59:ID cdr
944:63:NEQ
944:66:NIL
944:70:AND
944:72:ID curr_binding
944:84:DOT
944:85:ID cdr
944:89:NEQ
944:92:NIL
944:95:RPAREN
945:40:THEN
945:45:LET
945:49:VAR
945:53:ID name
945:58:ASSIGN
945:61:ID curr_binding
945:73:DOT
945:74:ID car
946:49:VAR
946:53:ID value_sexp
946:64:ASSIGN
946:67:ID curr_binding
946:79:DOT
946:80:ID cdr
946:83:DOT
946:84:ID car
947:45:IN
947:48:IF
947:51:ID sym_p
947:56:LPAREN
947:57:ID name
947:61:RPAREN
948:48:THEN
948:53:LPAREN
948:54:ID body_env
948:63:ASSIGN
948:66:ID env
948:70:LBRACE
948:71:ID car
948:75:EQ
948:77:ID env_entry
948:87:LBRACE
948:88:ID key
948:92:EQ
948:94:ID get_sym
948:101:LPAREN
948:102:ID name
948:106:RPAREN
948:107:COMMA
949:88:ID value
949:94:EQ
949:96:ID eval
949:100:LPAREN
949:101:ID value_sexp
949:111:COMMA
949:113:ID body_env
949:121:RPAREN
949:122:RBRACE
949:123:COMMA
950:71:ID cdr
950:75:EQ
950:77:ID body_env
950:85:RBRACE
950:86:SEMICOLON
951:54:ID fill_env
951:62:LPAREN
951:63:ID bindings
951:71:DOT
951:72:ID cdr
951:75:RPAREN
951:76:RPAREN
952:48:ELSE
952:53:LPAREN
952:54:ID print
952:59:LPAREN
952:60:STRING "Name in binding in let* has to be a symbol: '"
952:107:RPAREN
952:108:SEMICOLON
953:54:ID print
953:59:LPAREN
953:60:ID sexp2s
953:66:LPAREN
953:67:ID name
953:71:RPAREN
953:72:RPAREN
953:73:SEMICOLON
954:54:ID print
954:59:LPAREN
954:60:STRING "'\n"
954:65:RPAREN
954:66:RPAREN
955:45:END
956:40:ELSE
956:45:LPAREN
956:46:ID print
956:51:LPAREN
956:52:STRING "Binding in let* binding have to be of length 2: '"
956:103:RPAREN
956:104:SEMICOLON
957:46:ID print
957:51:LPAREN
957:52:ID sexp2s
957:58:LPAREN
957:59:ID curr_binding_sexp
957:76:RPAREN
957:77:RPAREN
957:78:SEMICOLON
958:46:ID print
958:51:LPAREN
958:52:STRING "'\n"
958:57:RPAREN
958:58:RPAREN
959:37:END
960:32:ELSE
960:37:LPAREN
960:38:ID print
960:43:LPAREN
960:44:STRING "Illegal binding in let* bindings: '"
960:81:RPAREN
960:82:SEMICOLON
961:38:ID print
961:43:LPAREN
961:44:ID sexp2s
961:50:LPAREN
961:51:ID curr_binding_sexp
961:68:RPAREN
961:69:RPAREN
961:70:SEMICOLON
962:38:ID print
962:43:LPAREN
962:44:STRING "'\n"
962:49:RPAREN
962:50:RPAREN
963:29:END
964:18:IN
964:21:IF
964:24:ID sexps_p
964:31:LPAREN
964:32:ID bindings_sexp
964:45:RPAREN
965:21:THEN
965:26:LPAREN
965:27:ID fill_env
965:35:LPAREN
965:36:ID get_sexps
965:45:LPAREN
965:46:ID bindings_sexp
965:59:RPAREN
965:60:RPAREN
965:61:SEMICOLON
966:27:ID eval
966:31:LPAREN
966:32:ID body_sexp
966:41:COMMA
966:43:ID body_env
966:51:RPAREN
966:52:RPAREN
967:21:ELSE
967:26:LPAREN
967:27:ID print
967:32:LPAREN
967:33:STRING "Bindings list in let* expression has to be a list: '"
967:87:RPAREN
967:88:SEMICOLON
968:27:ID print
968:32:LPAREN
968:33:ID sexp2s
968:39:LPAREN
968:40:ID bindings_sexp
968:53:RPAREN
968:54:RPAREN
968:55:SEMICOLON
969:27:ID print
969:32:LPAREN
969:33:STRING "'\n"
969:38:RPAREN
969:39:SEMICOLON
970:27:NIL
970:30:RPAREN
971:18:END
972:11:FUNCTION
972:20:ID letrec
972:26:LPAREN
972:27:ID args
972:31:COLON
972:33:ID sexps
972:38:RPAREN
972:39:COLON
972:41:ID sexp
972:46:EQ
973:13:IF
973:16:ID args
973:21:EQ
973:23:NIL
973:27:OR
973:29:ID args
973:33:DOT
973:34:ID cdr
973:38:EQ
973:40:NIL
974:16:OR
974:18:LPAREN
974:19:ID args
974:23:DOT
974:24:ID cdr
974:28:NEQ
974:31:NIL
974:35:AND
974:37:ID args
974:41:DOT
974:42:ID cdr
974:45:DOT
974:46:ID cdr
974:50:NEQ
974:53:NIL
974:56:RPAREN
975:13:THEN
975:18:LPAREN
975:19:ID print
975:24:LPAREN
975:25:STRING "letrec needs exactly 2 arguments.\n"
975:62:RPAREN
975:63:SEMICOLON
976:19:NIL
976:22:RPAREN
977:13:ELSE
977:18:LET
977:22:VAR
977:26:ID bindings_sexp
977:40:ASSIGN
977:43:ID args
977:47:DOT
977:48:ID car
978:22:VAR
978:26:ID body_sexp
978:36:ASSIGN
978:39:ID args
978:43:DOT
978:44:ID cdr
978:47:DOT
978:48:ID car
979:22:TYPE
979:27:ID partial
979:35:EQ
979:37:LBRACE
979:38:ID value
979:43:COLON
979:45:ID sexp
979:49:COMMA
980:38:ID env_entry
980:47:COLON
980:49:ID env_entry
980:58:COMMA
981:38:ID value_sexp
981:48:COLON
981:50:ID sexp
981:54:RBRACE
982:22:TYPE
982:27:ID partials
982:36:EQ
982:38:LBRACE
982:39:ID car
982:42:COLON
982:44:ID partial
982:51:COMMA
982:53:ID cdr
982:56:COLON
982:58:ID partials
982:66:RBRACE
984:22:FUNCTION
984:31:ID get_env_extension
984:48:LPAREN
984:49:ID bindings
984:57:COLON
984:59:ID sexps
984:64:RPAREN
984:65:COLON
984:67:ID partials
984:76:EQ
985:24:IF
985:27:ID bindings
985:36:EQ
985:38:NIL
986:24:THEN
986:29:NIL
987:24:ELSE
987:29:LET
987:33:VAR
987:37:ID curr_binding_sexp
987:55:ASSIGN
987:58:ID bindings
987:66:DOT
987:67:ID car
988:29:IN
988:32:IF
988:35:ID sexps_p
988:42:LPAREN
988:43:ID curr_binding_sexp
988:60:RPAREN
989:32:THEN
989:37:LET
989:41:VAR
989:45:ID curr_binding
989:58:ASSIGN
989:61:ID get_sexps
989:70:LPAREN
989:71:ID curr_binding_sexp
989:88:RPAREN
990:37:IN
990:40:IF
990:43:ID curr_binding
990:56:EQ
990:58:NIL
990:62:OR
990:64:ID curr_binding
990:76:DOT
990:77:ID cdr
990:81:EQ
990:83:NIL
991:43:OR
991:45:LPAREN
991:46:ID curr_binding
991:58:DOT
991:59:ID cdr
991:63:NEQ
991:66:NIL
991:70:AND
991:72:ID curr_binding
991:84:DOT
991:85:ID cdr
991:89:NEQ
991:92:NIL
991:95:RPAREN
992:40:THEN
992:45:LET
992:49:VAR
992:53:ID name
992:58:ASSIGN
992:61:ID curr_binding
992:73:DOT
992:74:ID car
993:49:VAR
993:53:ID value_sexp
993:64:ASSIGN
993:67:ID curr_binding
993:79:DOT
993:80:ID cdr
993:83:DOT
993:84:ID car
994:45:IN
994:48:IF
994:51:ID sym_p
994:56:LPAREN
994:57:ID name
994:61:RPAREN
995:48:THEN
995:53:LET
995:57:VAR
995:61:ID value
995:67:ASSIGN
995:70:ID mk_mt_sexp
995:81:LPAREN
995:82:RPAREN
996:53:IN
996:56:ID partials
996:65:LBRACE
996:66:ID car
996:70:EQ
996:72:ID partial
996:80:LBRACE
996:81:ID value
996:87:EQ
996:89:ID value
996:94:COMMA
997:81:ID env_entry
997:91:EQ
997:93:ID env_entry
997:103:LBRACE
997:104:ID key
997:108:EQ
997:110:ID get_sym
997:117:LPAREN
997:118:ID name
997:122:RPAREN
997:123:COMMA
997:125:ID value
997:131:EQ
997:133:ID value
997:138:RBRACE
997:139:COMMA
998:81:ID value_sexp
998:92:EQ
998:94:ID value_sexp
998:104:RBRACE
998:105:COMMA
999:66:ID cdr
999:70:EQ
999:72:ID get_env_extension
999:89:LPAREN
999:90:ID bindings
999:98:DOT
999:99:ID cdr
999:102:RPAREN
999:103:RBRACE
1000:53:END
1001:48:ELSE
1001:53:LPAREN
1001:54:ID print
1001:59:LPAREN
1001:60:STRING "Name in binding in letrec has to be a symbol: '"
1001:109:RPAREN
1001:110:SEMICOLON
1002:54:ID print
1002:59:LPAREN
1002:60:ID sexp2s
1002:66:LPAREN
1002:67:ID name
1002:71:RPAREN
1002:72:RPAREN
1002:73:SEMICOLON
1003:54:ID print
1003:59:LPAREN
1003:60:STRING "'\n"
1003:65:RPAREN
1003:66:SEMICOLON
1004:54:NIL
1004:57:RPAREN
1005:45:END
1006:40:ELSE
1006:45:LPAREN
1006:46:ID print
1006:51:LPAREN
1006:52:STRING "Binding in letrec binding have to be of length 2: '"
1006:105:RPAREN
1006:106:SEMICOLON
1007:46:ID print
1007:51:LPAREN
1007:52:ID sexp2s
1007:58:LPAREN
1007:59:ID curr_binding_sexp
1007:76:RPAREN
1007:77:RPAREN
1007:78:SEMICOLON
1008:46:ID print
1008:51:LPAREN
1008:52:STRING "'\n"
1008:57:RPAREN
1008:58:SEMICOLON
1009:46:NIL
1009:49:RPAREN
1010:37:END
1011:32:ELSE
1011:37:LPAREN
1011:38:ID print
1011:43:LPAREN
1011:44:STRING "Illegal binding in letrec bindings: '"
1011:83:RPAREN
1011:84:SEMICOLON
1012:38:ID print
1012:43:LPAREN
1012:44:ID sexp2s
1012:50:LPAREN
1012:51:ID curr_binding_sexp
1012:68:RPAREN
1012:69:RPAREN
1012:70:SEMICOLON
1013:38:ID print
1013:43:LPAREN
1013:44:STRING "'\n"
1013:49:RPAREN
1013:50:SEMICOLON
1014:38:NIL
1014:41:RPAREN
1015:29:END
1016:22:FUNCTION
1016:31:ID fill_body_env
1016:44:LPAREN
1016:45:ID partials
1016:53:COLON
1016:55:ID partials
1016:63:RPAREN
1016:64:COLON
1016:66:ID env
1016:70:EQ
1017:24:IF
1017:27:ID partials
1017:36:EQ
1017:38:NIL
1018:24:THEN
1018:29:ID env
1019:24:ELSE
1019:29:ID env
1019:33:LBRACE
1019:34:ID car
1019:38:EQ
1019:40:ID partials
1019:48:DOT
1019:49:ID car
1019:52:DOT
1019:53:ID env_entry
1019:62:COMMA
1020:34:ID cdr
1020:38:EQ
1020:40:ID fill_body_env
1020:53:LPAREN
1020:54:ID partials
1020:62:DOT
1020:63:ID cdr
1020:66:RPAREN
1020:67:RBRACE
1022:22:VAR
1022:26:ID extension
1022:36:ASSIGN
1022:39:IF
1022:42:ID sexps_p
1022:49:LPAREN
1022:50:ID bindings_sexp
1022:63:RPAREN
1023:39:THEN
1023:44:ID get_env_extension
1023:61:LPAREN
1023:62:ID get_sexps
1023:71:LPAREN
1023:72:ID bindings_sexp
1023:85:RPAREN
1023:86:RPAREN
1024:39:ELSE
1024:44:LPAREN
1024:45:ID print
1024:50:LPAREN
1024:51:STRING "Bindings list in letrec expression has to be a list: '"
1024:107:RPAREN
1024:108:SEMICOLON
1025:45:ID print
1025:50:LPAREN
1025:51:ID sexp2s
1025:57:LPAREN
1025:58:ID bindings_sexp
1025:71:RPAREN
1025:72:RPAREN
1025:73:SEMICOLON
1026:45:ID print
1026:50:LPAREN
1026:51:STRING "'\n"
1026:56:RPAREN
1026:57:SEMICOLON
1027:45:NIL
1027:48:RPAREN
1028:22:VAR
1028:26:ID body_env
1028:35:ASSIGN
1028:38:ID fill_body_env
1028:51:LPAREN
1028:52:ID extension
1028:61:RPAREN
1030:22:FUNCTION
1030:31:ID complete_partials
1030:48:LPAREN
1030:49:ID partials
1030:57:COLON
1030:59:ID partials
1030:67:RPAREN
1030:69:EQ
1031:24:IF
1031:27:ID partials
1031:36:NEQ
1031:39:NIL
1032:24:THEN
1032:29:LET
1032:33:VAR
1032:37:ID value_sexp
1032:48:ASSIGN
1032:51:ID partials
1032:59:DOT
1032:60:ID car
1032:63:DOT
1032:64:ID value_sexp
1033:33:VAR
1033:37:ID placeholder_value
1033:55:ASSIGN
1033:58:ID partials
1033:66:DOT
1033:67:ID car
1033:70:DOT
1033:71:ID value
1034:33:VAR
1034:37:ID actual_value
1034:50:ASSIGN
1034:53:ID eval
1034:57:LPAREN
1034:58:ID value_sexp
1034:68:COMMA
1034:70:ID body_env
1034:78:RPAREN
1035:29:IN
1035:32:ID copy_value
1035:42:LPAREN
1035:43:ID actual_value
1035:55:COMMA
1035:57:ID placeholder_value
1035:74:RPAREN
1035:75:SEMICOLON
1036:32:ID complete_partials
1036:49:LPAREN
1036:50:ID partials
1036:58:DOT
1036:59:ID cdr
1036:62:RPAREN
1037:29:END
1038:18:IN
1038:21:ID complete_partials
1038:38:LPAREN
1038:39:ID extension
1038:48:RPAREN
1038:49:SEMICOLON
1039:21:ID eval
1039:25:LPAREN
1039:26:ID body_sexp
1039:35:COMMA
1039:37:ID body_env
1039:45:RPAREN
1040:18:END
1041:11:FUNCTION
1041:20:ID quote
1041:25:LPAREN
1041:26:ID args
1041:30:COLON
1041:32:ID sexps
1041:37:RPAREN
1041:38:COLON
1041:40:ID sexp
1041:45:EQ
1042:13:IF
1042:16:ID args
1042:21:EQ
1042:23:NIL
1042:27:OR
1042:29:LPAREN
1042:30:ID args
1042:35:NEQ
1042:38:NIL
1042:42:AND
1042:44:ID args
1042:48:DOT
1042:49:ID cdr
1042:53:NEQ
1042:56:NIL
1042:59:RPAREN
1043:13:THEN
1043:18:LPAREN
1043:19:ID print
1043:24:LPAREN
1043:25:STRING "quote needs exactly 1 argument.\n"
1043:60:RPAREN
1043:61:SEMICOLON
1044:19:NIL
1044:22:RPAREN
1045:13:ELSE
1045:18:ID args
1045:22:DOT
1045:23:ID car
1046:11:FUNCTION
1046:20:ID define
1046:26:LPAREN
1046:27:ID args
1046:31:COLON
1046:33:ID sexps
1046:38:RPAREN
1046:39:COLON
1046:41:ID sexp
1046:46:EQ
1047:13:IF
1047:16:ID args
1047:21:EQ
1047:23:NIL
1047:27:OR
1047:29:ID args
1047:33:DOT
1047:34:ID cdr
1047:38:EQ
1047:40:NIL
1047:44:OR
1047:47:LPAREN
1047:48:ID args
1047:52:DOT
1047:53:ID cdr
1047:57:NEQ
1047:60:NIL
1047:64:AND
1047:66:ID args
1047:70:DOT
1047:71:ID cdr
1047:74:DOT
1047:75:ID cdr
1047:79:NEQ
1047:82:NIL
1047:85:RPAREN
1048:13:THEN
1048:18:LPAREN
1048:19:ID print
1048:24:LPAREN
1048:25:STRING "define needs exactly 2 arguments.\n"
1048:62:RPAREN
1048:63:SEMICOLON
1049:19:NIL
1049:22:RPAREN
1050:13:ELSE
1050:18:LET
1050:22:VAR
1050:26:ID name
1050:31:ASSIGN
1050:34:ID args
1050:38:DOT
1050:39:ID car
1051:22:VAR
1051:26:ID body
1051:31:ASSIGN
1051:34:ID args
1051:38:DOT
1051:39:ID cdr
1051:42:DOT
1051:43:ID car
1052:18:IN
1052:21:IF
1052:24:ID not
1052:27:LPAREN
1052:28:ID sym_p
1052:33:LPAREN
1052:34:ID name
1052:38:RPAREN
1052:39:RPAREN
1053:21:THEN
1053:26:LPAREN
1053:27:ID print
1053:32:LPAREN
1053:33:STRING "Name in define has to be a symbol: '"
1053:71:RPAREN
1053:72:SEMICOLON
1054:27:ID print
1054:32:LPAREN
1054:33:ID sexp2s
1054:39:LPAREN
1054:40:ID name
1054:44:RPAREN
1054:45:RPAREN
1054:46:SEMICOLON
1055:27:ID print
1055:32:LPAREN
1055:33:STRING "'\n"
1055:38:RPAREN
1055:39:SEMICOLON
1056:27:NIL
1056:30:RPAREN
1057:21:ELSE
1057:26:LPAREN
1057:27:ID initial_env
1057:39:ASSIGN
1057:42:ID env
1057:46:LBRACE
1057:47:ID car
1057:51:EQ
1057:53:ID env_entry
1057:63:LBRACE
1057:64:ID key
1057:68:EQ
1057:70:ID get_sym
1057:77:LPAREN
1057:78:ID name
1057:82:RPAREN
1057:83:COMMA
1058:64:ID value
1058:70:EQ
1058:72:ID eval
1058:76:LPAREN
1058:77:ID body
1058:81:COMMA
1058:83:ID env
1058:86:RPAREN
1058:87:RBRACE
1058:88:COMMA
1059:47:ID cdr
1059:51:EQ
1059:53:ID initial_env
1059:64:RBRACE
1059:65:SEMICOLON
1060:27:ID mk_sexps
1060:35:LPAREN
1060:36:NIL
1060:39:RPAREN
1060:40:RPAREN
1061:18:END
1062:11:FUNCTION
1062:20:ID quasiquote
1062:30:LPAREN
1062:31:ID args
1062:35:COLON
1062:37:ID sexps
1062:42:RPAREN
1062:43:COLON
1062:45:ID sexp
1062:50:EQ
1063:13:LET
1063:17:FUNCTION
1063:26:ID quasi
1063:31:LPAREN
1063:32:ID args
1063:36:COLON
1063:38:ID sexps
1063:43:COMMA
1063:45:ID level
1063:50:COLON
1063:52:ID int
1063:55:RPAREN
1063:56:COLON
1063:58:ID sexp
1063:63:EQ
1064:19:IF
1064:22:ID args
1064:27:EQ
1064:29:NIL
1064:33:OR
1064:35:LPAREN
1064:36:ID args
1064:40:DOT
1064:41:ID cdr
1064:45:NEQ
1064:48:NIL
1064:52:AND
1064:54:ID args
1064:58:DOT
1064:59:ID cdr
1064:62:DOT
1064:63:ID cdr
1064:67:NEQ
1064:70:NIL
1064:73:RPAREN
1065:19:THEN
1065:24:LPAREN
1065:25:ID print
1065:30:LPAREN
1065:31:STRING "quasiquote needs exactly 1 argument.\n"
1065:71:RPAREN
1065:72:SEMICOLON
1066:25:NIL
1066:28:RPAREN
1067:19:ELSE
1067:24:IF
1067:27:ID level
1067:33:EQ
1067:35:INT 0
1068:19:THEN
1068:24:ID eval
1068:28:LPAREN
1068:29:ID args
1068:33:DOT
1068:34:ID car
1068:37:COMMA
1068:39:ID env
1068:42:RPAREN
1069:19:ELSE
1069:24:IF
1069:27:ID sexps_p
1069:34:LPAREN
1069:35:ID args
1069:39:DOT
1069:40:ID car
1069:43:RPAREN
1070:19:THEN
1070:24:LET
1070:28:VAR
1070:32:ID ss
1070:35:ASSIGN
1070:38:ID get_sexps
1070:47:LPAREN
1070:48:ID args
1070:52:DOT
1070:53:ID car
1070:56:RPAREN
1071:24:IN
1071:27:IF
1071:30:ID ss
1071:33:EQ
1071:35:NIL
1072:27:THEN
1072:32:ID args
1072:36:DOT
1072:37:ID car
1073:27:ELSE
1073:32:LET
1073:36:VAR
1073:40:ID head
1073:45:ASSIGN
1073:48:ID ss
1073:50:DOT
1073:51:ID car
1074:32:IN
1074:35:IF
1074:38:ID sym_p
1074:43:LPAREN
1074:44:ID head
1074:48:RPAREN
1074:50:AND
1074:52:ID get_sym
1074:59:LPAREN
1074:60:ID head
1074:64:RPAREN
1074:66:EQ
1074:68:STRING "unquote"
1075:35:THEN
1075:40:LET
1075:44:VAR
1075:48:ID unquote_val
1075:60:ASSIGN
1075:63:ID lookup
1075:69:LPAREN
1075:70:ID get_sym
1075:77:LPAREN
1075:78:ID head
1075:82:RPAREN
1075:83:COMMA
1075:85:ID env
1075:88:RPAREN
1076:40:IN
1076:43:IF
1076:46:ID fun_p
1076:51:LPAREN
1076:52:ID unquote_val
1076:63:RPAREN
1077:43:THEN
1077:48:LET
1077:52:VAR
1077:56:ID unquote_fun
1077:68:ASSIGN
1077:71:ID get_fun
1077:78:LPAREN
1077:79:ID unquote_val
1077:90:RPAREN
1078:48:IN
1078:51:IF
1078:54:ID unquote_fun
1078:65:DOT
1078:66:ID typ
1078:70:EQ
1078:72:STRING "internal"
1079:51:THEN
1079:56:IF
1079:59:ID level
1079:65:EQ
1079:67:INT 1
1080:56:THEN
1080:61:ID unquote
1080:68:LPAREN
1080:69:ID ss
1080:71:DOT
1080:72:ID cdr
1080:75:COMMA
1080:77:ID level
1080:82:RPAREN
1081:56:ELSE
1081:61:ID mk_sexps
1081:69:LPAREN
1081:70:ID quasi_tail
1081:80:LPAREN
1081:81:ID ss
1081:83:COMMA
1081:85:ID level
1081:91:MINUS
1081:93:INT 1
1081:94:RPAREN
1081:95:RPAREN
1082:51:ELSE
1082:56:ID mk_sexps
1082:64:LPAREN
1082:65:ID quasi_tail
1082:75:LPAREN
1082:76:ID ss
1082:78:COMMA
1082:80:ID level
1082:85:RPAREN
1082:86:RPAREN
1083:48:END
1084:43:ELSE
1084:48:ID mk_sexps
1084:56:LPAREN
1084:57:ID quasi_tail
1084:67:LPAREN
1084:68:ID ss
1084:70:COMMA
1084:72:ID level
1084:77:RPAREN
1084:78:RPAREN
1085:40:END
1086:35:ELSE
1086:40:IF
1086:43:ID sym_p
1086:48:LPAREN
1086:49:ID head
1086:53:RPAREN
1086:55:AND
1086:57:ID get_sym
1086:64:LPAREN
1086:65:ID head
1086:69:RPAREN
1086:71:EQ
1086:73:STRING "quasiquote"
1087:35:THEN
1087:40:LET
1087:44:VAR
1087:48:ID quasiquote_val
1087:63:ASSIGN
1087:66:ID lookup
1087:72:LPAREN
1087:73:ID get_sym
1087:80:LPAREN
1087:81:ID head
1087:85:RPAREN
1087:86:COMMA
1087:88:ID env
1087:91:RPAREN
1088:40:IN
1088:43:IF
1088:46:ID fun_p
1088:51:LPAREN
1088:52:ID quasiquote_val
1088:66:RPAREN
1089:43:THEN
1089:48:LET
1089:52:VAR
1089:56:ID quasiquote_fun
1089:71:ASSIGN
1089:74:ID get_fun
1089:81:LPAREN
1089:82:ID quasiquote_val
1089:96:RPAREN
1090:48:IN
1090:51:IF
1090:54:ID quasiquote_fun
1090:68:DOT
1090:69:ID typ
1090:73:EQ
1090:75:STRING "internal"
1091:51:THEN
1091:56:ID mk_sexps
1091:64:LPAREN
1091:65:ID quasi_tail
1091:75:LPAREN
1091:76:ID ss
1091:78:COMMA
1091:80:ID level
1091:86:PLUS
1091:88:INT 1
1091:89:RPAREN
1091:90:RPAREN
1092:51:ELSE
1092:56:ID mk_sexps
1092:64:LPAREN
1092:65:ID quasi_tail
1092:75:LPAREN
1092:76:ID ss
1092:78:COMMA
1092:80:ID level
1092:85:RPAREN
1092:86:RPAREN
1093:48:END
1094:43:ELSE
1094:48:ID mk_sexps
1094:56:LPAREN
1094:57:ID quasi_tail
1094:67:LPAREN
1094:68:ID ss
1094:70:COMMA
1094:72:ID level
1094:77:RPAREN
1094:78:RPAREN
1095:40:END
1096:35:ELSE
1096:40:ID mk_sexps
1096:48:LPAREN
1096:49:ID quasi_tail
1096:59:LPAREN
1096:60:ID ss
1096:62:COMMA
1096:64:ID level
1096:69:RPAREN
1096:70:RPAREN
1097:32:END
1098:24:END
1099:19:ELSE
1099:24:ID args
1099:28:DOT
1099:29:ID car
1101:17:FUNCTION
1101:26:ID unquote
1101:33:LPAREN
1101:34:ID args
1101:38:COLON
1101:40:ID sexps
1101:45:COMMA
1101:47:ID level
1101:52:COLON
1101:54:ID int
1101:57:RPAREN
1101:58:COLON
1101:60:ID sexp
1101:65:EQ
1102:19:IF
1102:22:ID args
1102:27:EQ
1102:29:NIL
1102:33:OR
1102:35:LPAREN
1102:36:ID args
1102:40:DOT
1102:41:ID cdr
1102:45:NEQ
1102:48:NIL
1102:52:AND
1102:54:ID args
1102:58:DOT
1102:59:ID cdr
1102:62:DOT
1102:63:ID cdr
1102:67:NEQ
1102:70:NIL
1102:73:RPAREN
1103:19:THEN
1103:24:LPAREN
1103:25:ID print
1103:30:LPAREN
1103:31:STRING "unquote needs exactly 1 argument.\n"
1103:68:RPAREN
1103:69:SEMICOLON
1104:25:NIL
1104:28:RPAREN
1105:19:ELSE
1105:24:ID quasi
1105:29:LPAREN
1105:30:ID args
1105:34:COMMA
1105:36:ID level
1105:42:MINUS
1105:44:INT 1
1105:45:RPAREN
1107:17:FUNCTION
1107:26:ID quasi_tail
1107:36:LPAREN
1107:37:ID args
1107:41:COLON
1107:43:ID sexps
1107:48:COMMA
1107:50:ID level
1107:55:COLON
1107:57:ID int
1107:60:RPAREN
1107:61:COLON
1107:63:ID sexps
1107:69:EQ
1108:19:IF
1108:22:ID args
1108:27:EQ
1108:29:NIL
1109:19:THEN
1109:24:NIL
1110:19:ELSE
1110:24:ID sexps
1110:30:LBRACE
1110:31:ID car
1110:35:EQ
1110:37:ID quasi
1110:42:LPAREN
1110:43:ID sexps
1110:49:LBRACE
1110:50:ID car
1110:54:EQ
1110:56:ID args
1110:60:DOT
1110:61:ID car
1110:64:COMMA
1110:66:ID cdr
1110:70:EQ
1110:72:NIL
1110:75:RBRACE
1110:76:COMMA
1110:78:ID level
1110:83:RPAREN
1110:84:COMMA
1111:31:ID cdr
1111:35:EQ
1111:37:ID quasi_tail
1111:47:LPAREN
1111:48:ID args
1111:52:DOT
1111:53:ID cdr
1111:56:COMMA
1111:58:ID level
1111:63:RPAREN
1111:64:RBRACE
1113:13:IN
1113:16:ID quasi
1113:21:LPAREN
1113:22:ID args
1113:26:COMMA
1113:28:INT 1
1113:29:RPAREN
1114:13:END
1115:11:FUNCTION
1115:20:ID unquote
1115:27:LPAREN
1115:28:ID args
1115:32:COLON
1115:34:ID sexps
1115:39:RPAREN
1115:40:COLON
1115:42:ID sexp
1115:47:EQ
1116:13:LPAREN
1116:14:ID print
1116:19:LPAREN
1116:20:STRING "Misplaced unquote around '"
1116:48:RPAREN
1116:49:SEMICOLON
1117:14:ID print
1117:19:LPAREN
1117:20:ID sexps2s
1117:27:LPAREN
1117:28:ID args
1117:32:RPAREN
1117:33:RPAREN
1117:34:SEMICOLON
1118:14:ID print
1118:19:LPAREN
1118:20:STRING "'. Unquote can only be used inside quasiquotes\n"
1118:70:RPAREN
1118:71:SEMICOLON
1119:14:ID mk_sexps
1119:22:LPAREN
1119:23:NIL
1119:26:RPAREN
1119:27:RPAREN
1120:7:IN
1120:10:IF
1120:13:ID fun_name
1120:22:EQ
1120:24:STRING "ifb"
1121:10:THEN
1121:15:ID ifb
1121:18:LPAREN
1121:19:ID args
1121:23:RPAREN
1122:10:ELSE
1122:15:IF
1122:18:ID fun_name
1122:27:EQ
1122:29:STRING "or"
1123:10:THEN
1123:15:ID or
1123:17:LPAREN
1123:18:ID args
1123:22:RPAREN
1124:10:ELSE
1124:15:IF
1124:18:ID fun_name
1124:27:EQ
1124:29:STRING "and"
1125:10:THEN
1125:15:ID and
1125:18:LPAREN
1125:19:ID args
1125:23:RPAREN
1126:10:ELSE
1126:15:IF
1126:18:ID fun_name
1126:27:EQ
1126:29:STRING "lambda"
1127:10:THEN
1127:15:ID lambda
1127:21:LPAREN
1127:22:ID args
1127:26:RPAREN
1128:10:ELSE
1128:15:IF
1128:18:ID fun_name
1128:27:EQ
1128:29:STRING "let"
1129:10:THEN
1129:15:ID let_
1129:19:LPAREN
1129:20:ID args
1129:24:RPAREN
1130:10:ELSE
1130:15:IF
1130:18:ID fun_name
1130:27:EQ
1130:29:STRING "let*"
1131:10:THEN
1131:15:ID letstar
1131:22:LPAREN
1131:23:ID args
1131:27:RPAREN
1132:10:ELSE
1132:15:IF
1132:18:ID fun_name
1132:27:EQ
1132:29:STRING "letrec"
1133:10:THEN
1133:15:ID letrec
1133:21:LPAREN
1133:22:ID args
1133:26:RPAREN
1134:10:ELSE
1134:15:IF
1134:18:ID fun_name
1134:27:EQ
1134:29:STRING "define"
1135:10:THEN
1135:15:ID define
1135:21:LPAREN
1135:22:ID args
1135:26:RPAREN
1136:10:ELSE
1136:15:IF
1136:18:ID fun_name
1136:27:EQ
1136:29:STRING "quote"
1137:10:THEN
1137:15:ID quote
1137:20:LPAREN
1137:21:ID args
1137:25:RPAREN
1138:10:ELSE
1138:15:IF
1138:18:ID fun_name
1138:27:EQ
1138:29:STRING "quasiquote"
1139:10:THEN
1139:15:ID quasiquote
1139:25:LPAREN
1139:26:ID args
1139:30:RPAREN
1140:10:ELSE
1140:15:IF
1140:18:ID fun_name
1140:27:EQ
1140:29:STRING "unquote"
1141:10:THEN
1141:15:ID unquote
1141:22:LPAREN
1141:23:ID args
1141:27:RPAREN
1142:10:ELSE
1142:15:LPAREN
1142:16:ID print
1142:21:LPAREN
1142:22:STRING "Interpreter error: Unknown internal lazy function '"
1142:75:RPAREN
1142:76:SEMICOLON
1143:16:ID print
1143:21:LPAREN
1143:22:ID fun_name
1143:30:RPAREN
1143:31:SEMICOLON
1144:16:ID print
1144:21:LPAREN
1144:22:STRING "' --- Perhaps it has not been implemented yet.\n"
1144:72:RPAREN
1144:73:SEMICOLON
1145:16:NIL
1145:19:RPAREN
1146:7:END
1148:5:FUNCTION
1148:14:ID apply_internal_cbv
1148:32:LPAREN
1148:33:ID fun_name
1148:41:COLON
1148:43:ID string
1148:49:COMMA
1148:51:ID args
1148:55:COLON
1148:57:ID sexps
1148:62:COMMA
1148:64:ID env
1148:67:COLON
1148:69:ID env
1148:72:RPAREN
1148:73:COLON
1148:75:ID sexp
1148:80:EQ
1150:7:LET
1150:11:FUNCTION
1150:20:ID plus
1150:24:LPAREN
1150:25:ID args
1150:29:COLON
1150:31:ID sexps
1150:36:RPAREN
1150:37:COLON
1150:39:ID int
1150:43:EQ
1151:13:IF
1151:16:ID args
1151:21:EQ
1151:23:NIL
1152:13:THEN
1152:18:INT 0
1153:13:ELSE
1153:18:LET
1153:22:VAR
1153:26:ID curr_arg
1153:35:ASSIGN
1153:38:ID args
1153:42:DOT
1153:43:ID car
1154:18:IN
1154:21:IF
1154:24:ID int_p
1154:29:LPAREN
1154:30:ID curr_arg
1154:38:RPAREN
1155:21:THEN
1155:26:ID get_int
1155:33:LPAREN
1155:34:ID curr_arg
1155:42:RPAREN
1155:44:PLUS
1155:46:ID plus
1155:50:LPAREN
1155:51:ID args
1155:55:DOT
1155:56:ID cdr
1155:59:RPAREN
1156:21:ELSE
1156:26:LPAREN
1156:27:ID print
1156:32:LPAREN
1156:33:STRING "Illegal argument to + (or tail of -), value: '"
1156:81:RPAREN
1156:82:SEMICOLON
1157:27:ID print
1157:32:LPAREN
1157:33:ID sexp2s
1157:39:LPAREN
1157:40:ID curr_arg
1157:48:RPAREN
1157:49:RPAREN
1157:50:SEMICOLON
1158:27:ID print
1158:32:LPAREN
1158:33:STRING "'\n"
1158:38:RPAREN
1158:39:SEMICOLON
1159:27:INT 0
1159:28:RPAREN
1160:18:END
1161:11:FUNCTION
1161:20:ID minus
1161:25:LPAREN
1161:26:ID args
1161:30:COLON
1161:32:ID sexps
1161:37:RPAREN
1161:38:COLON
1161:40:ID int
1161:44:EQ
1162:13:IF
1162:16:ID args
1162:21:EQ
1162:23:NIL
1163:13:THEN
1163:18:INT 0
1164:13:ELSE
1164:18:LET
1164:22:VAR
1164:26:ID curr_arg
1164:35:ASSIGN
1164:38:ID args
1164:42:DOT
1164:43:ID car
1165:18:IN
1165:21:IF
1165:24:ID int_p
1165:29:LPAREN
1165:30:ID curr_arg
1165:38:RPAREN
1166:21:THEN
1166:26:ID get_int
1166:33:LPAREN
1166:34:ID curr_arg
1166:42:RPAREN
1166:44:MINUS
1166:46:ID plus
1166:50:LPAREN
1166:51:ID args
1166:55:DOT
1166:56:ID cdr
1166:59:RPAREN
1167:21:ELSE
1167:26:LPAREN
1167:27:ID print
1167:32:LPAREN
1167:33:STRING "Illegal argument to -, value: '"
1167:66:RPAREN
1167:67:SEMICOLON
1168:27:ID print
1168:32:LPAREN
1168:33:ID sexp2s
1168:39:LPAREN
1168:40:ID curr_arg
1168:48:RPAREN
1168:49:RPAREN
1168:50:SEMICOLON
1169:27:ID print
1169:32:LPAREN
1169:33:STRING "'\n"
1169:38:RPAREN
1169:39:SEMICOLON
1170:27:INT 0
1170:28:RPAREN
1171:18:END
1172:11:FUNCTION
1172:20:ID times
1172:25:LPAREN
1172:26:ID args
1172:30:COLON
1172:32:ID sexps
1172:37:RPAREN
1172:38:COLON
1172:40:ID int
1172:44:EQ
1173:13:IF
1173:16:ID args
1173:21:EQ
1173:23:NIL
1174:13:THEN
1174:18:INT 1
1175:13:ELSE
1175:18:LET
1175:22:VAR
1175:26:ID curr_arg
1175:35:ASSIGN
1175:38:ID args
1175:42:DOT
1175:43:ID car
1176:18:IN
1176:21:IF
1176:24:ID int_p
1176:29:LPAREN
1176:30:ID curr_arg
1176:38:RPAREN
1177:21:THEN
1177:26:ID get_int
1177:33:LPAREN
1177:34:ID curr_arg
1177:42:RPAREN
1177:44:TIMES
1177:46:ID times
1177:51:LPAREN
1177:52:ID args
1177:56:DOT
1177:57:ID cdr
1177:60:RPAREN
1178:21:ELSE
1178:26:LPAREN
1178:27:ID print
1178:32:LPAREN
1178:33:STRING "Illegal argument to * (or tail of /), value: '"
1178:81:RPAREN
1178:82:SEMICOLON
1179:27:ID print
1179:32:LPAREN
1179:33:ID sexp2s
1179:39:LPAREN
1179:40:ID curr_arg
1179:48:RPAREN
1179:49:RPAREN
1179:50:SEMICOLON
1180:27:ID print
1180:32:LPAREN
1180:33:STRING "'\n"
1180:38:RPAREN
1180:39:SEMICOLON
1181:27:INT 0
1181:28:RPAREN
1182:18:END
1183:11:FUNCTION
1183:20:ID div
1183:23:LPAREN
1183:24:ID args
1183:28:COLON
1183:30:ID sexps
1183:35:RPAREN
1183:36:COLON
1183:38:ID int
1183:42:EQ
1184:13:IF
1184:16:ID args
1184:21:EQ
1184:23:NIL
1185:13:THEN
1185:18:LPAREN
1185:19:ID print
1185:24:LPAREN
1185:25:STRING "Cannot apply / to 0 arguments.\n"
1185:59:RPAREN
1185:60:SEMICOLON
1185:62:INT 1
1185:63:RPAREN
1186:13:ELSE
1186:18:LET
1186:22:VAR
1186:26:ID curr_arg
1186:35:ASSIGN
1186:38:ID args
1186:42:DOT
1186:43:ID car
1187:18:IN
1187:21:IF
1187:24:ID int_p
1187:29:LPAREN
1187:30:ID curr_arg
1187:38:RPAREN
1188:21:THEN
1188:26:ID get_int
1188:33:LPAREN
1188:34:ID curr_arg
1188:42:RPAREN
1188:44:DIVIDE
1188:46:ID times
1188:51:LPAREN
1188:52:ID args
1188:56:DOT
1188:57:ID cdr
1188:60:RPAREN
1189:21:ELSE
1189:26:LPAREN
1189:27:ID print
1189:32:LPAREN
1189:33:STRING "Illegal argument to /, value: '"
1189:66:RPAREN
1189:67:SEMICOLON
1190:27:ID print
1190:32:LPAREN
1190:33:ID sexp2s
1190:39:LPAREN
1190:40:ID curr_arg
1190:48:RPAREN
1190:49:RPAREN
1190:50:SEMICOLON
1191:27:ID print
1191:32:LPAREN
1191:33:STRING "'\n"
1191:38:RPAREN
1191:39:SEMICOLON
1192:27:INT 0
1192:28:RPAREN
1193:18:END
1194:11:FUNCTION
1194:20:ID expt
1194:24:LPAREN
1194:25:ID args
1194:29:COLON
1194:31:ID sexps
1194:36:RPAREN
1194:37:COLON
1194:39:ID int
1194:43:EQ
1195:13:IF
1195:16:ID args
1195:21:EQ
1195:23:NIL
1196:13:THEN
1196:18:INT 1
1197:13:ELSE
1197:18:LET
1197:22:VAR
1197:26:ID curr_arg
1197:35:ASSIGN
1197:38:ID args
1197:42:DOT
1197:43:ID car
1198:18:IN
1198:21:IF
1198:24:ID int_p
1198:29:LPAREN
1198:30:ID curr_arg
1198:38:RPAREN
1199:21:THEN
1199:26:ID get_int
1199:33:LPAREN
1199:34:ID curr_arg
1199:42:RPAREN
1199:44:CARET
1199:46:ID expt
1199:50:LPAREN
1199:51:ID args
1199:55:DOT
1199:56:ID cdr
1199:59:RPAREN
1200:21:ELSE
1200:26:LPAREN
1200:27:ID print
1200:32:LPAREN
1200:33:STRING "Illegal argument to ^, value: '"
1200:66:RPAREN
1200:67:SEMICOLON
1201:27:ID print
1201:32:LPAREN
1201:33:ID sexp2s
1201:39:LPAREN
1201:40:ID curr_arg
1201:48:RPAREN
1201:49:RPAREN
1201:50:SEMICOLON
1202:27:ID print
1202:32:LPAREN
1202:33:STRING "'\n"
1202:38:RPAREN
1202:39:SEMICOLON
1203:27:INT 0
1203:28:RPAREN
1204:18:END
1206:11:FUNCTION
1206:20:ID lt_int
1206:26:LPAREN
1206:27:ID args
1206:31:COLON
1206:33:ID sexps
1206:38:RPAREN
1206:39:COLON
1206:41:ID int
1206:45:EQ
1207:13:LET
1207:17:FUNCTION
1207:26:ID aux
1207:29:LPAREN
1207:30:ID head
1207:34:COLON
1207:36:ID int
1207:39:COMMA
1207:41:ID args
1207:45:COLON
1207:47:ID sexps
1207:52:RPAREN
1207:53:COLON
1207:55:ID int
1207:59:EQ
1208:17:IF
1208:20:ID args
1208:25:EQ
1208:27:NIL
1209:17:THEN
1209:22:INT 1
1210:17:ELSE
1210:22:LET
1210:26:VAR
1210:30:ID curr_arg
1210:39:ASSIGN
1210:42:ID args
1210:46:DOT
1210:47:ID car
1211:22:IN
1211:25:IF
1211:28:ID int_p
1211:33:LPAREN
1211:34:ID curr_arg
1211:42:RPAREN
1212:25:THEN
1212:30:ID aux
1212:33:LPAREN
1212:34:ID get_int
1212:41:LPAREN
1212:42:ID curr_arg
1212:50:RPAREN
1212:51:COMMA
1212:53:ID args
1212:57:DOT
1212:58:ID cdr
1212:61:RPAREN
1212:63:AND
1212:65:ID head
1212:70:LT
1212:72:ID get_int
1212:79:LPAREN
1212:80:ID curr_arg
1212:88:RPAREN
1213:25:ELSE
1213:30:LPAREN
1213:31:ID print
1213:36:LPAREN
1213:37:STRING "Illegal argument to <, value: '"
1213:70:RPAREN
1213:71:SEMICOLON
1214:31:ID print
1214:36:LPAREN
1214:37:ID sexp2s
1214:43:LPAREN
1214:44:ID curr_arg
1214:52:RPAREN
1214:53:RPAREN
1214:54:SEMICOLON
1215:31:ID print
1215:36:LPAREN
1215:37:STRING "'\n"
1215:42:RPAREN
1215:43:SEMICOLON
1216:31:INT 0
1216:32:RPAREN
1217:22:END
1218:13:IN
1218:16:IF
1218:19:ID args
1218:24:EQ
1218:26:NIL
1219:16:THEN
1219:21:INT 1
1220:16:ELSE
1220:21:LET
1220:25:VAR
1220:29:ID curr_arg
1220:38:ASSIGN
1220:41:ID args
1220:45:DOT
1220:46:ID car
1221:21:IN
1221:24:IF
1221:27:ID int_p
1221:32:LPAREN
1221:33:ID curr_arg
1221:41:RPAREN
1222:24:THEN
1222:29:ID aux
1222:32:LPAREN
1222:33:ID get_int
1222:40:LPAREN
1222:41:ID curr_arg
1222:49:RPAREN
1222:50:COMMA
1222:52:ID args
1222:56:DOT
1222:57:ID cdr
1222:60:RPAREN
1223:24:ELSE
1223:29:LPAREN
1223:30:ID print
1223:35:LPAREN
1223:36:STRING "Illegal argument to <, value: '"
1223:69:RPAREN
1223:70:SEMICOLON
1224:30:ID print
1224:35:LPAREN
1224:36:ID sexp2s
1224:42:LPAREN
1224:43:ID curr_arg
1224:51:RPAREN
1224:52:RPAREN
1224:53:SEMICOLON
1225:30:ID print
1225:35:LPAREN
1225:36:STRING "'\n"
1225:41:RPAREN
1225:42:SEMICOLON
1226:30:INT 0
1226:31:RPAREN
1227:21:END
1228:13:END
1229:11:FUNCTION
1229:20:ID leq_int
1229:27:LPAREN
1229:28:ID args
1229:32:COLON
1229:34:ID sexps
1229:39:RPAREN
1229:40:COLON
1229:42:ID int
1229:46:EQ
1230:13:LET
1230:17:FUNCTION
1230:26:ID aux
1230:29:LPAREN
1230:30:ID head
1230:34:COLON
1230:36:ID int
1230:39:COMMA
1230:41:ID args
1230:45:COLON
1230:47:ID sexps
1230:52:RPAREN
1230:53:COLON
1230:55:ID int
1230:59:EQ
1231:17:IF
1231:20:ID args
1231:25:EQ
1231:27:NIL
1232:17:THEN
1232:22:INT 1
1233:17:ELSE
1233:22:LET
1233:26:VAR
1233:30:ID curr_arg
1233:39:ASSIGN
1233:42:ID args
1233:46:DOT
1233:47:ID car
1234:22:IN
1234:25:IF
1234:28:ID int_p
1234:33:LPAREN
1234:34:ID curr_arg
1234:42:RPAREN
1235:25:THEN
1235:30:ID aux
1235:33:LPAREN
1235:34:ID get_int
1235:41:LPAREN
1235:42:ID curr_arg
1235:50:RPAREN
1235:51:COMMA
1235:53:ID args
1235:57:DOT
1235:58:ID cdr
1235:61:RPAREN
1235:63:AND
1235:65:ID head
1235:70:LE
1235:73:ID get_int
1235:80:LPAREN
1235:81:ID curr_arg
1235:89:RPAREN
1236:25:ELSE
1236:30:LPAREN
1236:31:ID print
1236:36:LPAREN
1236:37:STRING "Illegal argument to <=, value: '"
1236:71:RPAREN
1236:72:SEMICOLON
1237:31:ID print
1237:36:LPAREN
1237:37:ID sexp2s
1237:43:LPAREN
1237:44:ID curr_arg
1237:52:RPAREN
1237:53:RPAREN
1237:54:SEMICOLON
1238:31:ID print
1238:36:LPAREN
1238:37:STRING "'\n"
1238:42:RPAREN
1238:43:SEMICOLON
1239:31:INT 0
1239:32:RPAREN
1240:22:END
1241:13:IN
1241:16:IF
1241:19:ID args
1241:24:EQ
1241:26:NIL
1242:16:THEN
1242:21:INT 1
1243:16:ELSE
1243:21:LET
1243:25:VAR
1243:29:ID curr_arg
1243:38:ASSIGN
1243:41:ID args
1243:45:DOT
1243:46:ID car
1244:21:IN
1244:24:IF
1244:27:ID int_p
1244:32:LPAREN
1244:33:ID curr_arg
1244:41:RPAREN
1245:24:THEN
1245:29:ID aux
1245:32:LPAREN
1245:33:ID get_int
1245:40:LPAREN
1245:41:ID curr_arg
1245:49:RPAREN
1245:50:COMMA
1245:52:ID args
1245:56:DOT
1245:57:ID cdr
1245:60:RPAREN
1246:24:ELSE
1246:29:LPAREN
1246:30:ID print
1246:35:LPAREN
1246:36:STRING "Illegal argument to <=, value: '"
1246:70:RPAREN
1246:71:SEMICOLON
1247:30:ID print
1247:35:LPAREN
1247:36:ID sexp2s
1247:42:LPAREN
1247:43:ID curr_arg
1247:51:RPAREN
1247:52:RPAREN
1247:53:SEMICOLON
1248:30:ID print
1248:35:LPAREN
1248:36:STRING "'\n"
1248:41:RPAREN
1248:42:SEMICOLON
1249:30:INT 0
1249:31:RPAREN
1250:21:END
1251:13:END
1252:11:FUNCTION
1252:20:ID eq_int
1252:26:LPAREN
1252:27:ID args
1252:31:COLON
1252:33:ID sexps
1252:38:RPAREN
1252:39:COLON
1252:41:ID int
1252:45:EQ
1253:13:LET
1253:17:FUNCTION
1253:26:ID aux
1253:29:LPAREN
1253:30:ID head
1253:34:COLON
1253:36:ID int
1253:39:COMMA
1253:41:ID args
1253:45:COLON
1253:47:ID sexps
1253:52:RPAREN
1253:53:COLON
1253:55:ID int
1253:59:EQ
1254:17:IF
1254:20:ID args
1254:25:EQ
1254:27:NIL
1255:17:THEN
1255:22:INT 1
1256:17:ELSE
1256:22:LET
1256:26:VAR
1256:30:ID curr_arg
1256:39:ASSIGN
1256:42:ID args
1256:46:DOT
1256:47:ID car
1257:22:IN
1257:25:IF
1257:28:ID int_p
1257:33:LPAREN
1257:34:ID curr_arg
1257:42:RPAREN
1258:25:THEN
1258:30:ID aux
1258:33:LPAREN
1258:34:ID head
1258:38:COMMA
1258:40:ID args
1258:44:DOT
1258:45:ID cdr
1258:48:RPAREN
1258:50:AND
1258:52:ID get_int
1258:59:LPAREN
1258:60:ID curr_arg
1258:68:RPAREN
1258:70:EQ
1258:72:ID head
1259:25:ELSE
1259:30:LPAREN
1259:31:ID print
1259:36:LPAREN
1259:37:STRING "Illegal argument to =, value: '"
1259:70:RPAREN
1259:71:SEMICOLON
1260:31:ID print
1260:36:LPAREN
1260:37:ID sexp2s
1260:43:LPAREN
1260:44:ID curr_arg
1260:52:RPAREN
1260:53:RPAREN
1260:54:SEMICOLON
1261:31:ID print
1261:36:LPAREN
1261:37:STRING "'\n"
1261:42:RPAREN
1261:43:SEMICOLON
1262:31:INT 0
1262:32:RPAREN
1263:22:END
1264:13:IN
1264:16:IF
1264:19:ID args
1264:24:EQ
1264:26:NIL
1265:16:THEN
1265:21:INT 1
1266:16:ELSE
1266:21:LET
1266:25:VAR
1266:29:ID curr_arg
1266:38:ASSIGN
1266:41:ID args
1266:45:DOT
1266:46:ID car
1267:21:IN
1267:24:IF
1267:27:ID int_p
1267:32:LPAREN
1267:33:ID curr_arg
1267:41:RPAREN
1268:24:THEN
1268:29:ID aux
1268:32:LPAREN
1268:33:ID get_int
1268:40:LPAREN
1268:41:ID curr_arg
1268:49:RPAREN
1268:50:COMMA
1268:52:ID args
1268:56:DOT
1268:57:ID cdr
1268:60:RPAREN
1269:24:ELSE
1269:29:LPAREN
1269:30:ID print
1269:35:LPAREN
1269:36:STRING "Illegal argument to =, value: '"
1269:69:RPAREN
1269:70:SEMICOLON
1270:30:ID print
1270:35:LPAREN
1270:36:ID sexp2s
1270:42:LPAREN
1270:43:ID curr_arg
1270:51:RPAREN
1270:52:RPAREN
1270:53:SEMICOLON
1271:30:ID print
1271:35:LPAREN
1271:36:STRING "'\n"
1271:41:RPAREN
1271:42:SEMICOLON
1272:30:INT 0
1272:31:RPAREN
1273:21:END
1274:13:END
1275:11:FUNCTION
1275:20:ID neq_int
1275:27:LPAREN
1275:28:ID args
1275:32:COLON
1275:34:ID sexps
1275:39:RPAREN
1275:40:COLON
1275:42:ID int
1275:46:EQ
1276:13:LET
1276:17:FUNCTION
1276:26:ID aux
1276:29:LPAREN
1276:30:ID head
1276:34:COLON
1276:36:ID int
1276:39:COMMA
1276:41:ID args
1276:45:COLON
1276:47:ID sexps
1276:52:RPAREN
1276:53:COLON
1276:55:ID int
1276:59:EQ
1277:17:IF
1277:20:ID args
1277:25:EQ
1277:27:NIL
1278:17:THEN
1278:22:INT 1
1279:17:ELSE
1279:22:LET
1279:26:VAR
1279:30:ID curr_arg
1279:39:ASSIGN
1279:42:ID args
1279:46:DOT
1279:47:ID car
1280:22:IN
1280:25:IF
1280:28:ID int_p
1280:33:LPAREN
1280:34:ID curr_arg
1280:42:RPAREN
1281:25:THEN
1281:30:ID aux
1281:33:LPAREN
1281:34:ID head
1281:38:COMMA
1281:40:ID args
1281:44:DOT
1281:45:ID cdr
1281:48:RPAREN
1281:50:AND
1281:52:ID get_int
1281:59:LPAREN
1281:60:ID curr_arg
1281:68:RPAREN
1281:70:NEQ
1281:73:ID head
1282:25:ELSE
1282:30:LPAREN
1282:31:ID print
1282:36:LPAREN
1282:37:STRING "Illegal argument to !=, value: '"
1282:71:RPAREN
1282:72:SEMICOLON
1283:31:ID print
1283:36:LPAREN
1283:37:ID sexp2s
1283:43:LPAREN
1283:44:ID curr_arg
1283:52:RPAREN
1283:53:RPAREN
1283:54:SEMICOLON
1284:31:ID print
1284:36:LPAREN
1284:37:STRING "'\n"
1284:42:RPAREN
1284:43:SEMICOLON
1285:31:INT 0
1285:32:RPAREN
1286:22:END
1287:13:IN
1287:16:IF
1287:19:ID args
1287:24:EQ
1287:26:NIL
1288:16:THEN
1288:21:INT 1
1289:16:ELSE
1289:21:LET
1289:25:VAR
1289:29:ID curr_arg
1289:38:ASSIGN
1289:41:ID args
1289:45:DOT
1289:46:ID car
1290:21:IN
1290:24:IF
1290:27:ID int_p
1290:32:LPAREN
1290:33:ID curr_arg
1290:41:RPAREN
1291:24:THEN
1291:29:ID aux
1291:32:LPAREN
1291:33:ID get_int
1291:40:LPAREN
1291:41:ID curr_arg
1291:49:RPAREN
1291:50:COMMA
1291:52:ID args
1291:56:DOT
1291:57:ID cdr
1291:60:RPAREN
1292:24:ELSE
1292:29:LPAREN
1292:30:ID print
1292:35:LPAREN
1292:36:STRING "Illegal argument to !=, value: '"
1292:70:RPAREN
1292:71:SEMICOLON
1293:30:ID print
1293:35:LPAREN
1293:36:ID sexp2s
1293:42:LPAREN
1293:43:ID curr_arg
1293:51:RPAREN
1293:52:RPAREN
1293:53:SEMICOLON
1294:30:ID print
1294:35:LPAREN
1294:36:STRING "'\n"
1294:41:RPAREN
1294:42:SEMICOLON
1295:30:INT 0
1295:31:RPAREN
1296:21:END
1297:13:END
1298:11:FUNCTION
1298:20:ID geq_int
1298:27:LPAREN
1298:28:ID args
1298:32:COLON
1298:34:ID sexps
1298:39:RPAREN
1298:40:COLON
1298:42:ID int
1298:46:EQ
1299:13:LET
1299:17:FUNCTION
1299:26:ID aux
1299:29:LPAREN
1299:30:ID head
1299:34:COLON
1299:36:ID int
1299:39:COMMA
1299:41:ID args
1299:45:COLON
1299:47:ID sexps
1299:52:RPAREN
1299:53:COLON
1299:55:ID int
1299:59:EQ
1300:17:IF
1300:20:ID args
1300:25:EQ
1300:27:NIL
1301:17:THEN
1301:22:INT 1
1302:17:ELSE
1302:22:LET
1302:26:VAR
1302:30:ID curr_arg
1302:39:ASSIGN
1302:42:ID args
1302:46:DOT
1302:47:ID car
1303:22:IN
1303:25:IF
1303:28:ID int_p
1303:33:LPAREN
1303:34:ID curr_arg
1303:42:RPAREN
1304:25:THEN
1304:30:ID aux
1304:33:LPAREN
1304:34:ID get_int
1304:41:LPAREN
1304:42:ID curr_arg
1304:50:RPAREN
1304:51:COMMA
1304:53:ID args
1304:57:DOT
1304:58:ID cdr
1304:61:RPAREN
1304:63:AND
1304:65:ID head
1304:70:GE
1304:73:ID get_int
1304:80:LPAREN
1304:81:ID curr_arg
1304:89:RPAREN
1305:25:ELSE
1305:30:LPAREN
1305:31:ID print
1305:36:LPAREN
1305:37:STRING "Illegal argument to >=, value: '"
1305:71:RPAREN
1305:72:SEMICOLON
1306:31:ID print
1306:36:LPAREN
1306:37:ID sexp2s
1306:43:LPAREN
1306:44:ID curr_arg
1306:52:RPAREN
1306:53:RPAREN
1306:54:SEMICOLON
1307:31:ID print
1307:36:LPAREN
1307:37:STRING "'\n"
1307:42:RPAREN
1307:43:SEMICOLON
1308:31:INT 0
1308:32:RPAREN
1309:22:END
1310:13:IN
1310:16:IF
1310:19:ID args
1310:24:EQ
1310:26:NIL
1311:16:THEN
1311:21:INT 1
1312:16:ELSE
1312:21:LET
1312:25:VAR
1312:29:ID curr_arg
1312:38:ASSIGN
1312:41:ID args
1312:45:DOT
1312:46:ID car
1313:21:IN
1313:24:IF
1313:27:ID int_p
1313:32:LPAREN
1313:33:ID curr_arg
1313:41:RPAREN
1314:24:THEN
1314:29:ID aux
1314:32:LPAREN
1314:33:ID get_int
1314:40:LPAREN
1314:41:ID curr_arg
1314:49:RPAREN
1314:50:COMMA
1314:52:ID args
1314:56:DOT
1314:57:ID cdr
1314:60:RPAREN
1315:24:ELSE
1315:29:LPAREN
1315:30:ID print
1315:35:LPAREN
1315:36:STRING "Illegal argument to >=, value: '"
1315:70:RPAREN
1315:71:SEMICOLON
1316:30:ID print
1316:35:LPAREN
1316:36:ID sexp2s
1316:42:LPAREN
1316:43:ID curr_arg
1316:51:RPAREN
1316:52:RPAREN
1316:53:SEMICOLON
1317:30:ID print
1317:35:LPAREN
1317:36:STRING "'\n"
1317:41:RPAREN
1317:42:SEMICOLON
1318:30:INT 0
1318:31:RPAREN
1319:21:END
1320:13:END
1321:11:FUNCTION
1321:20:ID gt_int
1321:26:LPAREN
1321:27:ID args
1321:31:COLON
1321:33:ID sexps
1321:38:RPAREN
1321:39:COLON
1321:41:ID int
1321:45:EQ
1322:13:LET
1322:17:FUNCTION
1322:26:ID aux
1322:29:LPAREN
1322:30:ID head
1322:34:COLON
1322:36:ID int
1322:39:COMMA
1322:41:ID args
1322:45:COLON
1322:47:ID sexps
1322:52:RPAREN
1322:53:COLON
1322:55:ID int
1322:59:EQ
1323:17:IF
1323:20:ID args
1323:25:EQ
1323:27:NIL
1324:17:THEN
1324:22:INT 1
1325:17:ELSE
1325:22:LET
1325:26:VAR
1325:30:ID curr_arg
1325:39:ASSIGN
1325:42:ID args
1325:46:DOT
1325:47:ID car
1326:22:IN
1326:25:IF
1326:28:ID int_p
1326:33:LPAREN
1326:34:ID curr_arg
1326:42:RPAREN
1327:25:THEN
1327:30:ID aux
1327:33:LPAREN
1327:34:ID get_int
1327:41:LPAREN
1327:42:ID curr_arg
1327:50:RPAREN
1327:51:COMMA
1327:53:ID args
1327:57:DOT
1327:58:ID cdr
1327:61:RPAREN
1327:63:AND
1327:65:ID head
1327:70:GT
1327:72:ID get_int
1327:79:LPAREN
1327:80:ID curr_arg
1327:88:RPAREN
1328:25:ELSE
1328:30:LPAREN
1328:31:ID print
1328:36:LPAREN
1328:37:STRING "Illegal argument to >, value: '"
1328:70:RPAREN
1328:71:SEMICOLON
1329:31:ID print
1329:36:LPAREN
1329:37:ID sexp2s
1329:43:LPAREN
1329:44:ID curr_arg
1329:52:RPAREN
1329:53:RPAREN
1329:54:SEMICOLON
1330:31:ID print
1330:36:LPAREN
1330:37:STRING "'\n"
1330:42:RPAREN
1330:43:SEMICOLON
1331:31:INT 0
1331:32:RPAREN
1332:22:END
1333:13:IN
1333:16:IF
1333:19:ID args
1333:24:EQ
1333:26:NIL
1334:16:THEN
1334:21:INT 1
1335:16:ELSE
1335:21:LET
1335:25:VAR
1335:29:ID curr_arg
1335:38:ASSIGN
1335:41:ID args
1335:45:DOT
1335:46:ID car
1336:21:IN
1336:24:IF
1336:27:ID int_p
1336:32:LPAREN
1336:33:ID curr_arg
1336:41:RPAREN
1337:24:THEN
1337:29:ID aux
1337:32:LPAREN
1337:33:ID get_int
1337:40:LPAREN
1337:41:ID curr_arg
1337:49:RPAREN
1337:50:COMMA
1337:52:ID args
1337:56:DOT
1337:57:ID cdr
1337:60:RPAREN
1338:24:ELSE
1338:29:LPAREN
1338:30:ID print
1338:35:LPAREN
1338:36:STRING "Illegal argument to >, value: '"
1338:69:RPAREN
1338:70:SEMICOLON
1339:30:ID print
1339:35:LPAREN
1339:36:ID sexp2s
1339:42:LPAREN
1339:43:ID curr_arg
1339:51:RPAREN
1339:52:RPAREN
1339:53:SEMICOLON
1340:30:ID print
1340:35:LPAREN
1340:36:STRING "'\n"
1340:41:RPAREN
1340:42:SEMICOLON
1341:30:INT 0
1341:31:RPAREN
1342:21:END
1343:13:END
1344:11:FUNCTION
1344:20:ID min
1344:23:LPAREN
1344:24:ID args
1344:28:COLON
1344:30:ID sexps
1344:35:RPAREN
1344:36:COLON
1344:38:ID int
1344:42:EQ
1345:13:IF
1345:16:ID args
1345:21:EQ
1345:23:NIL
1346:13:THEN
1346:18:LPAREN
1346:19:ID print
1346:24:LPAREN
1346:25:STRING "Cannot apply min to 0 arguments\n"
1346:60:RPAREN
1346:61:SEMICOLON
1347:19:INT 0
1347:20:RPAREN
1348:13:ELSE
1348:18:LET
1348:22:VAR
1348:26:ID curr_arg
1348:35:ASSIGN
1348:38:ID args
1348:42:DOT
1348:43:ID car
1349:18:IN
1349:21:IF
1349:24:ID int_p
1349:29:LPAREN
1349:30:ID curr_arg
1349:38:RPAREN
1350:21:THEN
1350:26:IF
1350:29:ID args
1350:33:DOT
1350:34:ID cdr
1350:38:NEQ
1350:41:NIL
1351:26:THEN
1351:31:LET
1351:35:VAR
1351:39:ID min_rst
1351:47:ASSIGN
1351:50:ID min
1351:53:LPAREN
1351:54:ID args
1351:58:DOT
1351:59:ID cdr
1351:62:RPAREN
1352:31:IN
1352:34:IF
1352:37:ID get_int
1352:44:LPAREN
1352:45:ID curr_arg
1352:53:RPAREN
1352:55:LT
1352:57:ID min_rst
1353:34:THEN
1353:39:ID get_int
1353:46:LPAREN
1353:47:ID curr_arg
1353:55:RPAREN
1354:34:ELSE
1354:39:ID min_rst
1355:31:END
1356:26:ELSE
1356:31:ID get_int
1356:38:LPAREN
1356:39:ID curr_arg
1356:47:RPAREN
1357:21:ELSE
1357:26:LPAREN
1357:27:ID print
1357:32:LPAREN
1357:33:STRING "Illegal argument to min, value: '"
1357:68:RPAREN
1357:69:SEMICOLON
1358:27:ID print
1358:32:LPAREN
1358:33:ID sexp2s
1358:39:LPAREN
1358:40:ID curr_arg
1358:48:RPAREN
1358:49:RPAREN
1358:50:SEMICOLON
1359:27:ID print
1359:32:LPAREN
1359:33:STRING "'\n"
1359:38:RPAREN
1359:39:SEMICOLON
1360:27:INT 0
1360:28:RPAREN
1361:18:END
1362:11:FUNCTION
1362:20:ID max
1362:23:LPAREN
1362:24:ID args
1362:28:COLON
1362:30:ID sexps
1362:35:RPAREN
1362:36:COLON
1362:38:ID int
1362:42:EQ
1363:13:IF
1363:16:ID args
1363:21:EQ
1363:23:NIL
1364:13:THEN
1364:18:LPAREN
1364:19:ID print
1364:24:LPAREN
1364:25:STRING "Cannot apply max to 0 arguments\n"
1364:60:RPAREN
1364:61:SEMICOLON
1365:19:INT 0
1365:20:RPAREN
1366:13:ELSE
1366:18:LET
1366:22:VAR
1366:26:ID curr_arg
1366:35:ASSIGN
1366:38:ID args
1366:42:DOT
1366:43:ID car
1367:18:IN
1367:21:IF
1367:24:ID int_p
1367:29:LPAREN
1367:30:ID curr_arg
1367:38:RPAREN
1368:21:THEN
1368:26:IF
1368:29:ID args
1368:33:DOT
1368:34:ID cdr
1368:38:NEQ
1368:41:NIL
1369:26:THEN
1369:31:LET
1369:35:VAR
1369:39:ID max_rst
1369:47:ASSIGN
1369:50:ID max
1369:53:LPAREN
1369:54:ID args
1369:58:DOT
1369:59:ID cdr
1369:62:RPAREN
1370:31:IN
1370:34:IF
1370:37:ID get_int
1370:44:LPAREN
1370:45:ID curr_arg
1370:53:RPAREN
1370:55:GT
1370:57:ID max_rst
1371:34:THEN
1371:39:ID get_int
1371:46:LPAREN
1371:47:ID curr_arg
1371:55:RPAREN
1372:34:ELSE
1372:39:ID max_rst
1373:31:END
1374:26:ELSE
1374:31:ID get_int
1374:38:LPAREN
1374:39:ID curr_arg
1374:47:RPAREN
1375:21:ELSE
1375:26:LPAREN
1375:27:ID print
1375:32:LPAREN
1375:33:STRING "Illegal argument to min, value: '"
1375:68:RPAREN
1375:69:SEMICOLON
1376:27:ID print
1376:32:LPAREN
1376:33:ID sexp2s
1376:39:LPAREN
1376:40:ID curr_arg
1376:48:RPAREN
1376:49:RPAREN
1376:50:SEMICOLON
1377:27:ID print
1377:32:LPAREN
1377:33:STRING "'\n"
1377:38:RPAREN
1377:39:SEMICOLON
1378:27:INT 0
1378:28:RPAREN
1379:18:END
1380:11:FUNCTION
1380:20:ID progn
1380:25:LPAREN
1380:26:ID args
1380:30:COLON
1380:32:ID sexps
1380:37:RPAREN
1380:38:COLON
1380:40:ID sexp
1380:45:EQ
1381:13:IF
1381:16:ID args
1381:21:EQ
1381:23:NIL
1382:13:THEN
1382:18:LPAREN
1382:19:ID print
1382:24:LPAREN
1382:25:STRING "Cannot apply progn to 0 arguments.\n"
1382:63:RPAREN
1382:64:SEMICOLON
1383:19:NIL
1383:22:RPAREN
1384:13:ELSE
1384:18:LET
1384:22:VAR
1384:26:ID curr_arg
1384:35:ASSIGN
1384:38:ID args
1384:42:DOT
1384:43:ID car
1385:18:IN
1385:21:IF
1385:24:ID args
1385:28:DOT
1385:29:ID cdr
1385:33:EQ
1385:35:NIL
1386:21:THEN
1386:26:ID curr_arg
1387:21:ELSE
1387:26:ID progn
1387:31:LPAREN
1387:32:ID args
1387:36:DOT
1387:37:ID cdr
1387:40:RPAREN
1388:18:END
1389:11:FUNCTION
1389:20:ID map
1389:23:LPAREN
1389:24:ID args
1389:28:COLON
1389:30:ID sexps
1389:35:RPAREN
1389:36:COLON
1389:38:ID sexps
1389:44:EQ
1390:13:IF
1390:16:ID args
1390:21:EQ
1390:23:NIL
1390:27:OR
1390:29:LPAREN
1390:30:ID args
1390:34:DOT
1390:35:ID cdr
1390:39:NEQ
1390:42:NIL
1390:46:AND
1390:48:ID args
1390:52:DOT
1390:53:ID cdr
1390:56:DOT
1390:57:ID cdr
1390:61:NEQ
1390:64:NIL
1390:67:RPAREN
1391:13:THEN
1391:18:LPAREN
1391:19:ID print
1391:24:LPAREN
1391:25:STRING "map needs exactly 2 arguments.\n"
1391:59:RPAREN
1391:60:SEMICOLON
1392:19:NIL
1392:22:RPAREN
1393:13:ELSE
1393:18:LET
1393:22:VAR
1393:26:ID fun_arg
1393:34:ASSIGN
1393:37:ID args
1393:41:DOT
1393:42:ID car
1394:22:VAR
1394:26:ID lst_arg
1394:34:ASSIGN
1394:37:ID args
1394:41:DOT
1394:42:ID cdr
1394:45:DOT
1394:46:ID car
1395:22:FUNCTION
1395:31:ID aux
1395:35:LPAREN
1395:36:ID args
1395:40:COLON
1395:42:ID sexps
1395:47:RPAREN
1395:48:COLON
1395:50:ID sexps
1395:56:EQ
1396:24:IF
1396:27:ID args
1396:32:EQ
1396:34:NIL
1397:24:THEN
1397:29:NIL
1398:24:ELSE
1398:29:ID sexps
1398:35:LBRACE
1398:36:ID car
1398:40:EQ
1398:42:ID apply_fun_cbv
1398:55:LPAREN
1398:56:ID get_fun
1398:63:LPAREN
1398:64:ID fun_arg
1398:71:RPAREN
1398:72:COMMA
1399:56:ID sexps
1399:62:LBRACE
1399:63:ID car
1399:67:EQ
1399:69:ID args
1399:73:DOT
1399:74:ID car
1399:77:COMMA
1400:63:ID cdr
1400:67:EQ
1400:69:NIL
1400:72:RBRACE
1400:73:COMMA
1401:57:ID env
1401:60:RPAREN
1401:61:COMMA
1402:36:ID cdr
1402:40:EQ
1402:42:ID aux
1402:45:LPAREN
1402:46:ID args
1402:50:DOT
1402:51:ID cdr
1402:54:RPAREN
1402:55:RBRACE
1403:18:IN
1403:21:IF
1403:24:ID fun_p
1403:29:LPAREN
1403:30:ID fun_arg
1403:37:RPAREN
1404:21:THEN
1404:26:IF
1404:29:ID sexps_p
1404:36:LPAREN
1404:37:ID lst_arg
1404:44:RPAREN
1405:26:THEN
1405:31:ID aux
1405:34:LPAREN
1405:35:ID get_sexps
1405:44:LPAREN
1405:45:ID lst_arg
1405:52:RPAREN
1405:53:RPAREN
1406:26:ELSE
1406:31:LPAREN
1406:32:ID print
1406:37:LPAREN
1406:38:STRING "Illegal list argument to map, value: '"
1406:78:RPAREN
1406:79:SEMICOLON
1407:32:ID print
1407:37:LPAREN
1407:38:ID sexp2s
1407:44:LPAREN
1407:45:ID lst_arg
1407:52:RPAREN
1407:53:RPAREN
1407:54:SEMICOLON
1408:32:ID print
1408:37:LPAREN
1408:38:STRING "'\n"
1408:43:RPAREN
1408:44:SEMICOLON
1409:32:NIL
1409:35:RPAREN
1410:21:ELSE
1410:26:LPAREN
1410:27:ID print
1410:32:LPAREN
1410:33:STRING "Illegal function argument to map, value: '"
1410:77:RPAREN
1410:78:SEMICOLON
1411:27:ID print
1411:32:LPAREN
1411:33:ID sexp2s
1411:39:LPAREN
1411:40:ID fun_arg
1411:47:RPAREN
1411:48:RPAREN
1411:49:SEMICOLON
1412:27:ID print
1412:32:LPAREN
1412:33:STRING "'\n"
1412:38:RPAREN
1412:39:SEMICOLON
1413:27:NIL
1413:30:RPAREN
1414:18:END
1415:11:FUNCTION
1415:20:ID foldr
1415:25:LPAREN
1415:26:ID args
1415:30:COLON
1415:32:ID sexps
1415:37:RPAREN
1415:38:COLON
1415:40:ID sexp
1415:45:EQ
1416:13:IF
1416:16:ID args
1416:21:EQ
1416:23:NIL
1416:27:OR
1416:29:ID args
1416:33:DOT
1416:34:ID cdr
1416:38:EQ
1416:40:NIL
1416:44:OR
1416:46:LPAREN
1416:47:ID args
1416:51:DOT
1416:52:ID cdr
1416:55:DOT
1416:56:ID cdr
1416:60:NEQ
1416:63:NIL
1416:67:AND
1416:69:ID args
1416:73:DOT
1416:74:ID cdr
1416:77:DOT
1416:78:ID cdr
1416:81:DOT
1416:82:ID cdr
1416:86:NEQ
1416:89:NIL
1416:92:RPAREN
1417:13:THEN
1417:18:LPAREN
1417:19:ID print
1417:24:LPAREN
1417:25:STRING "foldr needs exactly 3 arguments.\n"
1417:61:RPAREN
1417:62:SEMICOLON
1418:19:NIL
1418:22:RPAREN
1419:13:ELSE
1419:18:LET
1419:22:VAR
1419:26:ID fun_arg
1419:34:ASSIGN
1419:37:ID args
1419:41:DOT
1419:42:ID car
1420:22:VAR
1420:26:ID init_arg
1420:35:ASSIGN
1420:38:ID args
1420:42:DOT
1420:43:ID cdr
1420:46:DOT
1420:47:ID car
1421:22:VAR
1421:26:ID lst_arg
1421:34:ASSIGN
1421:37:ID args
1421:41:DOT
1421:42:ID cdr
1421:45:DOT
1421:46:ID cdr
1421:49:DOT
1421:50:ID car
1422:22:FUNCTION
1422:31:ID aux
1422:34:LPAREN
1422:35:ID lst
1422:38:COLON
1422:40:ID sexps
1422:45:RPAREN
1422:46:COLON
1422:48:ID sexp
1422:53:EQ
1423:24:IF
1423:27:ID lst
1423:31:EQ
1423:33:NIL
1424:24:THEN
1424:29:ID init_arg
1425:24:ELSE
1425:29:ID apply_fun_cbv
1425:42:LPAREN
1425:43:ID get_fun
1425:50:LPAREN
1425:51:ID fun_arg
1425:58:RPAREN
1425:59:COMMA
1426:43:ID sexps
1426:49:LBRACE
1426:50:ID car
1426:54:EQ
1426:56:ID lst
1426:59:DOT
1426:60:ID car
1426:63:COMMA
1427:50:ID cdr
1427:54:EQ
1427:56:ID sexps
1427:62:LBRACE
1427:63:ID car
1427:67:EQ
1427:69:ID aux
1427:72:LPAREN
1427:73:ID lst
1427:76:DOT
1427:77:ID cdr
1427:80:RPAREN
1427:81:COMMA
1428:63:ID cdr
1428:67:EQ
1428:69:NIL
1428:72:RBRACE
1428:73:RBRACE
1428:74:COMMA
1429:43:ID env
1429:46:RPAREN
1431:18:IN
1431:21:IF
1431:24:ID fun_p
1431:29:LPAREN
1431:30:ID fun_arg
1431:37:RPAREN
1432:21:THEN
1432:26:IF
1432:29:ID sexps_p
1432:36:LPAREN
1432:37:ID lst_arg
1432:44:RPAREN
1433:26:THEN
1433:31:ID aux
1433:34:LPAREN
1433:35:ID get_sexps
1433:44:LPAREN
1433:45:ID lst_arg
1433:52:RPAREN
1433:53:RPAREN
1434:26:ELSE
1434:31:LPAREN
1434:32:ID print
1434:37:LPAREN
1434:38:STRING "Illegal list argument to foldr, value: '"
1434:80:RPAREN
1434:81:SEMICOLON
1435:32:ID print
1435:37:LPAREN
1435:38:ID sexp2s
1435:44:LPAREN
1435:45:ID lst_arg
1435:52:RPAREN
1435:53:RPAREN
1435:54:SEMICOLON
1436:32:ID print
1436:37:LPAREN
1436:38:STRING "'\n"
1436:43:RPAREN
1436:44:SEMICOLON
1437:32:NIL
1437:35:RPAREN
1438:21:ELSE
1438:26:LPAREN
1438:27:ID print
1438:32:LPAREN
1438:33:STRING "Illegal function argument to foldr, value: '"
1438:79:RPAREN
1438:80:SEMICOLON
1439:27:ID print
1439:32:LPAREN
1439:33:ID sexp2s
1439:39:LPAREN
1439:40:ID fun_arg
1439:47:RPAREN
1439:48:RPAREN
1439:49:SEMICOLON
1440:27:ID print
1440:32:LPAREN
1440:33:STRING "'\n"
1440:38:RPAREN
1440:39:SEMICOLON
1441:27:NIL
1441:30:RPAREN
1442:18:END
1443:11:FUNCTION
1443:20:ID foldl
1443:25:LPAREN
1443:26:ID args
1443:30:COLON
1443:32:ID sexps
1443:37:RPAREN
1443:38:COLON
1443:40:ID sexp
1443:45:EQ
1444:13:IF
1444:16:ID args
1444:21:EQ
1444:23:NIL
1444:27:OR
1444:29:ID args
1444:33:DOT
1444:34:ID cdr
1444:38:EQ
1444:40:NIL
1444:44:OR
1444:46:LPAREN
1444:47:ID args
1444:51:DOT
1444:52:ID cdr
1444:55:DOT
1444:56:ID cdr
1444:60:NEQ
1444:63:NIL
1444:67:AND
1444:69:ID args
1444:73:DOT
1444:74:ID cdr
1444:77:DOT
1444:78:ID cdr
1444:81:DOT
1444:82:ID cdr
1444:86:NEQ
1444:89:NIL
1444:92:RPAREN
1445:13:THEN
1445:18:LPAREN
1445:19:ID print
1445:24:LPAREN
1445:25:STRING "foldl needs exactly 3 arguments.\n"
1445:61:RPAREN
1445:62:SEMICOLON
1446:19:NIL
1446:22:RPAREN
1447:13:ELSE
1447:18:LET
1447:22:VAR
1447:26:ID fun_arg
1447:34:ASSIGN
1447:37:ID args
1447:41:DOT
1447:42:ID car
1448:22:VAR
1448:26:ID init_arg
1448:35:ASSIGN
1448:38:ID args
1448:42:DOT
1448:43:ID cdr
1448:46:DOT
1448:47:ID car
1449:22:VAR
1449:26:ID lst_arg
1449:34:ASSIGN
1449:37:ID args
1449:41:DOT
1449:42:ID cdr
1449:45:DOT
1449:46:ID cdr
1449:49:DOT
1449:50:ID car
1450:22:FUNCTION
1450:31:ID aux
1450:34:LPAREN
1450:35:ID lst
1450:38:COLON
1450:40:ID sexps
1450:45:COMMA
1450:47:ID acc
1450:50:COLON
1450:52:ID sexp
1450:56:RPAREN
1450:57:COLON
1450:59:ID sexp
1450:64:EQ
1451:24:IF
1451:27:ID lst
1451:31:EQ
1451:33:NIL
1452:24:THEN
1452:29:ID acc
1453:24:ELSE
1453:29:ID aux
1453:32:LPAREN
1453:33:ID lst
1453:36:DOT
1453:37:ID cdr
1453:40:COMMA
1453:42:ID apply_fun_cbv
1453:55:LPAREN
1453:56:ID get_fun
1453:63:LPAREN
1453:64:ID fun_arg
1453:71:RPAREN
1453:72:COMMA
1454:56:ID sexps
1454:62:LBRACE
1454:63:ID car
1454:67:EQ
1454:69:ID lst
1454:72:DOT
1454:73:ID car
1454:76:COMMA
1455:63:ID cdr
1455:67:EQ
1455:69:ID sexps
1455:75:LBRACE
1455:76:ID car
1455:80:EQ
1455:82:ID acc
1455:85:COMMA
1456:76:ID cdr
1456:80:EQ
1456:82:NIL
1456:85:RBRACE
1456:86:RBRACE
1456:87:COMMA
1457:56:ID env
1457:59:RPAREN
1457:60:RPAREN
1459:18:IN
1459:21:IF
1459:24:ID fun_p
1459:29:LPAREN
1459:30:ID fun_arg
1459:37:RPAREN
1460:21:THEN
1460:26:IF
1460:29:ID sexps_p
1460:36:LPAREN
1460:37:ID lst_arg
1460:44:RPAREN
1461:26:THEN
1461:31:ID aux
1461:34:LPAREN
1461:35:ID get_sexps
1461:44:LPAREN
1461:45:ID lst_arg
1461:52:RPAREN
1461:53:COMMA
1461:55:ID init_arg
1461:63:RPAREN
1462:26:ELSE
1462:31:LPAREN
1462:32:ID print
1462:37:LPAREN
1462:38:STRING "Illegal list argument to foldl, value: '"
1462:80:RPAREN
1462:81:SEMICOLON
1463:32:ID print
1463:37:LPAREN
1463:38:ID sexp2s
1463:44:LPAREN
1463:45:ID lst_arg
1463:52:RPAREN
1463:53:RPAREN
1463:54:SEMICOLON
1464:32:ID print
1464:37:LPAREN
1464:38:STRING "'\n"
1464:43:RPAREN
1464:44:SEMICOLON
1465:32:NIL
1465:35:RPAREN
1466:21:ELSE
1466:26:LPAREN
1466:27:ID print
1466:32:LPAREN
1466:33:STRING "Illegal function argument to foldl, value: '"
1466:79:RPAREN
1466:80:SEMICOLON
1467:27:ID print
1467:32:LPAREN
1467:33:ID sexp2s
1467:39:LPAREN
1467:40:ID fun_arg
1467:47:RPAREN
1467:48:RPAREN
1467:49:SEMICOLON
1468:27:ID print
1468:32:LPAREN
1468:33:STRING "'\n"
1468:38:RPAREN
1468:39:SEMICOLON
1469:27:NIL
1469:30:RPAREN
1470:18:END
1472:11:FUNCTION
1472:20:ID orb
1472:23:LPAREN
1472:24:ID args
1472:28:COLON
1472:30:ID sexps
1472:35:RPAREN
1472:36:COLON
1472:38:ID int
1472:42:EQ
1473:13:IF
1473:16:ID args
1473:21:EQ
1473:23:NIL
1474:13:THEN
1474:18:INT 0
1475:13:ELSE
1475:18:LET
1475:22:VAR
1475:26:ID curr_arg
1475:35:ASSIGN
1475:38:ID args
1475:42:DOT
1475:43:ID car
1476:18:IN
1476:21:IF
1476:24:ID bool_p
1476:30:LPAREN
1476:31:ID curr_arg
1476:39:RPAREN
1479:21:THEN
1479:26:ID orb
1479:29:LPAREN
1479:30:ID args
1479:34:DOT
1479:35:ID cdr
1479:38:RPAREN
1479:40:OR
1479:42:ID get_bool
1479:50:LPAREN
1479:51:ID curr_arg
1479:59:RPAREN
1480:21:ELSE
1480:26:LPAREN
1480:27:ID print
1480:32:LPAREN
1480:33:STRING "Illegal argument to orb, value: '"
1480:68:RPAREN
1480:69:SEMICOLON
1481:27:ID print
1481:32:LPAREN
1481:33:ID sexp2s
1481:39:LPAREN
1481:40:ID curr_arg
1481:48:RPAREN
1481:49:RPAREN
1481:50:SEMICOLON
1482:27:ID print
1482:32:LPAREN
1482:33:STRING "'\n"
1482:38:RPAREN
1482:39:SEMICOLON
1483:27:INT 0
1483:28:RPAREN
1484:18:END
1485:11:FUNCTION
1485:20:ID andb
1485:24:LPAREN
1485:25:ID args
1485:29:COLON
1485:31:ID sexps
1485:36:RPAREN
1485:37:COLON
1485:39:ID int
1485:43:EQ
1486:13:IF
1486:16:ID args
1486:21:EQ
1486:23:NIL
1487:13:THEN
1487:18:INT 1
1488:13:ELSE
1488:18:LET
1488:22:VAR
1488:26:ID curr_arg
1488:35:ASSIGN
1488:38:ID args
1488:42:DOT
1488:43:ID car
1489:18:IN
1489:21:IF
1489:24:ID bool_p
1489:30:LPAREN
1489:31:ID curr_arg
1489:39:RPAREN
1492:21:THEN
1492:26:ID andb
1492:30:LPAREN
1492:31:ID args
1492:35:DOT
1492:36:ID cdr
1492:39:RPAREN
1492:41:AND
1492:43:ID get_bool
1492:51:LPAREN
1492:52:ID curr_arg
1492:60:RPAREN
1493:21:ELSE
1493:26:LPAREN
1493:27:ID print
1493:32:LPAREN
1493:33:STRING "Illegal argument to andb, value: '"
1493:69:RPAREN
1493:70:SEMICOLON
1494:27:ID print
1494:32:LPAREN
1494:33:ID sexp2s
1494:39:LPAREN
1494:40:ID curr_arg
1494:48:RPAREN
1494:49:RPAREN
1494:50:SEMICOLON
1495:27:ID print
1495:32:LPAREN
1495:33:STRING "'\n"
1495:38:RPAREN
1495:39:SEMICOLON
1496:27:INT 0
1496:28:RPAREN
1497:18:END
1498:11:FUNCTION
1498:20:ID notb
1498:24:LPAREN
1498:25:ID args
1498:29:COLON
1498:31:ID sexps
1498:36:RPAREN
1498:37:COLON
1498:39:ID int
1498:43:EQ
1499:13:IF
1499:16:ID args
1499:21:EQ
1499:23:NIL
1500:13:THEN
1500:18:LPAREN
1500:19:ID print
1500:24:LPAREN
1500:25:STRING "Cannot apply notb to 0 arguments.\n"
1500:62:RPAREN
1500:63:SEMICOLON
1501:19:INT 0
1501:20:RPAREN
1502:13:ELSE
1502:18:LET
1502:22:VAR
1502:26:ID curr_arg
1502:35:ASSIGN
1502:38:ID args
1502:42:DOT
1502:43:ID car
1503:18:IN
1503:21:IF
1503:24:ID bool_p
1503:30:LPAREN
1503:31:ID curr_arg
1503:39:RPAREN
1503:41:AND
1503:43:ID args
1503:47:DOT
1503:48:ID cdr
1503:52:EQ
1503:54:NIL
1506:21:THEN
1506:26:ID not
1506:29:LPAREN
1506:30:ID get_bool
1506:38:LPAREN
1506:39:ID curr_arg
1506:47:RPAREN
1506:48:RPAREN
1507:21:ELSE
1507:26:IF
1507:29:ID bool_p
1507:35:LPAREN
1507:36:ID curr_arg
1507:44:RPAREN
1508:21:THEN
1508:26:LPAREN
1508:27:ID print
1508:32:LPAREN
1508:33:STRING "Illegal argument to notb, value: '"
1508:69:RPAREN
1508:70:SEMICOLON
1509:27:ID print
1509:32:LPAREN
1509:33:ID sexp2s
1509:39:LPAREN
1509:40:ID curr_arg
1509:48:RPAREN
1509:49:RPAREN
1509:50:SEMICOLON
1510:27:ID print
1510:32:LPAREN
1510:33:STRING "'\n"
1510:38:RPAREN
1510:39:SEMICOLON
1511:27:INT 0
1511:28:RPAREN
1512:21:ELSE
1512:26:LPAREN
1512:27:ID print
1512:32:LPAREN
1512:33:STRING "Cannot apply notb to more than 1 argument.\n"
1512:79:RPAREN
1512:80:SEMICOLON
1513:27:INT 0
1513:28:RPAREN
1514:18:END
1515:11:FUNCTION
1515:20:ID lt_str
1515:26:LPAREN
1515:27:ID args
1515:31:COLON
1515:33:ID sexps
1515:38:RPAREN
1515:39:COLON
1515:41:ID int
1515:45:EQ
1516:13:LET
1516:17:FUNCTION
1516:26:ID aux
1516:29:LPAREN
1516:30:ID head
1516:34:COLON
1516:36:ID string
1516:42:COMMA
1516:44:ID args
1516:48:COLON
1516:50:ID sexps
1516:55:RPAREN
1516:56:COLON
1516:58:ID int
1516:62:EQ
1517:17:IF
1517:20:ID args
1517:25:EQ
1517:27:NIL
1518:17:THEN
1518:22:INT 1
1519:17:ELSE
1519:22:LET
1519:26:VAR
1519:30:ID curr_arg
1519:39:ASSIGN
1519:42:ID args
1519:46:DOT
1519:47:ID car
1520:22:IN
1520:25:IF
1520:28:ID str_p
1520:33:LPAREN
1520:34:ID curr_arg
1520:42:RPAREN
1521:25:THEN
1521:30:ID aux
1521:33:LPAREN
1521:34:ID get_str
1521:41:LPAREN
1521:42:ID curr_arg
1521:50:RPAREN
1521:51:COMMA
1521:53:ID args
1521:57:DOT
1521:58:ID cdr
1521:61:RPAREN
1521:63:AND
1521:65:ID head
1521:70:LT
1521:72:ID get_str
1521:79:LPAREN
1521:80:ID curr_arg
1521:88:RPAREN
1522:25:ELSE
1522:30:LPAREN
1522:31:ID print
1522:36:LPAREN
1522:37:STRING "Illegal argument to <s, value: '"
1522:71:RPAREN
1522:72:SEMICOLON
1523:31:ID print
1523:36:LPAREN
1523:37:ID sexp2s
1523:43:LPAREN
1523:44:ID curr_arg
1523:52:RPAREN
1523:53:RPAREN
1523:54:SEMICOLON
1524:31:ID print
1524:36:LPAREN
1524:37:STRING "'\n"
1524:42:RPAREN
1524:43:SEMICOLON
1525:31:INT 0
1525:32:RPAREN
1526:22:END
1527:13:IN
1527:16:IF
1527:19:ID args
1527:24:EQ
1527:26:NIL
1528:16:THEN
1528:21:INT 1
1529:16:ELSE
1529:21:LET
1529:25:VAR
1529:29:ID curr_arg
1529:38:ASSIGN
1529:41:ID args
1529:45:DOT
1529:46:ID car
1530:21:IN
1530:24:IF
1530:27:ID str_p
1530:32:LPAREN
1530:33:ID curr_arg
1530:41:RPAREN
1531:24:THEN
1531:29:ID aux
1531:32:LPAREN
1531:33:ID get_str
1531:40:LPAREN
1531:41:ID curr_arg
1531:49:RPAREN
1531:50:COMMA
1531:52:ID args
1531:56:DOT
1531:57:ID cdr
1531:60:RPAREN
1532:24:ELSE
1532:29:LPAREN
1532:30:ID print
1532:35:LPAREN
1532:36:STRING "Illegal argument to <s, value: '"
1532:70:RPAREN
1532:71:SEMICOLON
1533:30:ID print
1533:35:LPAREN
1533:36:ID sexp2s
1533:42:LPAREN
1533:43:ID curr_arg
1533:51:RPAREN
1533:52:RPAREN
1533:53:SEMICOLON
1534:30:ID print
1534:35:LPAREN
1534:36:STRING "'\n"
1534:41:RPAREN
1534:42:SEMICOLON
1535:30:INT 0
1535:31:RPAREN
1536:21:END
1537:13:END
1538:11:FUNCTION
1538:20:ID leq_str
1538:27:LPAREN
1538:28:ID args
1538:32:COLON
1538:34:ID sexps
1538:39:RPAREN
1538:40:COLON
1538:42:ID int
1538:46:EQ
1539:13:LET
1539:17:FUNCTION
1539:26:ID aux
1539:29:LPAREN
1539:30:ID head
1539:34:COLON
1539:36:ID string
1539:42:COMMA
1539:44:ID args
1539:48:COLON
1539:50:ID sexps
1539:55:RPAREN
1539:56:COLON
1539:58:ID int
1539:62:EQ
1540:17:IF
1540:20:ID args
1540:25:EQ
1540:27:NIL
1541:17:THEN
1541:22:INT 1
1542:17:ELSE
1542:22:LET
1542:26:VAR
1542:30:ID curr_arg
1542:39:ASSIGN
1542:42:ID args
1542:46:DOT
1542:47:ID car
1543:22:IN
1543:25:IF
1543:28:ID str_p
1543:33:LPAREN
1543:34:ID curr_arg
1543:42:RPAREN
1544:25:THEN
1544:30:ID aux
1544:33:LPAREN
1544:34:ID get_str
1544:41:LPAREN
1544:42:ID curr_arg
1544:50:RPAREN
1544:51:COMMA
1544:53:ID args
1544:57:DOT
1544:58:ID cdr
1544:61:RPAREN
1544:63:AND
1544:65:ID head
1544:70:LE
1544:73:ID get_str
1544:80:LPAREN
1544:81:ID curr_arg
1544:89:RPAREN
1545:25:ELSE
1545:30:LPAREN
1545:31:ID print
1545:36:LPAREN
1545:37:STRING "Illegal argument to <=s, value: '"
1545:72:RPAREN
1545:73:SEMICOLON
1546:31:ID print
1546:36:LPAREN
1546:37:ID sexp2s
1546:43:LPAREN
1546:44:ID curr_arg
1546:52:RPAREN
1546:53:RPAREN
1546:54:SEMICOLON
1547:31:ID print
1547:36:LPAREN
1547:37:STRING "'\n"
1547:42:RPAREN
1547:43:SEMICOLON
1548:31:INT 0
1548:32:RPAREN
1549:22:END
1550:13:IN
1550:16:IF
1550:19:ID args
1550:24:EQ
1550:26:NIL
1551:16:THEN
1551:21:INT 1
1552:16:ELSE
1552:21:LET
1552:25:VAR
1552:29:ID curr_arg
1552:38:ASSIGN
1552:41:ID args
1552:45:DOT
1552:46:ID car
1553:21:IN
1553:24:IF
1553:27:ID str_p
1553:32:LPAREN
1553:33:ID curr_arg
1553:41:RPAREN
1554:24:THEN
1554:29:ID aux
1554:32:LPAREN
1554:33:ID get_str
1554:40:LPAREN
1554:41:ID curr_arg
1554:49:RPAREN
1554:50:COMMA
1554:52:ID args
1554:56:DOT
1554:57:ID cdr
1554:60:RPAREN
1555:24:ELSE
1555:29:LPAREN
1555:30:ID print
1555:35:LPAREN
1555:36:STRING "Illegal argument to <=s, value: '"
1555:71:RPAREN
1555:72:SEMICOLON
1556:30:ID print
1556:35:LPAREN
1556:36:ID sexp2s
1556:42:LPAREN
1556:43:ID curr_arg
1556:51:RPAREN
1556:52:RPAREN
1556:53:SEMICOLON
1557:30:ID print
1557:35:LPAREN
1557:36:STRING "'\n"
1557:41:RPAREN
1557:42:SEMICOLON
1558:30:INT 0
1558:31:RPAREN
1559:21:END
1560:13:END
1561:11:FUNCTION
1561:20:ID eq_str
1561:26:LPAREN
1561:27:ID args
1561:31:COLON
1561:33:ID sexps
1561:38:RPAREN
1561:39:COLON
1561:41:ID int
1561:45:EQ
1562:13:LET
1562:17:FUNCTION
1562:26:ID aux
1562:29:LPAREN
1562:30:ID head
1562:34:COLON
1562:36:ID string
1562:42:COMMA
1562:44:ID args
1562:48:COLON
1562:50:ID sexps
1562:55:RPAREN
1562:56:COLON
1562:58:ID int
1562:62:EQ
1563:17:IF
1563:20:ID args
1563:25:EQ
1563:27:NIL
1564:17:THEN
1564:22:INT 1
1565:17:ELSE
1565:22:LET
1565:26:VAR
1565:30:ID curr_arg
1565:39:ASSIGN
1565:42:ID args
1565:46:DOT
1565:47:ID car
1566:22:IN
1566:25:IF
1566:28:ID str_p
1566:33:LPAREN
1566:34:ID curr_arg
1566:42:RPAREN
1567:25:THEN
1567:30:ID aux
1567:33:LPAREN
1567:34:ID head
1567:38:COMMA
1567:40:ID args
1567:44:DOT
1567:45:ID cdr
1567:48:RPAREN
1567:50:AND
1567:52:ID get_str
1567:59:LPAREN
1567:60:ID curr_arg
1567:68:RPAREN
1567:70:EQ
1567:72:ID head
1568:25:ELSE
1568:30:LPAREN
1568:31:ID print
1568:36:LPAREN
1568:37:STRING "Illegal argument to =s, value: '"
1568:71:RPAREN
1568:72:SEMICOLON
1569:31:ID print
1569:36:LPAREN
1569:37:ID sexp2s
1569:43:LPAREN
1569:44:ID curr_arg
1569:52:RPAREN
1569:53:RPAREN
1569:54:SEMICOLON
1570:31:ID print
1570:36:LPAREN
1570:37:STRING "'\n"
1570:42:RPAREN
1570:43:SEMICOLON
1571:31:INT 0
1571:32:RPAREN
1572:22:END
1573:13:IN
1573:16:IF
1573:19:ID args
1573:24:EQ
1573:26:NIL
1574:16:THEN
1574:21:INT 1
1575:16:ELSE
1575:21:LET
1575:25:VAR
1575:29:ID curr_arg
1575:38:ASSIGN
1575:41:ID args
1575:45:DOT
1575:46:ID car
1576:21:IN
1576:24:IF
1576:27:ID str_p
1576:32:LPAREN
1576:33:ID curr_arg
1576:41:RPAREN
1577:24:THEN
1577:29:ID aux
1577:32:LPAREN
1577:33:ID get_str
1577:40:LPAREN
1577:41:ID curr_arg
1577:49:RPAREN
1577:50:COMMA
1577:52:ID args
1577:56:DOT
1577:57:ID cdr
1577:60:RPAREN
1578:24:ELSE
1578:29:LPAREN
1578:30:ID print
1578:35:LPAREN
1578:36:STRING "Illegal argument to =s, value: '"
1578:70:RPAREN
1578:71:SEMICOLON
1579:30:ID print
1579:35:LPAREN
1579:36:ID sexp2s
1579:42:LPAREN
1579:43:ID curr_arg
1579:51:RPAREN
1579:52:RPAREN
1579:53:SEMICOLON
1580:30:ID print
1580:35:LPAREN
1580:36:STRING "'\n"
1580:41:RPAREN
1580:42:SEMICOLON
1581:30:INT 0
1581:31:RPAREN
1582:21:END
1583:13:END
1584:11:FUNCTION
1584:20:ID neq_str
1584:27:LPAREN
1584:28:ID args
1584:32:COLON
1584:34:ID sexps
1584:39:RPAREN
1584:40:COLON
1584:42:ID int
1584:46:EQ
1585:13:LET
1585:17:FUNCTION
1585:26:ID aux
1585:29:LPAREN
1585:30:ID head
1585:34:COLON
1585:36:ID string
1585:42:COMMA
1585:44:ID args
1585:48:COLON
1585:50:ID sexps
1585:55:RPAREN
1585:56:COLON
1585:58:ID int
1585:62:EQ
1586:17:IF
1586:20:ID args
1586:25:EQ
1586:27:NIL
1587:17:THEN
1587:22:INT 1
1588:17:ELSE
1588:22:LET
1588:26:VAR
1588:30:ID curr_arg
1588:39:ASSIGN
1588:42:ID args
1588:46:DOT
1588:47:ID car
1589:22:IN
1589:25:IF
1589:28:ID str_p
1589:33:LPAREN
1589:34:ID curr_arg
1589:42:RPAREN
1590:25:THEN
1590:30:ID aux
1590:33:LPAREN
1590:34:ID head
1590:38:COMMA
1590:40:ID args
1590:44:DOT
1590:45:ID cdr
1590:48:RPAREN
1590:50:AND
1590:52:ID get_str
1590:59:LPAREN
1590:60:ID curr_arg
1590:68:RPAREN
1590:70:NEQ
1590:73:ID head
1591:25:ELSE
1591:30:LPAREN
1591:31:ID print
1591:36:LPAREN
1591:37:STRING "Illegal argument to !=s, value: '"
1591:72:RPAREN
1591:73:SEMICOLON
1592:31:ID print
1592:36:LPAREN
1592:37:ID sexp2s
1592:43:LPAREN
1592:44:ID curr_arg
1592:52:RPAREN
1592:53:RPAREN
1592:54:SEMICOLON
1593:31:ID print
1593:36:LPAREN
1593:37:STRING "'\n"
1593:42:RPAREN
1593:43:SEMICOLON
1594:31:INT 0
1594:32:RPAREN
1595:22:END
1596:13:IN
1596:16:IF
1596:19:ID args
1596:24:EQ
1596:26:NIL
1597:16:THEN
1597:21:INT 1
1598:16:ELSE
1598:21:LET
1598:25:VAR
1598:29:ID curr_arg
1598:38:ASSIGN
1598:41:ID args
1598:45:DOT
1598:46:ID car
1599:21:IN
1599:24:IF
1599:27:ID str_p
1599:32:LPAREN
1599:33:ID curr_arg
1599:41:RPAREN
1600:24:THEN
1600:29:ID aux
1600:32:LPAREN
1600:33:ID get_str
1600:40:LPAREN
1600:41:ID curr_arg
1600:49:RPAREN
1600:50:COMMA
1600:52:ID args
1600:56:DOT
1600:57:ID cdr
1600:60:RPAREN
1601:24:ELSE
1601:29:LPAREN
1601:30:ID print
1601:35:LPAREN
1601:36:STRING "Illegal argument to !=s, value: '"
1601:71:RPAREN
1601:72:SEMICOLON
1602:30:ID print
1602:35:LPAREN
1602:36:ID sexp2s
1602:42:LPAREN
1602:43:ID curr_arg
1602:51:RPAREN
1602:52:RPAREN
1602:53:SEMICOLON
1603:30:ID print
1603:35:LPAREN
1603:36:STRING "'\n"
1603:41:RPAREN
1603:42:SEMICOLON
1604:30:INT 0
1604:31:RPAREN
1605:21:END
1606:13:END
1607:11:FUNCTION
1607:20:ID geq_str
1607:27:LPAREN
1607:28:ID args
1607:32:COLON
1607:34:ID sexps
1607:39:RPAREN
1607:40:COLON
1607:42:ID int
1607:46:EQ
1608:13:LET
1608:17:FUNCTION
1608:26:ID aux
1608:29:LPAREN
1608:30:ID head
1608:34:COLON
1608:36:ID string
1608:42:COMMA
1608:44:ID args
1608:48:COLON
1608:50:ID sexps
1608:55:RPAREN
1608:56:COLON
1608:58:ID int
1608:62:EQ
1609:17:IF
1609:20:ID args
1609:25:EQ
1609:27:NIL
1610:17:THEN
1610:22:INT 1
1611:17:ELSE
1611:22:LET
1611:26:VAR
1611:30:ID curr_arg
1611:39:ASSIGN
1611:42:ID args
1611:46:DOT
1611:47:ID car
1612:22:IN
1612:25:IF
1612:28:ID str_p
1612:33:LPAREN
1612:34:ID curr_arg
1612:42:RPAREN
1613:25:THEN
1613:30:ID aux
1613:33:LPAREN
1613:34:ID get_str
1613:41:LPAREN
1613:42:ID curr_arg
1613:50:RPAREN
1613:51:COMMA
1613:53:ID args
1613:57:DOT
1613:58:ID cdr
1613:61:RPAREN
1613:63:AND
1613:65:ID head
1613:70:GE
1613:73:ID get_str
1613:80:LPAREN
1613:81:ID curr_arg
1613:89:RPAREN
1614:25:ELSE
1614:30:LPAREN
1614:31:ID print
1614:36:LPAREN
1614:37:STRING "Illegal argument to >=s, value: '"
1614:72:RPAREN
1614:73:SEMICOLON
1615:31:ID print
1615:36:LPAREN
1615:37:ID sexp2s
1615:43:LPAREN
1615:44:ID curr_arg
1615:52:RPAREN
1615:53:RPAREN
1615:54:SEMICOLON
1616:31:ID print
1616:36:LPAREN
1616:37:STRING "'\n"
1616:42:RPAREN
1616:43:SEMICOLON
1617:31:INT 0
1617:32:RPAREN
1618:22:END
1619:13:IN
1619:16:IF
1619:19:ID args
1619:24:EQ
1619:26:NIL
1620:16:THEN
1620:21:INT 1
1621:16:ELSE
1621:21:LET
1621:25:VAR
1621:29:ID curr_arg
1621:38:ASSIGN
1621:41:ID args
1621:45:DOT
1621:46:ID car
1622:21:IN
1622:24:IF
1622:27:ID str_p
1622:32:LPAREN
1622:33:ID curr_arg
1622:41:RPAREN
1623:24:THEN
1623:29:ID aux
1623:32:LPAREN
1623:33:ID get_str
1623:40:LPAREN
1623:41:ID curr_arg
1623:49:RPAREN
1623:50:COMMA
1623:52:ID args
1623:56:DOT
1623:57:ID cdr
1623:60:RPAREN
1624:24:ELSE
1624:29:LPAREN
1624:30:ID print
1624:35:LPAREN
1624:36:STRING "Illegal argument to >=s, value: '"
1624:71:RPAREN
1624:72:SEMICOLON
1625:30:ID print
1625:35:LPAREN
1625:36:ID sexp2s
1625:42:LPAREN
1625:43:ID curr_arg
1625:51:RPAREN
1625:52:RPAREN
1625:53:SEMICOLON
1626:30:ID print
1626:35:LPAREN
1626:36:STRING "'\n"
1626:41:RPAREN
1626:42:SEMICOLON
1627:30:INT 0
1627:31:RPAREN
1628:21:END
1629:13:END
1630:11:FUNCTION
1630:20:ID gt_str
1630:26:LPAREN
1630:27:ID args
1630:31:COLON
1630:33:ID sexps
1630:38:RPAREN
1630:39:COLON
1630:41:ID int
1630:45:EQ
1631:13:LET
1631:17:FUNCTION
1631:26:ID aux
1631:29:LPAREN
1631:30:ID head
1631:34:COLON
1631:36:ID string
1631:42:COMMA
1631:44:ID args
1631:48:COLON
1631:50:ID sexps
1631:55:RPAREN
1631:56:COLON
1631:58:ID int
1631:62:EQ
1632:17:IF
1632:20:ID args
1632:25:EQ
1632:27:NIL
1633:17:THEN
1633:22:INT 1
1634:17:ELSE
1634:22:LET
1634:26:VAR
1634:30:ID curr_arg
1634:39:ASSIGN
1634:42:ID args
1634:46:DOT
1634:47:ID car
1635:22:IN
1635:25:IF
1635:28:ID str_p
1635:33:LPAREN
1635:34:ID curr_arg
1635:42:RPAREN
1636:25:THEN
1636:30:ID aux
1636:33:LPAREN
1636:34:ID get_str
1636:41:LPAREN
1636:42:ID curr_arg
1636:50:RPAREN
1636:51:COMMA
1636:53:ID args
1636:57:DOT
1636:58:ID cdr
1636:61:RPAREN
1636:63:AND
1636:65:ID head
1636:70:GT
1636:72:ID get_str
1636:79:LPAREN
1636:80:ID curr_arg
1636:88:RPAREN
1637:25:ELSE
1637:30:LPAREN
1637:31:ID print
1637:36:LPAREN
1637:37:STRING "Illegal argument to >s, value: '"
1637:71:RPAREN
1637:72:SEMICOLON
1638:31:ID print
1638:36:LPAREN
1638:37:ID sexp2s
1638:43:LPAREN
1638:44:ID curr_arg
1638:52:RPAREN
1638:53:RPAREN
1638:54:SEMICOLON
1639:31:ID print
1639:36:LPAREN
1639:37:STRING "'\n"
1639:42:RPAREN
1639:43:SEMICOLON
1640:31:INT 0
1640:32:RPAREN
1641:22:END
1642:13:IN
1642:16:IF
1642:19:ID args
1642:24:EQ
1642:26:NIL
1643:16:THEN
1643:21:INT 1
1644:16:ELSE
1644:21:LET
1644:25:VAR
1644:29:ID curr_arg
1644:38:ASSIGN
1644:41:ID args
1644:45:DOT
1644:46:ID car
1645:21:IN
1645:24:IF
1645:27:ID str_p
1645:32:LPAREN
1645:33:ID curr_arg
1645:41:RPAREN
1646:24:THEN
1646:29:ID aux
1646:32:LPAREN
1646:33:ID get_str
1646:40:LPAREN
1646:41:ID curr_arg
1646:49:RPAREN
1646:50:COMMA
1646:52:ID args
1646:56:DOT
1646:57:ID cdr
1646:60:RPAREN
1647:24:ELSE
1647:29:LPAREN
1647:30:ID print
1647:35:LPAREN
1647:36:STRING "Illegal argument to >s, value: '"
1647:70:RPAREN
1647:71:SEMICOLON
1648:30:ID print
1648:35:LPAREN
1648:36:ID sexp2s
1648:42:LPAREN
1648:43:ID curr_arg
1648:51:RPAREN
1648:52:RPAREN
1648:53:SEMICOLON
1649:30:ID print
1649:35:LPAREN
1649:36:STRING "'\n"
1649:41:RPAREN
1649:42:SEMICOLON
1650:30:INT 0
1650:31:RPAREN
1651:21:END
1652:13:END
1653:11:FUNCTION
1653:20:ID append_str
1653:30:LPAREN
1653:31:ID args
1653:35:COLON
1653:37:ID sexps
1653:42:RPAREN
1653:43:COLON
1653:45:ID string
1653:52:EQ
1654:13:IF
1654:16:ID args
1654:21:EQ
1654:23:NIL
1655:13:THEN
1655:18:STRING ""
1656:13:ELSE
1656:18:LET
1656:22:VAR
1656:26:ID curr_arg
1656:35:ASSIGN
1656:38:ID args
1656:42:DOT
1656:43:ID car
1657:18:IN
1657:21:IF
1657:24:ID str_p
1657:29:LPAREN
1657:30:ID curr_arg
1657:38:RPAREN
1658:21:THEN
1658:26:ID concat
1658:32:LPAREN
1658:33:ID get_str
1658:40:LPAREN
1658:41:ID curr_arg
1658:49:RPAREN
1658:50:COMMA
1658:52:ID append_str
1658:62:LPAREN
1658:63:ID args
1658:67:DOT
1658:68:ID cdr
1658:71:RPAREN
1658:72:RPAREN
1659:21:ELSE
1659:26:LPAREN
1659:27:ID print
1659:32:LPAREN
1659:33:STRING "Illegal argument to +s, value: '"
1659:67:RPAREN
1659:68:SEMICOLON
1660:27:ID print
1660:32:LPAREN
1660:33:ID sexp2s
1660:39:LPAREN
1660:40:ID curr_arg
1660:48:RPAREN
1660:49:RPAREN
1660:50:SEMICOLON
1661:27:ID print
1661:32:LPAREN
1661:33:STRING "'\n"
1661:38:RPAREN
1661:39:SEMICOLON
1662:27:STRING ""
1662:29:RPAREN
1663:18:END
1664:11:FUNCTION
1664:20:ID str_to_int
1664:30:LPAREN
1664:31:ID args
1664:35:COLON
1664:37:ID sexps
1664:42:RPAREN
1664:43:COLON
1664:45:ID int
1664:49:EQ
1665:13:IF
1665:16:ID args
1665:21:EQ
1665:23:NIL
1665:27:OR
1665:29:LPAREN
1665:30:ID args
1665:34:DOT
1665:35:ID cdr
1665:39:NEQ
1665:42:NIL
1665:46:AND
1665:48:ID args
1665:52:DOT
1665:53:ID cdr
1665:56:DOT
1665:57:ID cdr
1665:61:NEQ
1665:64:NIL
1665:67:RPAREN
1666:13:THEN
1666:18:LPAREN
1666:19:ID print
1666:24:LPAREN
1666:25:STRING "s->i needs exactly 1 argument.\n"
1666:59:RPAREN
1666:60:SEMICOLON
1667:19:INT 0
1667:20:RPAREN
1668:13:ELSE
1668:18:LET
1668:22:VAR
1668:26:ID curr_arg
1668:35:ASSIGN
1668:38:ID args
1668:42:DOT
1668:43:ID car
1669:18:IN
1669:21:IF
1669:24:ID str_p
1669:29:LPAREN
1669:30:ID curr_arg
1669:38:RPAREN
1670:21:THEN
1670:26:ID s2i
1670:29:LPAREN
1670:30:ID get_str
1670:37:LPAREN
1670:38:ID curr_arg
1670:46:RPAREN
1670:47:RPAREN
1671:21:ELSE
1671:26:LPAREN
1671:27:ID print
1671:32:LPAREN
1671:33:STRING "Illegal argument to s->i, value: '"
1671:69:RPAREN
1671:70:SEMICOLON
1672:27:ID print
1672:32:LPAREN
1672:33:ID sexp2s
1672:39:LPAREN
1672:40:ID curr_arg
1672:48:RPAREN
1672:49:RPAREN
1672:50:SEMICOLON
1673:27:ID print
1673:32:LPAREN
1673:33:STRING "'\n"
1673:38:RPAREN
1673:39:SEMICOLON
1674:27:INT 0
1674:28:RPAREN
1675:18:END
1676:11:FUNCTION
1676:20:ID int_to_str
1676:30:LPAREN
1676:31:ID args
1676:35:COLON
1676:37:ID sexps
1676:42:RPAREN
1676:43:COLON
1676:45:ID string
1676:52:EQ
1677:13:IF
1677:16:ID args
1677:21:EQ
1677:23:NIL
1677:27:OR
1677:29:LPAREN
1677:30:ID args
1677:34:DOT
1677:35:ID cdr
1677:39:NEQ
1677:42:NIL
1677:46:AND
1677:48:ID args
1677:52:DOT
1677:53:ID cdr
1677:56:DOT
1677:57:ID cdr
1677:61:NEQ
1677:64:NIL
1677:67:RPAREN
1678:13:THEN
1678:18:LPAREN
1678:19:ID print
1678:24:LPAREN
1678:25:STRING "i->s needs exactly 1 argument.\n"
1678:59:RPAREN
1678:60:SEMICOLON
1679:19:STRING ""
1679:21:RPAREN
1680:13:ELSE
1680:18:LET
1680:22:VAR
1680:26:ID curr_arg
1680:35:ASSIGN
1680:38:ID args
1680:42:DOT
1680:43:ID car
1681:18:IN
1681:21:IF
1681:24:ID int_p
1681:29:LPAREN
1681:30:ID curr_arg
1681:38:RPAREN
1682:21:THEN
1682:26:ID i2s
1682:29:LPAREN
1682:30:ID get_int
1682:37:LPAREN
1682:38:ID curr_arg
1682:46:RPAREN
1682:47:RPAREN
1683:21:ELSE
1683:26:LPAREN
1683:27:ID print
1683:32:LPAREN
1683:33:STRING "Illegal argument to i->s, value: '"
1683:69:RPAREN
1683:70:SEMICOLON
1684:27:ID print
1684:32:LPAREN
1684:33:ID sexp2s
1684:39:LPAREN
1684:40:ID curr_arg
1684:48:RPAREN
1684:49:RPAREN
1684:50:SEMICOLON
1685:27:ID print
1685:32:LPAREN
1685:33:STRING "'\n"
1685:38:RPAREN
1685:39:SEMICOLON
1686:27:STRING ""
1686:29:RPAREN
1687:18:END
1688:11:FUNCTION
1688:20:ID substring_
1688:30:LPAREN
1688:31:ID args
1688:35:COLON
1688:37:ID sexps
1688:42:RPAREN
1688:43:COLON
1688:45:ID string
1688:52:EQ
1689:13:IF
1689:16:ID args
1689:21:EQ
1689:23:NIL
1689:27:OR
1689:29:ID args
1689:33:DOT
1689:34:ID cdr
1689:38:EQ
1689:40:NIL
1689:44:OR
1689:46:ID args
1689:50:DOT
1689:51:ID cdr
1689:54:DOT
1689:55:ID cdr
1689:59:EQ
1689:61:NIL
1690:16:OR
1690:18:LPAREN
1690:19:ID args
1690:23:DOT
1690:24:ID cdr
1690:27:DOT
1690:28:ID cdr
1690:32:NEQ
1690:35:NIL
1690:39:AND
1690:41:ID args
1690:45:DOT
1690:46:ID cdr
1690:49:DOT
1690:50:ID cdr
1690:53:DOT
1690:54:ID cdr
1690:58:NEQ
1690:61:NIL
1690:64:RPAREN
1691:13:THEN
1691:18:LPAREN
1691:19:ID print
1691:24:LPAREN
1691:25:STRING "substring needs exactly 3 arguments.\n"
1691:65:RPAREN
1691:66:SEMICOLON
1692:19:STRING ""
1692:21:RPAREN
1693:13:ELSE
1693:18:LET
1693:22:VAR
1693:26:ID str_arg
1693:34:ASSIGN
1693:37:ID args
1693:41:DOT
1693:42:ID car
1694:22:VAR
1694:26:ID idx_arg
1694:34:ASSIGN
1694:37:ID args
1694:41:DOT
1694:42:ID cdr
1694:45:DOT
1694:46:ID car
1695:22:VAR
1695:26:ID len_arg
1695:34:ASSIGN
1695:37:ID args
1695:41:DOT
1695:42:ID cdr
1695:45:DOT
1695:46:ID cdr
1695:49:DOT
1695:50:ID car
1696:18:IN
1696:21:IF
1696:24:ID str_p
1696:29:LPAREN
1696:30:ID str_arg
1696:37:RPAREN
1696:39:AND
1696:41:ID int_p
1696:46:LPAREN
1696:47:ID idx_arg
1696:54:RPAREN
1696:56:AND
1696:58:ID int_p
1696:63:LPAREN
1696:64:ID len_arg
1696:71:RPAREN
1697:21:THEN
1697:26:ID substring
1697:35:LPAREN
1697:36:ID get_str
1697:43:LPAREN
1697:44:ID str_arg
1697:51:RPAREN
1697:52:COMMA
1697:54:ID get_int
1697:61:LPAREN
1697:62:ID idx_arg
1697:69:RPAREN
1697:70:COMMA
1697:72:ID get_int
1697:79:LPAREN
1697:80:ID len_arg
1697:87:RPAREN
1697:88:RPAREN
1698:21:ELSE
1698:26:LPAREN
1698:27:ID print
1698:32:LPAREN
1698:33:STRING "Illegal argument to substring, values: '"
1698:75:RPAREN
1698:76:SEMICOLON
1699:27:ID print
1699:32:LPAREN
1699:33:ID sexp2s
1699:39:LPAREN
1699:40:ID str_arg
1699:47:RPAREN
1699:48:RPAREN
1699:49:SEMICOLON
1700:27:ID print
1700:32:LPAREN
1700:33:STRING "', '"
1700:39:RPAREN
1700:40:SEMICOLON
1701:27:ID print
1701:32:LPAREN
1701:33:ID sexp2s
1701:39:LPAREN
1701:40:ID idx_arg
1701:47:RPAREN
1701:48:RPAREN
1701:49:SEMICOLON
1702:27:ID print
1702:32:LPAREN
1702:33:STRING "', '"
1702:39:RPAREN
1702:40:SEMICOLON
1703:27:ID print
1703:32:LPAREN
1703:33:ID sexp2s
1703:39:LPAREN
1703:40:ID len_arg
1703:47:RPAREN
1703:48:RPAREN
1703:49:SEMICOLON
1704:27:ID print
1704:32:LPAREN
1704:33:STRING "'\n"
1704:38:RPAREN
1704:39:SEMICOLON
1705:27:STRING ""
1705:29:RPAREN
1706:18:END
1707:11:FUNCTION
1707:20:ID print_
1707:26:LPAREN
1707:27:ID args
1707:31:COLON
1707:33:ID sexps
1707:38:RPAREN
1707:39:COLON
1707:41:ID sexps
1707:47:EQ
1708:13:IF
1708:16:ID args
1708:21:EQ
1708:23:NIL
1709:13:THEN
1709:18:NIL
1710:13:ELSE
1710:18:LET
1710:22:VAR
1710:26:ID curr_arg
1710:35:ASSIGN
1710:38:ID args
1710:42:DOT
1710:43:ID car
1711:18:IN
1711:21:IF
1711:24:ID str_p
1711:29:LPAREN
1711:30:ID curr_arg
1711:38:RPAREN
1712:21:THEN
1712:26:ID print
1712:31:LPAREN
1712:32:ID get_str
1712:39:LPAREN
1712:40:ID curr_arg
1712:48:RPAREN
1712:49:RPAREN
1713:21:ELSE
1713:26:ID print
1713:31:LPAREN
1713:32:ID sexp2s
1713:38:LPAREN
1713:39:ID curr_arg
1713:47:RPAREN
1713:48:RPAREN
1713:49:SEMICOLON
1714:21:ID print_
1714:27:LPAREN
1714:28:ID args
1714:32:DOT
1714:33:ID cdr
1714:36:RPAREN
1715:18:END
1716:11:FUNCTION
1716:20:ID newline
1716:27:LPAREN
1716:28:ID args
1716:32:COLON
1716:34:ID sexps
1716:39:RPAREN
1716:40:COLON
1716:42:ID sexps
1716:48:EQ
1717:13:IF
1717:16:ID args
1717:21:EQ
1717:23:NIL
1718:13:THEN
1718:18:LPAREN
1718:19:ID print
1718:24:LPAREN
1718:25:STRING "\n"
1718:29:RPAREN
1718:30:SEMICOLON
1718:32:NIL
1718:35:RPAREN
1719:13:ELSE
1719:18:LPAREN
1719:19:ID print
1719:24:LPAREN
1719:25:STRING "newline takes exactly 0 arguments.\n"
1719:63:RPAREN
1719:64:SEMICOLON
1719:66:NIL
1719:69:RPAREN
1720:11:FUNCTION
1720:20:ID read_char_
1720:30:LPAREN
1720:31:ID args
1720:35:COLON
1720:37:ID sexps
1720:42:RPAREN
1720:43:COLON
1720:45:ID string
1720:52:EQ
1721:13:IF
1721:16:ID args
1721:21:EQ
1721:23:NIL
1722:13:THEN
1722:18:ID getchar
1722:25:LPAREN
1722:26:RPAREN
1723:13:ELSE
1723:18:LPAREN
1723:19:ID print
1723:24:LPAREN
1723:25:STRING "read-char takes exactly 0 arguments.\n"
1723:65:RPAREN
1723:66:SEMICOLON
1723:68:STRING ""
1723:70:RPAREN
1724:11:FUNCTION
1724:20:ID read_line_
1724:30:LPAREN
1724:31:ID args
1724:35:COLON
1724:37:ID sexps
1724:42:RPAREN
1724:43:COLON
1724:45:ID string
1724:52:EQ
1725:13:IF
1725:16:ID args
1725:21:EQ
1725:23:NIL
1726:13:THEN
1726:18:LET
1726:22:VAR
1726:26:ID nxt_char
1726:35:ASSIGN
1726:38:ID getchar
1726:45:LPAREN
1726:46:RPAREN
1727:22:VAR
1727:26:ID res
1727:30:ASSIGN
1727:33:ID nxt_char
1728:18:IN
1728:21:WHILE
1728:27:ID nxt_char
1728:36:NEQ
1728:39:STRING "\n"
1729:21:DO
1729:24:LPAREN
1729:25:ID nxt_char
1729:34:ASSIGN
1729:37:ID getchar
1729:44:LPAREN
1729:45:RPAREN
1729:46:SEMICOLON
1730:25:ID res
1730:29:ASSIGN
1730:32:ID concat
1730:38:LPAREN
1730:39:ID res
1730:42:COMMA
1730:44:ID nxt_char
1730:52:RPAREN
1730:53:RPAREN
1730:54:SEMICOLON
1731:21:ID res
1732:18:END
1733:13:ELSE
1733:18:LPAREN
1733:19:ID print
1733:24:LPAREN
1733:25:STRING "read-line takes exactly 0 arguments.\n"
1733:65:RPAREN
1733:66:SEMICOLON
1733:68:STRING ""
1733:70:RPAREN
1734:11:FUNCTION
1734:20:ID ord_
1734:24:LPAREN
1734:25:ID args
1734:29:COLON
1734:31:ID sexps
1734:36:RPAREN
1734:37:COLON
1734:39:ID int
1734:43:EQ
1735:13:IF
1735:16:ID args
1735:21:EQ
1735:23:NIL
1735:27:OR
1735:29:LPAREN
1735:30:ID args
1735:34:DOT
1735:35:ID cdr
1735:39:NEQ
1735:42:NIL
1735:46:AND
1735:48:ID args
1735:52:DOT
1735:53:ID cdr
1735:56:DOT
1735:57:ID cdr
1735:61:NEQ
1735:64:NIL
1735:67:RPAREN
1736:13:THEN
1736:18:LPAREN
1736:19:ID print
1736:24:LPAREN
1736:25:STRING "ord needs exactly 1 argument.\n"
1736:58:RPAREN
1736:59:SEMICOLON
1737:19:INT 0
1737:20:RPAREN
1738:13:ELSE
1738:18:LET
1738:22:VAR
1738:26:ID curr_arg
1738:35:ASSIGN
1738:38:ID args
1738:42:DOT
1738:43:ID car
1739:18:IN
1739:21:IF
1739:24:ID str_p
1739:29:LPAREN
1739:30:ID curr_arg
1739:38:RPAREN
1740:21:THEN
1740:26:ID ord
1740:29:LPAREN
1740:30:ID get_str
1740:37:LPAREN
1740:38:ID curr_arg
1740:46:RPAREN
1740:47:RPAREN
1741:21:ELSE
1741:26:LPAREN
1741:27:ID print
1741:32:LPAREN
1741:33:STRING "Illegal argument to ord, value: '"
1741:68:RPAREN
1741:69:SEMICOLON
1742:27:ID print
1742:32:LPAREN
1742:33:ID sexp2s
1742:39:LPAREN
1742:40:ID curr_arg
1742:48:RPAREN
1742:49:RPAREN
1742:50:SEMICOLON
1743:27:ID print
1743:32:LPAREN
1743:33:STRING "'\n"
1743:38:RPAREN
1743:39:SEMICOLON
1744:27:INT 0
1744:28:RPAREN
1745:18:END
1746:11:FUNCTION
1746:20:ID chr_
1746:24:LPAREN
1746:25:ID args
1746:29:COLON
1746:31:ID sexps
1746:36:RPAREN
1746:37:COLON
1746:39:ID string
1746:46:EQ
1747:13:IF
1747:16:ID args
1747:21:EQ
1747:23:NIL
1747:27:OR
1747:29:LPAREN
1747:30:ID args
1747:34:DOT
1747:35:ID cdr
1747:39:NEQ
1747:42:NIL
1747:46:AND
1747:48:ID args
1747:52:DOT
1747:53:ID cdr
1747:56:DOT
1747:57:ID cdr
1747:61:NEQ
1747:64:NIL
1747:67:RPAREN
1748:13:THEN
1748:18:LPAREN
1748:19:ID print
1748:24:LPAREN
1748:25:STRING "chr needs exactly 1 argument.\n"
1748:58:RPAREN
1748:59:SEMICOLON
1749:19:STRING ""
1749:21:RPAREN
1750:13:ELSE
1750:18:LET
1750:22:VAR
1750:26:ID curr_arg
1750:35:ASSIGN
1750:38:ID args
1750:42:DOT
1750:43:ID car
1751:18:IN
1751:21:IF
1751:24:ID int_p
1751:29:LPAREN
1751:30:ID curr_arg
1751:38:RPAREN
1752:21:THEN
1752:26:ID chr
1752:29:LPAREN
1752:30:ID get_int
1752:37:LPAREN
1752:38:ID curr_arg
1752:46:RPAREN
1752:47:RPAREN
1753:21:ELSE
1753:26:LPAREN
1753:27:ID print
1753:32:LPAREN
1753:33:STRING "Illegal argument to chr, value: '"
1753:68:RPAREN
1753:69:SEMICOLON
1754:27:ID print
1754:32:LPAREN
1754:33:ID sexp2s
1754:39:LPAREN
1754:40:ID curr_arg
1754:48:RPAREN
1754:49:RPAREN
1754:50:SEMICOLON
1755:27:ID print
1755:32:LPAREN
1755:33:STRING "'\n"
1755:38:RPAREN
1755:39:SEMICOLON
1756:27:STRING ""
1756:29:RPAREN
1757:18:END
1761:11:FUNCTION
1761:20:ID list
1761:24:LPAREN
1761:25:ID args
1761:29:COLON
1761:31:ID sexps
1761:36:RPAREN
1761:37:COLON
1761:39:ID sexps
1761:45:EQ
1762:13:ID args
1763:11:FUNCTION
1763:20:ID cons
1763:24:LPAREN
1763:25:ID args
1763:29:COLON
1763:31:ID sexps
1763:36:RPAREN
1763:37:COLON
1763:39:ID sexps
1763:45:EQ
1764:13:IF
1764:16:ID args
1764:21:EQ
1764:23:NIL
1765:13:THEN
1765:18:LPAREN
1765:19:ID print
1765:24:LPAREN
1765:25:STRING "Cannot apply cons to 0 arguments\n"
1765:61:RPAREN
1765:62:SEMICOLON
1766:19:NIL
1766:22:RPAREN
1767:13:ELSE
1767:18:LET
1767:22:VAR
1767:26:ID curr_arg
1767:35:ASSIGN
1767:38:ID args
1767:42:DOT
1767:43:ID car
1768:18:IN
1768:21:IF
1768:24:ID args
1768:28:DOT
1768:29:ID cdr
1768:33:EQ
1768:35:NIL
1769:21:THEN
1769:26:IF
1769:29:ID sexps_p
1769:36:LPAREN
1769:37:ID curr_arg
1769:45:RPAREN
1770:26:THEN
1770:31:ID get_sexps
1770:40:LPAREN
1770:41:ID curr_arg
1770:49:RPAREN
1771:26:ELSE
1771:31:LPAREN
1771:32:ID print
1771:37:LPAREN
1771:38:STRING "Last argument to cons has to be a list. It was '"
1771:88:RPAREN
1771:89:SEMICOLON
1772:32:ID print
1772:37:LPAREN
1772:38:ID sexp2s
1772:44:LPAREN
1772:45:ID curr_arg
1772:53:RPAREN
1772:54:RPAREN
1772:55:SEMICOLON
1773:32:ID print
1773:37:LPAREN
1773:38:STRING "'\n"
1773:43:RPAREN
1773:44:SEMICOLON
1774:32:NIL
1774:35:RPAREN
1775:21:ELSE
1775:26:ID sexps
1775:32:LBRACE
1775:33:ID car
1775:37:EQ
1775:39:ID curr_arg
1775:47:COMMA
1775:49:ID cdr
1775:53:EQ
1775:55:ID cons
1775:59:LPAREN
1775:60:ID args
1775:64:DOT
1775:65:ID cdr
1775:68:RPAREN
1775:69:RBRACE
1776:18:END
1777:11:FUNCTION
1777:20:ID car
1777:23:LPAREN
1777:24:ID args
1777:28:COLON
1777:30:ID sexps
1777:35:RPAREN
1777:36:COLON
1777:38:ID sexp
1777:43:EQ
1778:13:IF
1778:16:ID args
1778:21:EQ
1778:23:NIL
1778:27:OR
1778:29:LPAREN
1778:30:ID args
1778:34:DOT
1778:35:ID cdr
1778:39:NEQ
1778:42:NIL
1778:46:AND
1778:48:ID args
1778:52:DOT
1778:53:ID cdr
1778:56:DOT
1778:57:ID cdr
1778:61:NEQ
1778:64:NIL
1778:67:RPAREN
1779:13:THEN
1779:18:LPAREN
1779:19:ID print
1779:24:LPAREN
1779:25:STRING "car needs exactly 1 argument\n"
1779:57:RPAREN
1779:58:SEMICOLON
1780:19:NIL
1780:22:RPAREN
1781:13:ELSE
1781:18:LET
1781:22:VAR
1781:26:ID curr_arg
1781:35:ASSIGN
1781:38:ID args
1781:42:DOT
1781:43:ID car
1782:18:IN
1782:21:IF
1782:24:ID sexps_p
1782:31:LPAREN
1782:32:ID curr_arg
1782:40:RPAREN
1783:21:THEN
1783:26:LET
1783:30:VAR
1783:34:ID curr_arg_content
1783:51:ASSIGN
1783:54:ID get_sexps
1783:63:LPAREN
1783:64:ID curr_arg
1783:72:RPAREN
1784:26:IN
1784:29:ID curr_arg_content
1784:45:DOT
1784:46:ID car
1785:26:END
1786:21:ELSE
1786:26:LPAREN
1786:27:ID print
1786:32:LPAREN
1786:33:STRING "Illegal argument to car, value: '"
1786:68:RPAREN
1786:69:SEMICOLON
1787:27:ID print
1787:32:LPAREN
1787:33:ID sexp2s
1787:39:LPAREN
1787:40:ID curr_arg
1787:48:RPAREN
1787:49:RPAREN
1787:50:SEMICOLON
1788:27:ID print
1788:32:LPAREN
1788:33:STRING "'\n"
1788:38:RPAREN
1788:39:SEMICOLON
1789:27:NIL
1789:30:RPAREN
1790:18:END
1791:11:FUNCTION
1791:20:ID cdr
1791:23:LPAREN
1791:24:ID args
1791:28:COLON
1791:30:ID sexps
1791:35:RPAREN
1791:36:COLON
1791:38:ID sexps
1791:44:EQ
1792:13:IF
1792:16:ID args
1792:21:EQ
1792:23:NIL
1792:27:OR
1792:29:LPAREN
1792:30:ID args
1792:34:DOT
1792:35:ID cdr
1792:39:NEQ
1792:42:NIL
1792:46:AND
1792:48:ID args
1792:52:DOT
1792:53:ID cdr
1792:56:DOT
1792:57:ID cdr
1792:61:NEQ
1792:64:NIL
1792:67:RPAREN
1793:13:THEN
1793:18:LPAREN
1793:19:ID print
1793:24:LPAREN
1793:25:STRING "cdr needs exactly 1 argument\n"
1793:57:RPAREN
1793:58:SEMICOLON
1794:19:NIL
1794:22:RPAREN
1795:13:ELSE
1795:18:LET
1795:22:VAR
1795:26:ID curr_arg
1795:35:ASSIGN
1795:38:ID args
1795:42:DOT
1795:43:ID car
1796:18:IN
1796:21:IF
1796:24:ID sexps_p
1796:31:LPAREN
1796:32:ID curr_arg
1796:40:RPAREN
1797:21:THEN
1797:26:LET
1797:30:VAR
1797:34:ID curr_arg_content
1797:51:ASSIGN
1797:54:ID get_sexps
1797:63:LPAREN
1797:64:ID curr_arg
1797:72:RPAREN
1798:26:IN
1798:29:IF
1798:32:ID curr_arg_content
1798:49:NEQ
1798:52:NIL
1799:29:THEN
1799:34:ID curr_arg_content
1799:50:DOT
1799:51:ID cdr
1800:29:ELSE
1800:34:LPAREN
1800:35:ID print
1800:40:LPAREN
1800:41:STRING "Cannot apply cdr to an empty list\n"
1800:78:RPAREN
1800:79:SEMICOLON
1801:35:NIL
1801:38:RPAREN
1802:26:END
1803:21:ELSE
1803:26:LPAREN
1803:27:ID print
1803:32:LPAREN
1803:33:STRING "Illegal argument to cdr, value: '"
1803:68:RPAREN
1803:69:SEMICOLON
1804:27:ID print
1804:32:LPAREN
1804:33:ID sexp2s
1804:39:LPAREN
1804:40:ID curr_arg
1804:48:RPAREN
1804:49:RPAREN
1804:50:SEMICOLON
1805:27:ID print
1805:32:LPAREN
1805:33:STRING "'\n"
1805:38:RPAREN
1805:39:SEMICOLON
1806:27:NIL
1806:30:RPAREN
1807:18:END
1808:11:FUNCTION
1808:20:ID intp
1808:24:LPAREN
1808:25:ID args
1808:29:COLON
1808:31:ID sexps
1808:36:RPAREN
1808:37:COLON
1808:39:ID int
1808:43:EQ
1809:13:IF
1809:16:ID args
1809:21:EQ
1809:23:NIL
1809:27:OR
1809:29:LPAREN
1809:30:ID args
1809:34:DOT
1809:35:ID cdr
1809:39:NEQ
1809:42:NIL
1809:46:AND
1809:48:ID args
1809:52:DOT
1809:53:ID cdr
1809:56:DOT
1809:57:ID cdr
1809:61:NEQ
1809:64:NIL
1809:67:RPAREN
1810:13:THEN
1810:18:LPAREN
1810:19:ID print
1810:24:LPAREN
1810:25:STRING "int? needs exactly 1 argument.\n"
1810:59:RPAREN
1810:60:SEMICOLON
1811:19:INT 0
1811:20:RPAREN
1812:13:ELSE
1812:18:LET
1812:22:VAR
1812:26:ID curr_arg
1812:35:ASSIGN
1812:38:ID args
1812:42:DOT
1812:43:ID car
1813:18:IN
1813:21:ID int_p
1813:26:LPAREN
1813:27:ID curr_arg
1813:35:RPAREN
1814:18:END
1815:11:FUNCTION
1815:20:ID stringp
1815:27:LPAREN
1815:28:ID args
1815:32:COLON
1815:34:ID sexps
1815:39:RPAREN
1815:40:COLON
1815:42:ID int
1815:46:EQ
1816:13:IF
1816:16:ID args
1816:21:EQ
1816:23:NIL
1816:27:OR
1816:29:LPAREN
1816:30:ID args
1816:34:DOT
1816:35:ID cdr
1816:39:NEQ
1816:42:NIL
1816:46:AND
1816:48:ID args
1816:52:DOT
1816:53:ID cdr
1816:56:DOT
1816:57:ID cdr
1816:61:NEQ
1816:64:NIL
1816:67:RPAREN
1817:13:THEN
1817:18:LPAREN
1817:19:ID print
1817:24:LPAREN
1817:25:STRING "string? needs exactly 1 argument.\n"
1817:62:RPAREN
1817:63:SEMICOLON
1818:19:INT 0
1818:20:RPAREN
1819:13:ELSE
1819:18:LET
1819:22:VAR
1819:26:ID curr_arg
1819:35:ASSIGN
1819:38:ID args
1819:42:DOT
1819:43:ID car
1820:18:IN
1820:21:ID str_p
1820:26:LPAREN
1820:27:ID curr_arg
1820:35:RPAREN
1821:18:END
1822:11:FUNCTION
1822:20:ID listp
1822:25:LPAREN
1822:26:ID args
1822:30:COLON
1822:32:ID sexps
1822:37:RPAREN
1822:38:COLON
1822:40:ID int
1822:44:EQ
1823:13:IF
1823:16:ID args
1823:21:EQ
1823:23:NIL
1823:27:OR
1823:29:LPAREN
1823:30:ID args
1823:34:DOT
1823:35:ID cdr
1823:39:NEQ
1823:42:NIL
1823:46:AND
1823:48:ID args
1823:52:DOT
1823:53:ID cdr
1823:56:DOT
1823:57:ID cdr
1823:61:NEQ
1823:64:NIL
1823:67:RPAREN
1824:13:THEN
1824:18:LPAREN
1824:19:ID print
1824:24:LPAREN
1824:25:STRING "list? needs exactly 1 argument.\n"
1824:60:RPAREN
1824:61:SEMICOLON
1825:19:INT 0
1825:20:RPAREN
1826:13:ELSE
1826:18:LET
1826:22:VAR
1826:26:ID curr_arg
1826:35:ASSIGN
1826:38:ID args
1826:42:DOT
1826:43:ID car
1827:18:IN
1827:21:ID sexps_p
1827:28:LPAREN
1827:29:ID curr_arg
1827:37:RPAREN
1828:18:END
1829:11:FUNCTION
1829:20:ID nilp
1829:24:LPAREN
1829:25:ID args
1829:29:COLON
1829:31:ID sexps
1829:36:RPAREN
1829:37:COLON
1829:39:ID int
1829:43:EQ
1830:13:IF
1830:16:ID args
1830:21:EQ
1830:23:NIL
1830:27:OR
1830:29:LPAREN
1830:30:ID args
1830:34:DOT
1830:35:ID cdr
1830:39:NEQ
1830:42:NIL
1830:46:AND
1830:48:ID args
1830:52:DOT
1830:53:ID cdr
1830:56:DOT
1830:57:ID cdr
1830:61:NEQ
1830:64:NIL
1830:67:RPAREN
1831:13:THEN
1831:18:LPAREN
1831:19:ID print
1831:24:LPAREN
1831:25:STRING "nil? needs exactly 1 argument.\n"
1831:59:RPAREN
1831:60:SEMICOLON
1832:19:INT 0
1832:20:RPAREN
1833:13:ELSE
1833:18:LET
1833:22:VAR
1833:26:ID curr_arg
1833:35:ASSIGN
1833:38:ID args
1833:42:DOT
1833:43:ID car
1834:18:IN
1834:21:ID sexps_p
1834:28:LPAREN
1834:29:ID curr_arg
1834:37:RPAREN
1834:39:AND
1834:41:ID get_sexps
1834:50:LPAREN
1834:51:ID curr_arg
1834:59:RPAREN
1834:61:EQ
1834:63:NIL
1835:18:END
1836:11:FUNCTION
1836:20:ID funp
1836:24:LPAREN
1836:25:ID args
1836:29:COLON
1836:31:ID sexps
1836:36:RPAREN
1836:37:COLON
1836:39:ID int
1836:43:EQ
1837:13:IF
1837:16:ID args
1837:21:EQ
1837:23:NIL
1837:27:OR
1837:29:LPAREN
1837:30:ID args
1837:34:DOT
1837:35:ID cdr
1837:39:NEQ
1837:42:NIL
1837:46:AND
1837:48:ID args
1837:52:DOT
1837:53:ID cdr
1837:56:DOT
1837:57:ID cdr
1837:61:NEQ
1837:64:NIL
1837:67:RPAREN
1838:13:THEN
1838:18:LPAREN
1838:19:ID print
1838:24:LPAREN
1838:25:STRING "fun? needs exactly 1 argument.\n"
1838:59:RPAREN
1838:60:SEMICOLON
1839:19:INT 0
1839:20:RPAREN
1840:13:ELSE
1840:18:LET
1840:22:VAR
1840:26:ID curr_arg
1840:35:ASSIGN
1840:38:ID args
1840:42:DOT
1840:43:ID car
1841:18:IN
1841:21:ID fun_p
1841:26:LPAREN
1841:27:ID curr_arg
1841:35:RPAREN
1842:18:END
1843:11:FUNCTION
1843:20:ID exit_
1843:25:LPAREN
1843:26:ID args
1843:30:COLON
1843:32:ID sexps
1843:37:RPAREN
1843:38:COLON
1843:40:ID sexps
1843:46:EQ
1844:13:IF
1844:16:ID args
1844:21:NEQ
1844:24:NIL
1844:28:AND
1844:30:ID args
1844:34:DOT
1844:35:ID cdr
1844:39:NEQ
1844:42:NIL
1845:13:THEN
1845:18:LPAREN
1845:19:ID print
1845:24:LPAREN
1845:25:STRING "exit cannot be used with more that 1 argument.\n"
1845:75:RPAREN
1845:76:SEMICOLON
1846:19:NIL
1846:22:RPAREN
1847:13:ELSE
1847:18:IF
1847:21:ID args
1847:26:EQ
1847:28:NIL
1848:18:THEN
1848:23:LPAREN
1848:24:ID exit
1848:28:LPAREN
1848:29:INT 0
1848:30:RPAREN
1848:31:SEMICOLON
1848:33:NIL
1848:36:RPAREN
1849:18:ELSE
1849:23:LET
1849:27:VAR
1849:31:ID curr_arg
1849:40:ASSIGN
1849:43:ID args
1849:47:DOT
1849:48:ID car
1850:23:IN
1850:26:IF
1850:29:ID int_p
1850:34:LPAREN
1850:35:ID curr_arg
1850:43:RPAREN
1851:26:THEN
1851:31:LPAREN
1851:32:ID exit
1851:36:LPAREN
1851:37:ID get_int
1851:44:LPAREN
1851:45:ID curr_arg
1851:53:RPAREN
1851:54:RPAREN
1851:55:SEMICOLON
1851:57:NIL
1851:60:RPAREN
1852:21:ELSE
1852:26:LPAREN
1852:27:ID print
1852:32:LPAREN
1852:33:STRING "Illegal argument to exit, value: '"
1852:69:RPAREN
1852:70:SEMICOLON
1853:27:ID print
1853:32:LPAREN
1853:33:ID sexp2s
1853:39:LPAREN
1853:40:ID curr_arg
1853:48:RPAREN
1853:49:RPAREN
1853:50:SEMICOLON
1854:27:ID print
1854:32:LPAREN
1854:33:STRING "'\n"
1854:38:RPAREN
1854:39:SEMICOLON
1855:27:NIL
1855:30:RPAREN
1856:23:END
1857:11:FUNCTION
1857:20:ID help
1857:24:LPAREN
1857:25:ID args
1857:29:COLON
1857:31:ID sexps
1857:36:RPAREN
1857:37:COLON
1857:39:ID sexps
1857:45:EQ
1858:13:LPAREN
1858:14:ID print
1858:19:LPAREN
1858:20:STRING "All available entries in the environment at this point are:\n"
1858:83:RPAREN
1858:84:SEMICOLON
1859:14:ID print
1859:19:LPAREN
1859:20:ID env2s_short
1859:31:LPAREN
1859:32:ID env
1859:35:RPAREN
1859:36:RPAREN
1859:37:SEMICOLON
1860:14:ID print
1860:19:LPAREN
1860:20:STRING "\nI hope you find something useful. Oh, and execute '(exit)' to exit.\n"
1860:93:RPAREN
1860:94:SEMICOLON
1861:14:NIL
1861:17:RPAREN
1862:7:IN
1862:10:IF
1862:13:ID fun_name
1862:22:EQ
1862:24:STRING "+"
1863:10:THEN
1863:15:ID mk_int
1863:21:LPAREN
1863:22:ID plus
1863:26:LPAREN
1863:27:ID args
1863:31:RPAREN
1863:32:RPAREN
1864:10:ELSE
1864:15:IF
1864:18:ID fun_name
1864:27:EQ
1864:29:STRING "-"
1865:10:THEN
1865:15:ID mk_int
1865:21:LPAREN
1865:22:ID minus
1865:27:LPAREN
1865:28:ID args
1865:32:RPAREN
1865:33:RPAREN
1866:10:ELSE
1866:15:IF
1866:18:ID fun_name
1866:27:EQ
1866:29:STRING "*"
1867:10:THEN
1867:15:ID mk_int
1867:21:LPAREN
1867:22:ID times
1867:27:LPAREN
1867:28:ID args
1867:32:RPAREN
1867:33:RPAREN
1868:10:ELSE
1868:15:IF
1868:18:ID fun_name
1868:27:EQ
1868:29:STRING "/"
1869:10:THEN
1869:15:ID mk_int
1869:21:LPAREN
1869:22:ID div
1869:25:LPAREN
1869:26:ID args
1869:30:RPAREN
1869:31:RPAREN
1870:10:ELSE
1870:15:IF
1870:18:ID fun_name
1870:27:EQ
1870:29:STRING "^"
1871:10:THEN
1871:15:ID mk_int
1871:21:LPAREN
1871:22:ID expt
1871:26:LPAREN
1871:27:ID args
1871:31:RPAREN
1871:32:RPAREN
1872:10:ELSE
1872:15:IF
1872:18:ID fun_name
1872:27:EQ
1872:29:STRING "<"
1873:10:THEN
1873:15:ID mk_bool
1873:22:LPAREN
1873:23:ID lt_int
1873:29:LPAREN
1873:30:ID args
1873:34:RPAREN
1873:35:RPAREN
1874:10:ELSE
1874:15:IF
1874:18:ID fun_name
1874:27:EQ
1874:29:STRING "<="
1875:10:THEN
1875:15:ID mk_bool
1875:22:LPAREN
1875:23:ID leq_int
1875:30:LPAREN
1875:31:ID args
1875:35:RPAREN
1875:36:RPAREN
1876:10:ELSE
1876:15:IF
1876:18:ID fun_name
1876:27:EQ
1876:29:STRING "="
1877:10:THEN
1877:15:ID mk_bool
1877:22:LPAREN
1877:23:ID eq_int
1877:29:LPAREN
1877:30:ID args
1877:34:RPAREN
1877:35:RPAREN
1878:10:ELSE
1878:15:IF
1878:18:ID fun_name
1878:27:EQ
1878:29:STRING "!="
1879:10:THEN
1879:15:ID mk_bool
1879:22:LPAREN
1879:23:ID neq_int
1879:30:LPAREN
1879:31:ID args
1879:35:RPAREN
1879:36:RPAREN
1880:10:ELSE
1880:15:IF
1880:18:ID fun_name
1880:27:EQ
1880:29:STRING ">="
1881:10:THEN
1881:15:ID mk_bool
1881:22:LPAREN
1881:23:ID geq_int
1881:30:LPAREN
1881:31:ID args
1881:35:RPAREN
1881:36:RPAREN
1882:10:ELSE
1882:15:IF
1882:18:ID fun_name
1882:27:EQ
1882:29:STRING ">"
1883:10:THEN
1883:15:ID mk_bool
1883:22:LPAREN
1883:23:ID gt_int
1883:29:LPAREN
1883:30:ID args
1883:34:RPAREN
1883:35:RPAREN
1884:10:ELSE
1884:15:IF
1884:18:ID fun_name
1884:27:EQ
1884:29:STRING "min"
1885:10:THEN
1885:15:ID mk_int
1885:21:LPAREN
1885:22:ID min
1885:25:LPAREN
1885:26:ID args
1885:30:RPAREN
1885:31:RPAREN
1886:10:ELSE
1886:15:IF
1886:18:ID fun_name
1886:27:EQ
1886:29:STRING "max"
1887:10:THEN
1887:15:ID mk_int
1887:21:LPAREN
1887:22:ID max
1887:25:LPAREN
1887:26:ID args
1887:30:RPAREN
1887:31:RPAREN
1888:10:ELSE
1888:15:IF
1888:18:ID fun_name
1888:27:EQ
1888:29:STRING "progn"
1889:10:THEN
1889:15:ID progn
1889:20:LPAREN
1889:21:ID args
1889:25:RPAREN
1890:10:ELSE
1890:15:IF
1890:18:ID fun_name
1890:27:EQ
1890:29:STRING "map"
1891:10:THEN
1891:15:ID mk_sexps
1891:23:LPAREN
1891:24:ID map
1891:27:LPAREN
1891:28:ID args
1891:32:RPAREN
1891:33:RPAREN
1892:10:ELSE
1892:15:IF
1892:18:ID fun_name
1892:27:EQ
1892:29:STRING "foldr"
1893:10:THEN
1893:15:ID foldr
1893:20:LPAREN
1893:21:ID args
1893:25:RPAREN
1894:10:ELSE
1894:15:IF
1894:18:ID fun_name
1894:27:EQ
1894:29:STRING "foldl"
1895:10:THEN
1895:15:ID foldl
1895:20:LPAREN
1895:21:ID args
1895:25:RPAREN
1896:10:ELSE
1896:15:IF
1896:18:ID fun_name
1896:27:EQ
1896:29:STRING "orb"
1897:10:THEN
1897:15:ID mk_bool
1897:22:LPAREN
1897:23:ID orb
1897:26:LPAREN
1897:27:ID args
1897:31:RPAREN
1897:32:RPAREN
1898:10:ELSE
1898:15:IF
1898:18:ID fun_name
1898:27:EQ
1898:29:STRING "andb"
1899:10:THEN
1899:15:ID mk_bool
1899:22:LPAREN
1899:23:ID andb
1899:27:LPAREN
1899:28:ID args
1899:32:RPAREN
1899:33:RPAREN
1900:10:ELSE
1900:15:IF
1900:18:ID fun_name
1900:27:EQ
1900:29:STRING "notb"
1901:10:THEN
1901:15:ID mk_bool
1901:22:LPAREN
1901:23:ID andb
1901:27:LPAREN
1901:28:ID args
1901:32:RPAREN
1901:33:RPAREN
1902:10:ELSE
1902:15:IF
1902:18:ID fun_name
1902:27:EQ
1902:29:STRING "<s"
1903:10:THEN
1903:15:ID mk_bool
1903:22:LPAREN
1903:23:ID lt_str
1903:29:LPAREN
1903:30:ID args
1903:34:RPAREN
1903:35:RPAREN
1904:10:ELSE
1904:15:IF
1904:18:ID fun_name
1904:27:EQ
1904:29:STRING "<=s"
1905:10:THEN
1905:15:ID mk_bool
1905:22:LPAREN
1905:23:ID leq_str
1905:30:LPAREN
1905:31:ID args
1905:35:RPAREN
1905:36:RPAREN
1906:10:ELSE
1906:15:IF
1906:18:ID fun_name
1906:27:EQ
1906:29:STRING "=s"
1907:10:THEN
1907:15:ID mk_bool
1907:22:LPAREN
1907:23:ID eq_str
1907:29:LPAREN
1907:30:ID args
1907:34:RPAREN
1907:35:RPAREN
1908:10:ELSE
1908:15:IF
1908:18:ID fun_name
1908:27:EQ
1908:29:STRING "!=s"
1909:10:THEN
1909:15:ID mk_bool
1909:22:LPAREN
1909:23:ID neq_str
1909:30:LPAREN
1909:31:ID args
1909:35:RPAREN
1909:36:RPAREN
1910:10:ELSE
1910:15:IF
1910:18:ID fun_name
1910:27:EQ
1910:29:STRING ">=s"
1911:10:THEN
1911:15:ID mk_bool
1911:22:LPAREN
1911:23:ID geq_str
1911:30:LPAREN
1911:31:ID args
1911:35:RPAREN
1911:36:RPAREN
1912:10:ELSE
1912:15:IF
1912:18:ID fun_name
1912:27:EQ
1912:29:STRING ">s"
1913:10:THEN
1913:15:ID mk_bool
1913:22:LPAREN
1913:23:ID gt_str
1913:29:LPAREN
1913:30:ID args
1913:34:RPAREN
1913:35:RPAREN
1914:10:ELSE
1914:15:IF
1914:18:ID fun_name
1914:27:EQ
1914:29:STRING "+s"
1915:10:THEN
1915:15:ID mk_str
1915:21:LPAREN
1915:22:ID append_str
1915:32:LPAREN
1915:33:ID args
1915:37:RPAREN
1915:38:RPAREN
1916:10:ELSE
1916:15:IF
1916:18:ID fun_name
1916:27:EQ
1916:29:STRING "s->i"
1917:10:THEN
1917:15:ID mk_int
1917:21:LPAREN
1917:22:ID str_to_int
1917:32:LPAREN
1917:33:ID args
1917:37:RPAREN
1917:38:RPAREN
1918:10:ELSE
1918:15:IF
1918:18:ID fun_name
1918:27:EQ
1918:29:STRING "i->s"
1919:10:THEN
1919:15:ID mk_str
1919:21:LPAREN
1919:22:ID int_to_str
1919:32:LPAREN
1919:33:ID args
1919:37:RPAREN
1919:38:RPAREN
1920:10:ELSE
1920:15:IF
1920:18:ID fun_name
1920:27:EQ
1920:29:STRING "substring"
1921:10:THEN
1921:15:ID mk_str
1921:21:LPAREN
1921:22:ID substring_
1921:32:LPAREN
1921:33:ID args
1921:37:RPAREN
1921:38:RPAREN
1922:10:ELSE
1922:15:IF
1922:18:ID fun_name
1922:27:EQ
1922:29:STRING "print"
1923:10:THEN
1923:15:ID mk_sexps
1923:23:LPAREN
1923:24:ID print_
1923:30:LPAREN
1923:31:ID args
1923:35:RPAREN
1923:36:RPAREN
1924:10:ELSE
1924:15:IF
1924:18:ID fun_name
1924:27:EQ
1924:29:STRING "newline"
1925:10:THEN
1925:15:ID mk_sexps
1925:23:LPAREN
1925:24:ID newline
1925:31:LPAREN
1925:32:ID args
1925:36:RPAREN
1925:37:RPAREN
1926:10:ELSE
1926:15:IF
1926:18:ID fun_name
1926:27:EQ
1926:29:STRING "read-char"
1927:10:THEN
1927:15:ID mk_str
1927:21:LPAREN
1927:22:ID read_char_
1927:32:LPAREN
1927:33:ID args
1927:37:RPAREN
1927:38:RPAREN
1928:10:ELSE
1928:15:IF
1928:18:ID fun_name
1928:27:EQ
1928:29:STRING "read-line"
1929:10:THEN
1929:15:ID mk_str
1929:21:LPAREN
1929:22:ID read_line_
1929:32:LPAREN
1929:33:ID args
1929:37:RPAREN
1929:38:RPAREN
1930:10:ELSE
1930:15:IF
1930:18:ID fun_name
1930:27:EQ
1930:29:STRING "ord"
1931:10:THEN
1931:15:ID mk_int
1931:21:LPAREN
1931:22:ID ord_
1931:26:LPAREN
1931:27:ID args
1931:31:RPAREN
1931:32:RPAREN
1932:10:ELSE
1932:15:IF
1932:18:ID fun_name
1932:27:EQ
1932:29:STRING "chr"
1933:10:THEN
1933:15:ID mk_str
1933:21:LPAREN
1933:22:ID chr_
1933:26:LPAREN
1933:27:ID args
1933:31:RPAREN
1933:32:RPAREN
1934:10:ELSE
1934:15:IF
1934:18:ID fun_name
1934:27:EQ
1934:29:STRING "list"
1935:10:THEN
1935:15:ID mk_sexps
1935:23:LPAREN
1935:24:ID list
1935:28:LPAREN
1935:29:ID args
1935:33:RPAREN
1935:34:RPAREN
1936:10:ELSE
1936:15:IF
1936:18:ID fun_name
1936:27:EQ
1936:29:STRING "cons"
1937:10:THEN
1937:15:ID mk_sexps
1937:23:LPAREN
1937:24:ID cons
1937:28:LPAREN
1937:29:ID args
1937:33:RPAREN
1937:34:RPAREN
1938:10:ELSE
1938:15:IF
1938:18:ID fun_name
1938:27:EQ
1938:29:STRING "car"
1939:10:THEN
1939:15:ID car
1939:18:LPAREN
1939:19:ID args
1939:23:RPAREN
1940:10:ELSE
1940:15:IF
1940:18:ID fun_name
1940:27:EQ
1940:29:STRING "cdr"
1941:10:THEN
1941:15:ID mk_sexps
1941:23:LPAREN
1941:24:ID cdr
1941:27:LPAREN
1941:28:ID args
1941:32:RPAREN
1941:33:RPAREN
1942:10:ELSE
1942:15:IF
1942:18:ID fun_name
1942:27:EQ
1942:29:STRING "int?"
1943:10:THEN
1943:15:ID mk_bool
1943:22:LPAREN
1943:23:ID intp
1943:27:LPAREN
1943:28:ID args
1943:32:RPAREN
1943:33:RPAREN
1944:10:ELSE
1944:15:IF
1944:18:ID fun_name
1944:27:EQ
1944:29:STRING "string?"
1945:10:THEN
1945:15:ID mk_bool
1945:22:LPAREN
1945:23:ID stringp
1945:30:LPAREN
1945:31:ID args
1945:35:RPAREN
1945:36:RPAREN
1946:10:ELSE
1946:15:IF
1946:18:ID fun_name
1946:27:EQ
1946:29:STRING "list?"
1947:10:THEN
1947:15:ID mk_bool
1947:22:LPAREN
1947:23:ID listp
1947:28:LPAREN
1947:29:ID args
1947:33:RPAREN
1947:34:RPAREN
1948:10:ELSE
1948:15:IF
1948:18:ID fun_name
1948:27:EQ
1948:29:STRING "nil?"
1949:10:THEN
1949:15:ID mk_bool
1949:22:LPAREN
1949:23:ID nilp
1949:27:LPAREN
1949:28:ID args
1949:32:RPAREN
1949:33:RPAREN
1950:10:ELSE
1950:15:IF
1950:18:ID fun_name
1950:27:EQ
1950:29:STRING "fun?"
1951:10:THEN
1951:15:ID mk_bool
1951:22:LPAREN
1951:23:ID funp
1951:27:LPAREN
1951:28:ID args
1951:32:RPAREN
1951:33:RPAREN
1952:10:ELSE
1952:15:IF
1952:18:ID fun_name
1952:27:EQ
1952:29:STRING "exit"
1953:10:THEN
1953:15:ID mk_sexps
1953:23:LPAREN
1953:24:ID exit_
1953:29:LPAREN
1953:30:ID args
1953:34:RPAREN
1953:35:RPAREN
1954:10:ELSE
1954:15:IF
1954:18:ID fun_name
1954:27:EQ
1954:29:STRING "help"
1955:10:THEN
1955:15:ID mk_sexps
1955:23:LPAREN
1955:24:ID help
1955:28:LPAREN
1955:29:ID args
1955:33:RPAREN
1955:34:RPAREN
1956:10:ELSE
1956:15:LPAREN
1956:16:ID print
1956:21:LPAREN
1956:22:STRING "Interpreter error: Unknown internal function '"
1956:70:RPAREN
1956:71:SEMICOLON
1957:16:ID print
1957:21:LPAREN
1957:22:ID fun_name
1957:30:RPAREN
1957:31:SEMICOLON
1958:16:ID print
1958:21:LPAREN
1958:22:STRING "' --- Perhaps it has not been implemented yet.\n"
1958:72:RPAREN
1958:73:SEMICOLON
1959:16:NIL
1959:19:RPAREN
1960:7:END
1962:5:VAR
1962:9:ID prompt
1962:16:ASSIGN
1962:19:STRING ">>> "
1965:1:IN
1965:4:IF
1965:7:ID use_dummy
1966:4:THEN
1966:9:LPAREN
1966:10:ID print
1966:15:LPAREN
1966:16:STRING "The dummy input is:\n"
1966:39:RPAREN
1966:40:SEMICOLON
1967:10:ID print
1967:15:LPAREN
1967:16:ID dummy_input
1967:27:RPAREN
1967:28:SEMICOLON
1968:10:ID print
1968:15:LPAREN
1968:16:STRING "\n"
1968:20:RPAREN
1968:21:RPAREN
1968:22:SEMICOLON
1969:4:ID print
1969:9:LPAREN
1969:10:STRING "Let's spin the REPL... use (exit) if you get too dizzy\n"
1969:68:RPAREN
1969:69:SEMICOLON
1970:4:ID print
1970:9:LPAREN
1970:10:ID prompt
1970:16:RPAREN
1970:17:SEMICOLON
1971:4:ID init_repl
1971:14:LPAREN
1971:15:RPAREN
1971:16:SEMICOLON
1972:4:WHILE
1972:10:INT 1
1973:4:DO
1973:7:LPAREN
1973:8:LET
1973:12:VAR
1973:16:ID tokens
1973:23:ASSIGN
1973:26:ID read_sexp_to_tokens
1973:46:LPAREN
1973:47:RPAREN
1974:12:VAR
1974:16:ID sexp
1974:21:ASSIGN
1974:24:ID parse_tokens
1974:36:LPAREN
1974:37:ID tokens
1974:43:DOT
1974:44:ID leftmost
1974:52:COMMA
1974:54:ID tokens
1974:60:DOT
1974:61:ID rightmost
1974:70:RPAREN
1975:12:VAR
1975:16:ID result
1975:23:ASSIGN
1975:26:ID eval
1975:30:LPAREN
1975:31:ID sexp
1975:35:COMMA
1975:37:ID initial_env
1975:48:RPAREN
1976:8:IN
1976:11:ID print
1976:16:LPAREN
1976:17:ID sexp2s
1976:23:LPAREN
1976:24:ID result
1976:30:RPAREN
1976:31:RPAREN
1976:32:SEMICOLON
1977:11:ID print
1977:16:LPAREN
1977:17:STRING "\n"
1977:21:RPAREN
1977:22:SEMICOLON
1978:11:ID print
1978:16:LPAREN
1978:17:ID prompt
1978:23:RPAREN
1979:8:END
1979:11:RPAREN
1979:12:SEMICOLON
1980:4:INT 0
1981:1:END
